var CrowdSimulator;CrowdSimulator=(()=>{"use strict";var t={389:(t,i,o)=>{o.r(i),o.d(i,{init:()=>x,playPause:()=>m,reconfigure:()=>v,step:()=>w});var n=function(){function t(t,i){this._renderer=t,this._agents=i}return t.prototype.init=function(t){this._agents.init(t.agents)},t.prototype.update=function(t){var i=this;this._agents.forEach((function(o){o.update(t,i._agents.getAll())})),this._agents.init(this._agents.getAll())},t.prototype.draw=function(){var t=this;this._renderer.clear(),this._agents.forEach((function(i){t._renderer.drawAgent(i)}))},t}(),e=function(){function t(t){this._context=t.getContext("2d")}return t.prototype.clear=function(){this._context.fillStyle="white",this._context.fillRect(0,0,this._context.canvas.width,this._context.canvas.height)},t.prototype.drawAgent=function(t){var i=t.getPosition(),o=t.getDirection();if(this._context.beginPath(),t.getIsDone()?this._context.strokeStyle="#00FF00":t.getIsStuck()?this._context.strokeStyle="#FF0000":this._context.strokeStyle="#000000",this._context.arc(i.x,i.y,t.Radius,0,2*Math.PI),0!==o.dx||0!==o.dy){var n=Math.sqrt(Math.pow(o.dx,2)+Math.pow(o.dy,2));this._context.moveTo(i.x,i.y),this._context.lineTo(i.x+t.Radius*o.dx/n,i.y+t.Radius*o.dy/n)}this._context.stroke()},t}(),r=function(){function t(t,i,o,n){this.Id=t,this._position=i,this._goalPosition=o,this.Radius=n,this._direction={dx:0,dy:0},this._isDone=!1}return t.prototype.getPosition=function(){return this._position},t.prototype.getDirection=function(){return this._direction},t.prototype.getIsDone=function(){return this._isDone},t.prototype.getIsStuck=function(){return!1},t.prototype.update=function(t,i){if(!this._isDone){var o={x:this._goalPosition.x-this._position.x,y:this._goalPosition.y-this._position.y},n=Math.sqrt(Math.pow(o.x,2)+Math.pow(o.y,2));n>60*t/1e3?(this._direction.dx=o.x/n,this._direction.dy=o.y/n,this._position.x+=60*t/1e3*this._direction.dx,this._position.y+=60*t/1e3*this._direction.dy):(this._position.x=this._goalPosition.x,this._position.y=this._goalPosition.y,this._isDone=!0)}},t}(),s=function(){function t(t,i,o,n){this.Id=t,this._position=i,this._goalPosition=o,this.Radius=n,this._direction={dx:0,dy:0},this._isDone=!1,this._isStuck=!1}return t.prototype.getPosition=function(){return this._position},t.prototype.getDirection=function(){return this._direction},t.prototype.getIsDone=function(){return this._isDone},t.prototype.getIsStuck=function(){return this._isStuck},t.prototype.update=function(t,i){var o=this;if(!this._isDone){var n={x:this._goalPosition.x-this._position.x,y:this._goalPosition.y-this._position.y},e=Math.sqrt(Math.pow(n.x,2)+Math.pow(n.y,2));if(e>60*t/1e3){this._direction.dx=n.x/e,this._direction.dy=n.y/e;var r=this._position.x+20*this._direction.dx,s=this._position.y+20*this._direction.dy;this._isStuck=!1,i.forEach((function(t){t.Id!=o.Id&&o.collides(t,{x:r,y:s})&&(o._isStuck=!0)})),this._isStuck||(this._position.x+=60*t/1e3*this._direction.dx,this._position.y+=60*t/1e3*this._direction.dy)}else this._position.x=this._goalPosition.x,this._position.y=this._goalPosition.y,this._isDone=!0}},t.prototype.collides=function(t,i){var o=i.x,n=i.y,e=this.Radius,r=t.getPosition().x,s=t.getPosition().y,a=t.Radius;return Math.sqrt(Math.pow(o-r,2)+Math.pow(n-s,2))<e+a},t}(),a=function(){function t(){}return t.RandomToRandom=function(t,i,o,n){for(var e=[],r=0;r<t;r++){var s=n(r,{x:i*Math.random(),y:o*Math.random()},{x:i*Math.random(),y:o*Math.random()},20);e.push(s)}return{agents:e}},t.RandomToLine=function(t,i,o,n){for(var e=[],r=0;r<t;r++){var s=n(r,{x:i*Math.random(),y:o*Math.random()},{x:(r+1)/(t+1)*i,y:o/2},20);e.push(s)}return{agents:e}},t.CircleToCircle=function(t,i,o,n){for(var e=[],r=i/2,s=o/2,a=o/2-25,h=0;h<t;h++){var u=2*Math.PI*h/t,c=n(h,{x:r+a*Math.cos(u),y:s+a*Math.sin(u)},{x:r+a*Math.cos(u+Math.PI),y:s+a*Math.sin(u+Math.PI)},20);e.push(c)}return{agents:e}},t}(),h=function(){function t(){}return t.prototype.init=function(t){var i=this;this._root=null,t.forEach((function(t){i._root=i.insert(t,i._root,!0)}))},t.prototype.getAll=function(){return this.get(this._root)},t.prototype.getNeighboursInRangeRectilinear=function(t,i){throw new Error("Method not implemented.")},t.prototype.getNeighboursInRangeEuclidean=function(t,i){throw new Error("Method not implemented.")},t.prototype.forEach=function(t){this.apply(this._root,t)},t.prototype.insert=function(t,i,o){return null==i?{agent:t,left:null,right:null}:(o?t.getPosition().x<i.agent.getPosition().x?i.left=this.insert(t,i.left,!o):i.right=this.insert(t,i.right,!o):t.getPosition().y<i.agent.getPosition().y?i.left=this.insert(t,i.left,!o):i.right=this.insert(t,i.right,!o),i)},t.prototype.get=function(t){return null==t?[]:this.get(t.left).concat(this.get(t.right)).concat(t.agent)},t.prototype.apply=function(t,i){null!=t&&(i(t.agent),this.apply(t.left,i),this.apply(t.right,i))},t}(),u=document.getElementById("config"),c=document.getElementById("agentType"),d=document.getElementById("numberOfAgents"),p=document.getElementById("canvas"),l=document.getElementById("framerate"),y=document.getElementById("playButton"),g=document.getElementById("stepButton"),f=new n(new e(p),new h),_=!1;function x(){this.reconfigure();var t=0,i=0,o=0;window.requestAnimationFrame((function n(e){var r=e-t;t=e,_&&f.update(r),f.draw(),o++,e-i>=250&&(l.textContent="FPS: "+(1e3*o/(e-i)).toFixed(1),o=0,i=e),window.requestAnimationFrame(n)}))}function m(){(_=!_)?(y.textContent="Pause",g.disabled=!0):(y.textContent="Play",g.disabled=!1)}function w(){f.update(1e3/60)}function v(){var t;_&&this.playPause();var i,o=u.value,n=c.value,e=null!==(t=parseInt(d.value))&&void 0!==t?t:0;switch(n){case"BasicAgent":i=function(t,i,o,n){return new r(t,i,o,n)};break;case"StopAgent":i=function(t,i,o,n){return new s(t,i,o,n)};break;default:throw new Error("Agent not implemented")}switch(o){case"RandomToRandom":f.init(a.RandomToRandom(e,p.width,p.height,i));break;case"RandomToLine":f.init(a.RandomToLine(e,p.width,p.height,i));break;case"CircleToCircle":f.init(a.CircleToCircle(e,p.width,p.height,i));break;default:throw new Error("Configuration not implemented")}}}},i={};function o(n){if(i[n])return i[n].exports;var e=i[n]={exports:{}};return t[n](e,e.exports,o),e.exports}return o.d=(t,i)=>{for(var n in i)o.o(i,n)&&!o.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:i[n]})},o.o=(t,i)=>Object.prototype.hasOwnProperty.call(t,i),o.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o(389)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9Dcm93ZFNpbXVsYXRvci8uL3NyYy9TaW11bGF0aW9uLnRzIiwid2VicGFjazovL0Nyb3dkU2ltdWxhdG9yLy4vc3JjL1JlbmRlcmVyMkQudHMiLCJ3ZWJwYWNrOi8vQ3Jvd2RTaW11bGF0b3IvLi9zcmMvQmFzaWNBZ2VudC50cyIsIndlYnBhY2s6Ly9Dcm93ZFNpbXVsYXRvci8uL3NyYy9TdG9wQWdlbnQudHMiLCJ3ZWJwYWNrOi8vQ3Jvd2RTaW11bGF0b3IvLi9zcmMvQ29uZmlndXJhdGlvbnMudHMiLCJ3ZWJwYWNrOi8vQ3Jvd2RTaW11bGF0b3IvLi9zcmMvQWdlbnRUcmVlLnRzIiwid2VicGFjazovL0Nyb3dkU2ltdWxhdG9yLy4vc3JjL21haW4udHMiLCJ3ZWJwYWNrOi8vQ3Jvd2RTaW11bGF0b3Ivd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vQ3Jvd2RTaW11bGF0b3Ivd2VicGFjay9zdGFydHVwIiwid2VicGFjazovL0Nyb3dkU2ltdWxhdG9yL3dlYnBhY2svcnVudGltZS9kZWZpbmUgcHJvcGVydHkgZ2V0dGVycyIsIndlYnBhY2s6Ly9Dcm93ZFNpbXVsYXRvci93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovL0Nyb3dkU2ltdWxhdG9yL3dlYnBhY2svcnVudGltZS9tYWtlIG5hbWVzcGFjZSBvYmplY3QiXSwibmFtZXMiOlsicmVuZGVyZXIiLCJhZ2VudHMiLCJ0aGlzIiwiX3JlbmRlcmVyIiwiX2FnZW50cyIsImluaXQiLCJjb25maWciLCJ1cGRhdGUiLCJkZWx0YVQiLCJmb3JFYWNoIiwiYWdlbnQiLCJnZXRBbGwiLCJkcmF3IiwiY2xlYXIiLCJkcmF3QWdlbnQiLCJjYW52YXMiLCJfY29udGV4dCIsImdldENvbnRleHQiLCJmaWxsU3R5bGUiLCJmaWxsUmVjdCIsIndpZHRoIiwiaGVpZ2h0IiwicG9zaXRpb24iLCJnZXRQb3NpdGlvbiIsImRpcmVjdGlvbiIsImdldERpcmVjdGlvbiIsImJlZ2luUGF0aCIsImdldElzRG9uZSIsInN0cm9rZVN0eWxlIiwiZ2V0SXNTdHVjayIsImFyYyIsIngiLCJ5IiwiUmFkaXVzIiwiTWF0aCIsIlBJIiwiZHgiLCJkeSIsIm1hZ25pdHVkZSIsInNxcnQiLCJtb3ZlVG8iLCJsaW5lVG8iLCJzdHJva2UiLCJpZCIsInN0YXJ0UG9zaXRpb24iLCJnb2FsUG9zaXRpb24iLCJyYWRpdXMiLCJJZCIsIl9wb3NpdGlvbiIsIl9nb2FsUG9zaXRpb24iLCJfZGlyZWN0aW9uIiwiX2lzRG9uZSIsImdvYWxEaXJlY3Rpb24iLCJnb2FsRGlzdGFuY2UiLCJfaXNTdHVjayIsImNvbGxpZGVzIiwiYTF4IiwiYTF5IiwiYTFyIiwiYTJ4IiwiYTJ5IiwiYTJyIiwiUmFuZG9tVG9SYW5kb20iLCJuIiwiYWdlbnRDb25zdHJ1Y3RvciIsImkiLCJyYW5kb20iLCJwdXNoIiwiUmFuZG9tVG9MaW5lIiwiQ2lyY2xlVG9DaXJjbGUiLCJjZW50cmVYIiwiY2VudHJlWSIsImFuZ2xlIiwiY29zIiwic2luIiwiX3Jvb3QiLCJpbnNlcnQiLCJnZXQiLCJnZXROZWlnaGJvdXJzSW5SYW5nZVJlY3RpbGluZWFyIiwicmFuZ2UiLCJFcnJvciIsImdldE5laWdoYm91cnNJblJhbmdlRXVjbGlkZWFuIiwiZnVuIiwiYXBwbHkiLCJyb290IiwieEF4aXMiLCJsZWZ0IiwicmlnaHQiLCJjb25jYXQiLCJjb25maWdTZWxlY3QiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiYWdlbnRUeXBlU2VsZWN0IiwibnVtYmVyT2ZBZ2VudHNJbnB1dCIsImZyYW1lcmF0ZSIsInBsYXlCdXR0b24iLCJzdGVwQnV0dG9uIiwic2ltdWxhdGlvbiIsIlNpbXVsYXRpb24iLCJSZW5kZXJlcjJEIiwiQWdlbnRUcmVlIiwicGxheSIsInJlY29uZmlndXJlIiwibGFzdFJlbmRlciIsImxhc3RGUFMiLCJmcmFtZXMiLCJ3aW5kb3ciLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJsb29wIiwidGltZXN0YW1wIiwidGV4dENvbnRlbnQiLCJ0b0ZpeGVkIiwicGxheVBhdXNlIiwiZGlzYWJsZWQiLCJzdGVwIiwidmFsdWUiLCJhZ2VudFR5cGUiLCJwYXJzZUludCIsIkJhc2ljQWdlbnQiLCJTdG9wQWdlbnQiLCJDb25maWd1cmF0aW9ucyIsIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJfX3dlYnBhY2tfbW9kdWxlc19fIiwiZCIsImRlZmluaXRpb24iLCJrZXkiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwib2JqIiwicHJvcCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyJdLCJtYXBwaW5ncyI6ImtKQUlBLGlCQUlFLFdBQVlBLEVBQXFCQyxHQUMvQkMsS0FBS0MsVUFBWUgsRUFDakJFLEtBQUtFLFFBQVVILEVBb0JuQixPQWpCRSxZQUFBSSxLQUFBLFNBQUtDLEdBQ0hKLEtBQUtFLFFBQVFDLEtBQUtDLEVBQU9MLFNBRzNCLFlBQUFNLE9BQUEsU0FBT0MsR0FBUCxXQUNFTixLQUFLRSxRQUFRSyxTQUFRLFNBQUNDLEdBQ3BCQSxFQUFNSCxPQUFPQyxFQUFRLEVBQUtKLFFBQVFPLGFBRXBDVCxLQUFLRSxRQUFRQyxLQUFLSCxLQUFLRSxRQUFRTyxXQUdqQyxZQUFBQyxLQUFBLHNCQUNFVixLQUFLQyxVQUFVVSxRQUNmWCxLQUFLRSxRQUFRSyxTQUFRLFNBQUNDLEdBQ3BCLEVBQUtQLFVBQVVXLFVBQVVKLE9BRy9CLEVBMUJBLEdDREEsYUFHRSxXQUFZSyxHQUNWYixLQUFLYyxTQUFXRCxFQUFPRSxXQUFXLE1BMEN0QyxPQXZDRSxZQUFBSixNQUFBLFdBQ0VYLEtBQUtjLFNBQVNFLFVBQVksUUFDMUJoQixLQUFLYyxTQUFTRyxTQUNaLEVBQ0EsRUFDQWpCLEtBQUtjLFNBQVNELE9BQU9LLE1BQ3JCbEIs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QUNiTixFQUNBaEQsRUFBT0ssTUFDUEwsRUFBT00sT0FDUDJDLElBR0osTUFFRixRQUNFLE1BQU0sSUFBSWdCLE1BQU0scUNDdEpsQnlDLEVBQTJCLEdBRy9CLFNBQVNDLEVBQW9CQyxHQUU1QixHQUFHRixFQUF5QkUsR0FDM0IsT0FBT0YsRUFBeUJFLEdBQVVDLFFBRzNDLElBQUlDLEVBQVNKLEVBQXlCRSxHQUFZLENBR2pEQyxRQUFTLElBT1YsT0FIQUUsRUFBb0JILEdBQVVFLEVBQVFBLEVBQU9ELFFBQVNGLEdBRy9DRyxFQUFPRCxRQ2pCZixPQ0ZBRixFQUFvQkssRUFBSSxDQUFDSCxFQUFTSSxLQUNqQyxJQUFJLElBQUlDLEtBQU9ELEVBQ1hOLEVBQW9CUSxFQUFFRixFQUFZQyxLQUFTUCxFQUFvQlEsRUFBRU4sRUFBU0ssSUFDNUVFLE9BQU9DLGVBQWVSLEVBQVNLLEVBQUssQ0FBRUksWUFBWSxFQUFNeEQsSUFBS21ELEVBQVdDLE1DSjNFUCxFQUFvQlEsRUFBSSxDQUFDSSxFQUFLQyxJQUFTSixPQUFPSyxVQUFVQyxlQUFlQyxLQUFLSixFQUFLQyxHQ0NqRmIsRUFBb0JpQixFQUFLZixJQUNILG9CQUFYZ0IsUUFBMEJBLE9BQU9DLGFBQzFDVixPQUFPQyxlQUFlUixFQUFTZ0IsT0FBT0MsWUFBYSxDQUFFMUIsTUFBTyxXQUU3RGdCLE9BQU9DLGVBQWVSLEVBQVMsYUFBYyxDQUFFVCxPQUFPLEtIRmhETyxFQUFvQixNIiwiZmlsZSI6ImJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IElBZ2VudENvbGxlY3Rpb24gfSBmcm9tIFwiLi9JQWdlbnRDb2xsZWN0aW9uXCI7XHJcbmltcG9ydCB7IElSZW5kZXJlciB9IGZyb20gXCIuL0lSZW5kZXJlclwiO1xyXG5pbXBvcnQgeyBJQ29uZmlndXJhdGlvbiB9IGZyb20gXCIuL0NvbmZpZ3VyYXRpb25zXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgU2ltdWxhdGlvbiB7XHJcbiAgX3JlbmRlcmVyOiBJUmVuZGVyZXI7XHJcbiAgX2FnZW50czogSUFnZW50Q29sbGVjdGlvbjtcclxuXHJcbiAgY29uc3RydWN0b3IocmVuZGVyZXI6IElSZW5kZXJlciwgYWdlbnRzOiBJQWdlbnRDb2xsZWN0aW9uKSB7XHJcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgdGhpcy5fYWdlbnRzID0gYWdlbnRzO1xyXG4gIH1cclxuXHJcbiAgaW5pdChjb25maWc6IElDb25maWd1cmF0aW9uKSB7XHJcbiAgICB0aGlzLl9hZ2VudHMuaW5pdChjb25maWcuYWdlbnRzKTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZShkZWx0YVQ6IG51bWJlcikge1xyXG4gICAgdGhpcy5fYWdlbnRzLmZvckVhY2goKGFnZW50KSA9PiB7XHJcbiAgICAgIGFnZW50LnVwZGF0ZShkZWx0YVQsIHRoaXMuX2FnZW50cy5nZXRBbGwoKSk7XHJcbiAgICB9KTtcclxuICAgIHRoaXMuX2FnZW50cy5pbml0KHRoaXMuX2FnZW50cy5nZXRBbGwoKSk7XHJcbiAgfVxyXG5cclxuICBkcmF3KCkge1xyXG4gICAgdGhpcy5fcmVuZGVyZXIuY2xlYXIoKTtcclxuICAgIHRoaXMuX2FnZW50cy5mb3JFYWNoKChhZ2VudCkgPT4ge1xyXG4gICAgICB0aGlzLl9yZW5kZXJlci5kcmF3QWdlbnQoYWdlbnQpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7IElBZ2VudCB9IGZyb20gXCIuL0lBZ2VudFwiO1xyXG5pbXBvcnQgeyBJUmVuZGVyZXIgfSBmcm9tIFwiLi9JUmVuZGVyZXJcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBSZW5kZXJlcjJEIGltcGxlbWVudHMgSVJlbmRlcmVyIHtcclxuICBfY29udGV4dDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEO1xyXG5cclxuICBjb25zdHJ1Y3RvcihjYW52YXM6IEhUTUxDYW52YXNFbGVtZW50KSB7XHJcbiAgICB0aGlzLl9jb250ZXh0ID0gY2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcclxuICB9XHJcblxyXG4gIGNsZWFyKCk6IHZvaWQge1xyXG4gICAgdGhpcy5fY29udGV4dC5maWxsU3R5bGUgPSBcIndoaXRlXCI7XHJcbiAgICB0aGlzLl9jb250ZXh0LmZpbGxSZWN0KFxyXG4gICAgICAwLFxyXG4gICAgICAwLFxyXG4gICAgICB0aGlzLl9jb250ZXh0LmNhbnZhcy53aWR0aCxcclxuICAgICAgdGhpcy5fY29udGV4dC5jYW52YXMuaGVpZ2h0XHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgZHJhd0FnZW50KGFnZW50OiBJQWdlbnQpIHtcclxuICAgIGxldCBwb3NpdGlvbiA9IGFnZW50LmdldFBvc2l0aW9uKCk7XHJcbiAgICBsZXQgZGlyZWN0aW9uID0gYWdlbnQuZ2V0RGlyZWN0aW9uKCk7XHJcblxyXG4gICAgdGhpcy5fY29udGV4dC5iZWdpblBhdGgoKTtcclxuXHJcbiAgICAvLyBkcmF3IGFnZW50XHJcbiAgICBpZiAoYWdlbnQuZ2V0SXNEb25lKCkpIHtcclxuICAgICAgdGhpcy5fY29udGV4dC5zdHJva2VTdHlsZSA9IFwiIzAwRkYwMFwiO1xyXG4gICAgfSBlbHNlIGlmIChhZ2VudC5nZXRJc1N0dWNrKCkpIHtcclxuICAgICAgdGhpcy5fY29udGV4dC5zdHJva2VTdHlsZSA9IFwiI0ZGMDAwMFwiO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fY29udGV4dC5zdHJva2VTdHlsZSA9IFwiIzAwMDAwMFwiO1xyXG4gICAgfVxyXG4gICAgdGhpcy5fY29udGV4dC5hcmMocG9zaXRpb24ueCwgcG9zaXRpb24ueSwgYWdlbnQuUmFkaXVzLCAwLCAyICogTWF0aC5QSSk7XHJcblxyXG4gICAgLy8gZHJhdyBkaXJlY3Rpb25cclxuICAgIGlmIChkaXJlY3Rpb24uZHggIT09IDAgfHwgZGlyZWN0aW9uLmR5ICE9PSAwKSB7XHJcbiAgICAgIGxldCBtYWduaXR1ZGUgPSBNYXRoLnNxcnQoZGlyZWN0aW9uLmR4ICoqIDIgKyBkaXJlY3Rpb24uZHkgKiogMik7XHJcblxyXG4gICAgICB0aGlzLl9jb250ZXh0Lm1vdmVUbyhwb3NpdGlvbi54LCBwb3NpdGlvbi55KTtcclxuICAgICAgdGhpcy5fY29udGV4dC5saW5lVG8oXHJcbiAgICAgICAgcG9zaXRpb24ueCArIChhZ2VudC5SYWRpdXMgKiBkaXJlY3Rpb24uZHgpIC8gbWFnbml0dWRlLFxyXG4gICAgICAgIHBvc2l0aW9uLnkgKyAoYWdlbnQuUmFkaXVzICogZGlyZWN0aW9uLmR5KSAvIG1hZ25pdHVkZVxyXG4gICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuX2NvbnRleHQuc3Ryb2tlKCk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7IElBZ2VudCB9IGZyb20gXCIuL0lBZ2VudFwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIEJhc2ljQWdlbnQgaW1wbGVtZW50cyBJQWdlbnQge1xyXG4gIHB1YmxpYyByZWFkb25seSBJZDogbnVtYmVyO1xyXG4gIHB1YmxpYyByZWFkb25seSBSYWRpdXM6IG51bWJlcjtcclxuXHJcbiAgcHJpdmF0ZSBfcG9zaXRpb246IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfTtcclxuICBwcml2YXRlIF9nb2FsUG9zaXRpb246IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfTtcclxuICBwcml2YXRlIF9kaXJlY3Rpb246IHsgZHg6IG51bWJlcjsgZHk6IG51bWJlciB9O1xyXG4gIHByaXZhdGUgX2lzRG9uZTogYm9vbGVhbjtcclxuXHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBpZDogbnVtYmVyLFxyXG4gICAgc3RhcnRQb3NpdGlvbjogeyB4OiBudW1iZXI7IHk6IG51bWJlciB9LFxyXG4gICAgZ29hbFBvc2l0aW9uOiB7IHg6IG51bWJlcjsgeTogbnVtYmVyIH0sXHJcbiAgICByYWRpdXM6IG51bWJlclxyXG4gICkge1xyXG4gICAgdGhpcy5JZCA9IGlkO1xyXG4gICAgdGhpcy5fcG9zaXRpb24gPSBzdGFydFBvc2l0aW9uO1xyXG4gICAgdGhpcy5fZ29hbFBvc2l0aW9uID0gZ29hbFBvc2l0aW9uO1xyXG4gICAgdGhpcy5SYWRpdXMgPSByYWRpdXM7XHJcblxyXG4gICAgdGhpcy5fZGlyZWN0aW9uID0geyBkeDogMCwgZHk6IDAgfTtcclxuICAgIHRoaXMuX2lzRG9uZSA9IGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgZ2V0UG9zaXRpb24oKTogeyB4OiBudW1iZXI7IHk6IG51bWJlciB9IHtcclxuICAgIHJldHVybiB0aGlzLl9wb3NpdGlvbjtcclxuICB9XHJcblxyXG4gIGdldERpcmVjdGlvbigpOiB7IGR4OiBudW1iZXI7IGR5OiBudW1iZXIgfSB7XHJcbiAgICByZXR1cm4gdGhpcy5fZGlyZWN0aW9uO1xyXG4gIH1cclxuXHJcbiAgZ2V0SXNEb25lKCk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIHRoaXMuX2lzRG9uZTtcclxuICB9XHJcblxyXG4gIGdldElzU3R1Y2soKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG5cclxuICB1cGRhdGUoZGVsdGFUOiBudW1iZXIsIF9hZ2VudHM6IElBZ2VudFtdKTogdm9pZCB7XHJcbiAgICBpZiAodGhpcy5faXNEb25lKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBsZXQgZ29hbERpcmVjdGlvbiA9IHtcclxuICAgICAgeDogdGhpcy5fZ29hbFBvc2l0aW9uLnggLSB0aGlzLl9wb3NpdGlvbi54LFxyXG4gICAgICB5OiB0aGlzLl9nb2FsUG9zaXRpb24ueSAtIHRoaXMuX3Bvc2l0aW9uLnksXHJcbiAgICB9O1xyXG4gICAgbGV0IGdvYWxEaXN0YW5jZSA9IE1hdGguc3FydChnb2FsRGlyZWN0aW9uLnggKiogMiArIGdvYWxEaXJlY3Rpb24ueSAqKiAyKTtcclxuXHJcbiAgICBpZiAoZ29hbERpc3RhbmNlID4gKGRlbHRhVCAqIDYwKSAvIDEwMDApIHtcclxuICAgICAgdGhpcy5fZGlyZWN0aW9uLmR4ID0gZ29hbERpcmVjdGlvbi54IC8gZ29hbERpc3RhbmNlO1xyXG4gICAgICB0aGlzLl9kaXJlY3Rpb24uZHkgPSBnb2FsRGlyZWN0aW9uLnkgLyBnb2FsRGlzdGFuY2U7XHJcbiAgICAgIHRoaXMuX3Bvc2l0aW9uLnggKz0gKChkZWx0YVQgKiA2MCkgLyAxMDAwKSAqIHRoaXMuX2RpcmVjdGlvbi5keDtcclxuICAgICAgdGhpcy5fcG9zaXRpb24ueSArPSAoKGRlbHRhVCAqIDYwKSAvIDEwMDApICogdGhpcy5fZGlyZWN0aW9uLmR5O1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fcG9zaXRpb24ueCA9IHRoaXMuX2dvYWxQb3NpdGlvbi54O1xyXG4gICAgICB0aGlzLl9wb3NpdGlvbi55ID0gdGhpcy5fZ29hbFBvc2l0aW9uLnk7XHJcbiAgICAgIHRoaXMuX2lzRG9uZSA9IHRydWU7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7IElBZ2VudCB9IGZyb20gXCIuL0lBZ2VudFwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFN0b3BBZ2VudCBpbXBsZW1lbnRzIElBZ2VudCB7XHJcbiAgcHVibGljIHJlYWRvbmx5IElkOiBudW1iZXI7XHJcbiAgcHVibGljIHJlYWRvbmx5IFJhZGl1czogbnVtYmVyO1xyXG5cclxuICBwcml2YXRlIF9wb3NpdGlvbjogeyB4OiBudW1iZXI7IHk6IG51bWJlciB9O1xyXG4gIHByaXZhdGUgX2dvYWxQb3NpdGlvbjogeyB4OiBudW1iZXI7IHk6IG51bWJlciB9O1xyXG4gIHByaXZhdGUgX2RpcmVjdGlvbjogeyBkeDogbnVtYmVyOyBkeTogbnVtYmVyIH07XHJcbiAgcHJpdmF0ZSBfaXNEb25lOiBib29sZWFuO1xyXG4gIHByaXZhdGUgX2lzU3R1Y2s6IGJvb2xlYW47XHJcblxyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgaWQ6IG51bWJlcixcclxuICAgIHN0YXJ0UG9zaXRpb246IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfSxcclxuICAgIGdvYWxQb3NpdGlvbjogeyB4OiBudW1iZXI7IHk6IG51bWJlciB9LFxyXG4gICAgcmFkaXVzOiBudW1iZXJcclxuICApIHtcclxuICAgIHRoaXMuSWQgPSBpZDtcclxuICAgIHRoaXMuX3Bvc2l0aW9uID0gc3RhcnRQb3NpdGlvbjtcclxuICAgIHRoaXMuX2dvYWxQb3NpdGlvbiA9IGdvYWxQb3NpdGlvbjtcclxuICAgIHRoaXMuUmFkaXVzID0gcmFkaXVzO1xyXG5cclxuICAgIHRoaXMuX2RpcmVjdGlvbiA9IHsgZHg6IDAsIGR5OiAwIH07XHJcbiAgICB0aGlzLl9pc0RvbmUgPSBmYWxzZTtcclxuICAgIHRoaXMuX2lzU3R1Y2sgPSBmYWxzZTtcclxuICB9XHJcblxyXG4gIGdldFBvc2l0aW9uKCk6IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcG9zaXRpb247XHJcbiAgfVxyXG5cclxuICBnZXREaXJlY3Rpb24oKTogeyBkeDogbnVtYmVyOyBkeTogbnVtYmVyIH0ge1xyXG4gICAgcmV0dXJuIHRoaXMuX2RpcmVjdGlvbjtcclxuICB9XHJcblxyXG4gIGdldElzRG9uZSgpOiBib29sZWFuIHtcclxuICAgIHJldHVybiB0aGlzLl9pc0RvbmU7XHJcbiAgfVxyXG5cclxuICBnZXRJc1N0dWNrKCk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIHRoaXMuX2lzU3R1Y2s7XHJcbiAgfVxyXG5cclxuICB1cGRhdGUoZGVsdGFUOiBudW1iZXIsIGFnZW50czogSUFnZW50W10pOiB2b2lkIHtcclxuICAgIGlmICh0aGlzLl9pc0RvbmUpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIGxldCBnb2FsRGlyZWN0aW9uID0ge1xyXG4gICAgICB4OiB0aGlzLl9nb2FsUG9zaXRpb24ueCAtIHRoaXMuX3Bvc2l0aW9uLngsXHJcbiAgICAgIHk6IHRoaXMuX2dvYWxQb3NpdGlvbi55IC0gdGhpcy5fcG9zaXRpb24ueSxcclxuICAgIH07XHJcbiAgICBsZXQgZ29hbERpc3RhbmNlID0gTWF0aC5zcXJ0KGdvYWxEaXJlY3Rpb24ueCAqKiAyICsgZ29hbERpcmVjdGlvbi55ICoqIDIpO1xyXG5cclxuICAgIGlmIChnb2FsRGlzdGFuY2UgPiAoZGVsdGFUICogNjApIC8gMTAwMCkge1xyXG4gICAgICB0aGlzLl9kaXJlY3Rpb24uZHggPSBnb2FsRGlyZWN0aW9uLnggLyBnb2FsRGlzdGFuY2U7XHJcbiAgICAgIHRoaXMuX2RpcmVjdGlvbi5keSA9IGdvYWxEaXJlY3Rpb24ueSAvIGdvYWxEaXN0YW5jZTtcclxuICAgICAgbGV0IGhlYWRpbmdYID0gdGhpcy5fcG9zaXRpb24ueCArIDIwICogdGhpcy5fZGlyZWN0aW9uLmR4O1xyXG4gICAgICBsZXQgaGVhZGluZ1kgPSB0aGlzLl9wb3NpdGlvbi55ICsgMjAgKiB0aGlzLl9kaXJlY3Rpb24uZHk7XHJcblxyXG4gICAgICB0aGlzLl9pc1N0dWNrID0gZmFsc2U7XHJcbiAgICAgIGFnZW50cy5mb3JFYWNoKChhZ2VudCkgPT4ge1xyXG4gICAgICAgIGlmIChcclxuICAgICAgICAgIGFnZW50LklkICE9IHRoaXMuSWQgJiZcclxuICAgICAgICAgIHRoaXMuY29sbGlkZXMoYWdlbnQsIHsgeDogaGVhZGluZ1gsIHk6IGhlYWRpbmdZIH0pXHJcbiAgICAgICAgKSB7XHJcbiAgICAgICAgICB0aGlzLl9pc1N0dWNrID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgaWYgKCF0aGlzLl9pc1N0dWNrKSB7XHJcbiAgICAgICAgdGhpcy5fcG9zaXRpb24ueCArPSAoKGRlbHRhVCAqIDYwKSAvIDEwMDApICogdGhpcy5fZGlyZWN0aW9uLmR4O1xyXG4gICAgICAgIHRoaXMuX3Bvc2l0aW9uLnkgKz0gKChkZWx0YVQgKiA2MCkgLyAxMDAwKSAqIHRoaXMuX2RpcmVjdGlvbi5keTtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fcG9zaXRpb24ueCA9IHRoaXMuX2dvYWxQb3NpdGlvbi54O1xyXG4gICAgICB0aGlzLl9wb3NpdGlvbi55ID0gdGhpcy5fZ29hbFBvc2l0aW9uLnk7XHJcbiAgICAgIHRoaXMuX2lzRG9uZSA9IHRydWU7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBjb2xsaWRlcyhhZ2VudDogSUFnZW50LCBwb3NpdGlvbjogeyB4OiBudW1iZXI7IHk6IG51bWJlciB9KTogYm9vbGVhbiB7XHJcbiAgICBsZXQgYTF4ID0gcG9zaXRpb24ueDtcclxuICAgIGxldCBhMXkgPSBwb3NpdGlvbi55O1xyXG4gICAgbGV0IGExciA9IHRoaXMuUmFkaXVzO1xyXG4gICAgbGV0IGEyeCA9IGFnZW50LmdldFBvc2l0aW9uKCkueDtcclxuICAgIGxldCBhMnkgPSBhZ2VudC5nZXRQb3NpdGlvbigpLnk7XHJcbiAgICBsZXQgYTJyID0gYWdlbnQuUmFkaXVzO1xyXG5cclxuICAgIHJldHVybiBNYXRoLnNxcnQoKGExeCAtIGEyeCkgKiogMiArIChhMXkgLSBhMnkpICoqIDIpIDwgYTFyICsgYTJyO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgeyBJQWdlbnQgfSBmcm9tIFwiLi9JQWdlbnRcIjtcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSUNvbmZpZ3VyYXRpb24ge1xyXG4gIGFnZW50czogSUFnZW50W107XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBDb25maWd1cmF0aW9ucyB7XHJcbiAgc3RhdGljIFJhbmRvbVRvUmFuZG9tKFxyXG4gICAgbjogbnVtYmVyLFxyXG4gICAgd2lkdGg6IG51bWJlcixcclxuICAgIGhlaWdodDogbnVtYmVyLFxyXG4gICAgYWdlbnRDb25zdHJ1Y3RvcjogKFxyXG4gICAgICBpZDogbnVtYmVyLFxyXG4gICAgICBzdGFydFBvc2l0aW9uOiB7IHg6IG51bWJlcjsgeTogbnVtYmVyIH0sXHJcbiAgICAgIGdvYWxQb3NpdGlvbjogeyB4OiBudW1iZXI7IHk6IG51bWJlciB9LFxyXG4gICAgICByYWRpdXM6IG51bWJlclxyXG4gICAgKSA9PiBJQWdlbnRcclxuICApIHtcclxuICAgIC8vIFJhbmRvbSBzdGFydCBwb3NpdGlvbiB0byByYW5kb20gZ29hbCBwb3NpdGlvblxyXG4gICAgbGV0IGFnZW50czogSUFnZW50W10gPSBbXTtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbjsgaSsrKSB7XHJcbiAgICAgIGNvbnN0IGFnZW50ID0gYWdlbnRDb25zdHJ1Y3RvcihcclxuICAgICAgICBpLFxyXG4gICAgICAgIHsgeDogd2lkdGggKiBNYXRoLnJhbmRvbSgpLCB5OiBoZWlnaHQgKiBNYXRoLnJhbmRvbSgpIH0sXHJcbiAgICAgICAgeyB4OiB3aWR0aCAqIE1hdGgucmFuZG9tKCksIHk6IGhlaWdodCAqIE1hdGgucmFuZG9tKCkgfSxcclxuICAgICAgICAyMFxyXG4gICAgICApO1xyXG4gICAgICBhZ2VudHMucHVzaChhZ2VudCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHsgYWdlbnRzOiBhZ2VudHMgfSBhcyBJQ29uZmlndXJhdGlvbjtcclxuICB9XHJcblxyXG4gIHN0YXRpYyBSYW5kb21Ub0xpbmUoXHJcbiAgICBuOiBudW1iZXIsXHJcbiAgICB3aWR0aDogbnVtYmVyLFxyXG4gICAgaGVpZ2h0OiBudW1iZXIsXHJcbiAgICBhZ2VudENvbnN0cnVjdG9yOiAoXHJcbiAgICAgIGlkOiBudW1iZXIsXHJcbiAgICAgIHN0YXJ0UG9zaXRpb246IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfSxcclxuICAgICAgZ29hbFBvc2l0aW9uOiB7IHg6IG51bWJlcjsgeTogbnVtYmVyIH0sXHJcbiAgICAgIHJhZGl1czogbnVtYmVyXHJcbiAgICApID0+IElBZ2VudFxyXG4gICkge1xyXG4gICAgLy8gUmFuZG9tIHN0YXJ0IHBvc2l0aW9uIHRvIGZpeGVkIHBvc2l0aW9uIG9uIGxpbmVcclxuICAgIGxldCBhZ2VudHM6IElBZ2VudFtdID0gW107XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG47IGkrKykge1xyXG4gICAgICBjb25zdCBhZ2VudCA9IGFnZW50Q29uc3RydWN0b3IoXHJcbiAgICAgICAgaSxcclxuICAgICAgICB7IHg6IHdpZHRoICogTWF0aC5yYW5kb20oKSwgeTogaGVpZ2h0ICogTWF0aC5yYW5kb20oKSB9LFxyXG4gICAgICAgIHsgeDogKChpICsgMSkgLyAobiArIDEpKSAqIHdpZHRoLCB5OiBoZWlnaHQgLyAyIH0sXHJcbiAgICAgICAgMjBcclxuICAgICAgKTtcclxuICAgICAgYWdlbnRzLnB1c2goYWdlbnQpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7IGFnZW50czogYWdlbnRzIH0gYXMgSUNvbmZpZ3VyYXRpb247XHJcbiAgfVxyXG5cclxuICBzdGF0aWMgQ2lyY2xlVG9DaXJjbGUoXHJcbiAgICBuOiBudW1iZXIsXHJcbiAgICB3aWR0aDogbnVtYmVyLFxyXG4gICAgaGVpZ2h0OiBudW1iZXIsXHJcbiAgICBhZ2VudENvbnN0cnVjdG9yOiAoXHJcbiAgICAgIGlkOiBudW1iZXIsXHJcbiAgICAgIHN0YXJ0UG9zaXRpb246IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfSxcclxuICAgICAgZ29hbFBvc2l0aW9uOiB7IHg6IG51bWJlcjsgeTogbnVtYmVyIH0sXHJcbiAgICAgIHJhZGl1czogbnVtYmVyXHJcbiAgICApID0+IElBZ2VudFxyXG4gICkge1xyXG4gICAgLy8gUG9zaXRpb24gb24gcmFkaXVzIG9mIGNpcmNsZSB0byBvcHBvc2l0ZSBwb2ludFxyXG4gICAgbGV0IGFnZW50czogSUFnZW50W10gPSBbXTtcclxuICAgIGNvbnN0IGNlbnRyZVggPSB3aWR0aCAvIDI7XHJcbiAgICBjb25zdCBjZW50cmVZID0gaGVpZ2h0IC8gMjtcclxuICAgIGNvbnN0IHJhZGl1cyA9IGhlaWdodCAvIDIgLSAyNTtcclxuXHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG47IGkrKykge1xyXG4gICAgICBjb25zdCBhbmdsZSA9ICgyICogTWF0aC5QSSAqIGkpIC8gbjtcclxuICAgICAgY29uc3QgYWdlbnQgPSBhZ2VudENvbnN0cnVjdG9yKFxyXG4gICAgICAgIGksXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgeDogY2VudHJlWCArIHJhZGl1cyAqIE1hdGguY29zKGFuZ2xlKSxcclxuICAgICAgICAgIHk6IGNlbnRyZVkgKyByYWRpdXMgKiBNYXRoLnNpbihhbmdsZSksXHJcbiAgICAgICAgfSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICB4OiBjZW50cmVYICsgcmFkaXVzICogTWF0aC5jb3MoYW5nbGUgKyBNYXRoLlBJKSxcclxuICAgICAgICAgIHk6IGNlbnRyZVkgKyByYWRpdXMgKiBNYXRoLnNpbihhbmdsZSArIE1hdGguUEkpLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgMjBcclxuICAgICAgKTtcclxuICAgICAgYWdlbnRzLnB1c2goYWdlbnQpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7IGFnZW50czogYWdlbnRzIH0gYXMgSUNvbmZpZ3VyYXRpb247XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7IElBZ2VudENvbGxlY3Rpb24gfSBmcm9tIFwiLi9JQWdlbnRDb2xsZWN0aW9uXCI7XHJcbmltcG9ydCB7IElBZ2VudCB9IGZyb20gXCIuL0lBZ2VudFwiO1xyXG5cclxuaW50ZXJmYWNlIE5vZGUge1xyXG4gIGFnZW50OiBJQWdlbnQ7XHJcbiAgbGVmdDogTm9kZTtcclxuICByaWdodDogTm9kZTtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIEFnZW50VHJlZSBpbXBsZW1lbnRzIElBZ2VudENvbGxlY3Rpb24ge1xyXG4gIHByaXZhdGUgX3Jvb3Q6IE5vZGU7XHJcblxyXG4gIGluaXQoYWdlbnRzOiBJQWdlbnRbXSk6IHZvaWQge1xyXG4gICAgdGhpcy5fcm9vdCA9IG51bGw7XHJcbiAgICBhZ2VudHMuZm9yRWFjaCgoYWdlbnQpID0+IHtcclxuICAgICAgdGhpcy5fcm9vdCA9IHRoaXMuaW5zZXJ0KGFnZW50LCB0aGlzLl9yb290LCB0cnVlKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZ2V0QWxsKCk6IElBZ2VudFtdIHtcclxuICAgIHJldHVybiB0aGlzLmdldCh0aGlzLl9yb290KTtcclxuICB9XHJcblxyXG4gIGdldE5laWdoYm91cnNJblJhbmdlUmVjdGlsaW5lYXIoYWdlbnQ6IElBZ2VudCwgcmFuZ2U6IG51bWJlcik6IElBZ2VudFtdIHtcclxuICAgIHRocm93IG5ldyBFcnJvcihcIk1ldGhvZCBub3QgaW1wbGVtZW50ZWQuXCIpO1xyXG4gIH1cclxuICBnZXROZWlnaGJvdXJzSW5SYW5nZUV1Y2xpZGVhbihhZ2VudDogSUFnZW50LCByYW5nZTogbnVtYmVyKTogSUFnZW50W10ge1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKFwiTWV0aG9kIG5vdCBpbXBsZW1lbnRlZC5cIik7XHJcbiAgfVxyXG5cclxuICBmb3JFYWNoKGZ1bjogKGFnZW50OiBJQWdlbnQpID0+IHZvaWQpOiB2b2lkIHtcclxuICAgIHRoaXMuYXBwbHkodGhpcy5fcm9vdCwgZnVuKTtcclxuICB9XHJcblxyXG4gIGluc2VydChhZ2VudDogSUFnZW50LCByb290OiBOb2RlLCB4QXhpczogYm9vbGVhbik6IE5vZGUge1xyXG4gICAgaWYgKHJvb3QgPT0gbnVsbCkge1xyXG4gICAgICByZXR1cm4geyBhZ2VudDogYWdlbnQsIGxlZnQ6IG51bGwsIHJpZ2h0OiBudWxsIH07XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHhBeGlzKSB7XHJcbiAgICAgIGlmIChhZ2VudC5nZXRQb3NpdGlvbigpLnggPCByb290LmFnZW50LmdldFBvc2l0aW9uKCkueCkge1xyXG4gICAgICAgIHJvb3QubGVmdCA9IHRoaXMuaW5zZXJ0KGFnZW50LCByb290LmxlZnQsICF4QXhpcyk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcm9vdC5yaWdodCA9IHRoaXMuaW5zZXJ0KGFnZW50LCByb290LnJpZ2h0LCAheEF4aXMpO1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBpZiAoYWdlbnQuZ2V0UG9zaXRpb24oKS55IDwgcm9vdC5hZ2VudC5nZXRQb3NpdGlvbigpLnkpIHtcclxuICAgICAgICByb290LmxlZnQgPSB0aGlzLmluc2VydChhZ2VudCwgcm9vdC5sZWZ0LCAheEF4aXMpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJvb3QucmlnaHQgPSB0aGlzLmluc2VydChhZ2VudCwgcm9vdC5yaWdodCwgIXhBeGlzKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiByb290O1xyXG4gIH1cclxuXHJcbiAgZ2V0KHJvb3Q6IE5vZGUpOiBJQWdlbnRbXSB7XHJcbiAgICBpZiAocm9vdCA9PSBudWxsKSB7XHJcbiAgICAgIHJldHVybiBbXTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gdGhpcy5nZXQocm9vdC5sZWZ0KS5jb25jYXQodGhpcy5nZXQocm9vdC5yaWdodCkpLmNvbmNhdChyb290LmFnZW50KTtcclxuICB9XHJcblxyXG4gIGFwcGx5KHJvb3Q6IE5vZGUsIGZ1bjogKGFnZW50OiBJQWdlbnQpID0+IHZvaWQpOiB2b2lkIHtcclxuICAgIGlmIChyb290ID09IG51bGwpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bihyb290LmFnZW50KTtcclxuICAgIHRoaXMuYXBwbHkocm9vdC5sZWZ0LCBmdW4pO1xyXG4gICAgdGhpcy5hcHBseShyb290LnJpZ2h0LCBmdW4pO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgeyBTaW11bGF0aW9uIH0gZnJvbSBcIi4vU2ltdWxhdGlvblwiO1xyXG5pbXBvcnQgeyBSZW5kZXJlcjJEIH0gZnJvbSBcIi4vUmVuZGVyZXIyRFwiO1xyXG5cclxuaW1wb3J0IHsgQmFzaWNBZ2VudCB9IGZyb20gXCIuL0Jhc2ljQWdlbnRcIjtcclxuaW1wb3J0IHsgU3RvcEFnZW50IH0gZnJvbSBcIi4vU3RvcEFnZW50XCI7XHJcbmltcG9ydCB7IENvbmZpZ3VyYXRpb25zIH0gZnJvbSBcIi4vQ29uZmlndXJhdGlvbnNcIjtcclxuaW1wb3J0IHsgQWdlbnRMaXN0IH0gZnJvbSBcIi4vQWdlbnRMaXN0XCI7XHJcbmltcG9ydCB7IEFnZW50VHJlZSB9IGZyb20gXCIuL0FnZW50VHJlZVwiO1xyXG5cclxuY29uc3QgY29uZmlnU2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb25maWdcIikgYXMgSFRNTFNlbGVjdEVsZW1lbnQ7XHJcbmNvbnN0IGFnZW50VHlwZVNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFxyXG4gIFwiYWdlbnRUeXBlXCJcclxuKSBhcyBIVE1MU2VsZWN0RWxlbWVudDtcclxuY29uc3QgbnVtYmVyT2ZBZ2VudHNJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFxyXG4gIFwibnVtYmVyT2ZBZ2VudHNcIlxyXG4pIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XHJcblxyXG5jb25zdCBjYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNhbnZhc1wiKSBhcyBIVE1MQ2FudmFzRWxlbWVudDtcclxuY29uc3QgZnJhbWVyYXRlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJmcmFtZXJhdGVcIikgYXMgSFRNTFBhcmFncmFwaEVsZW1lbnQ7XHJcbmNvbnN0IHBsYXlCdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBsYXlCdXR0b25cIikgYXMgSFRNTEJ1dHRvbkVsZW1lbnQ7XHJcbmNvbnN0IHN0ZXBCdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInN0ZXBCdXR0b25cIikgYXMgSFRNTEJ1dHRvbkVsZW1lbnQ7XHJcblxyXG5jb25zdCByZW5kZXJlciA9IG5ldyBSZW5kZXJlcjJEKGNhbnZhcyk7XHJcbmNvbnN0IHNpbXVsYXRpb24gPSBuZXcgU2ltdWxhdGlvbihyZW5kZXJlciwgbmV3IEFnZW50VHJlZSgpKTtcclxudmFyIHBsYXkgPSBmYWxzZTtcclxuXHJcbi8vIGluaXRpYWxpc2Ugc2ltdWxhdGlvbiBhbmQgYmVnaW4gdXBkYXRlL3JlbmRlciBsb29wXHJcbmV4cG9ydCBmdW5jdGlvbiBpbml0KCkge1xyXG4gIHRoaXMucmVjb25maWd1cmUoKTtcclxuXHJcbiAgbGV0IGxhc3RSZW5kZXIgPSAwO1xyXG4gIGxldCBsYXN0RlBTID0gMDtcclxuICBsZXQgZnJhbWVzID0gMDtcclxuXHJcbiAgZnVuY3Rpb24gbG9vcCh0aW1lc3RhbXA6IG51bWJlcikge1xyXG4gICAgbGV0IGRlbHRhVCA9IHRpbWVzdGFtcCAtIGxhc3RSZW5kZXI7XHJcbiAgICBsYXN0UmVuZGVyID0gdGltZXN0YW1wO1xyXG5cclxuICAgIC8vIHVwZGF0ZVxyXG4gICAgaWYgKHBsYXkpIHtcclxuICAgICAgc2ltdWxhdGlvbi51cGRhdGUoZGVsdGFUKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyByZW5kZXJcclxuICAgIHNpbXVsYXRpb24uZHJhdygpO1xyXG4gICAgZnJhbWVzKys7XHJcblxyXG4gICAgLy8gcmVjYWxjdWxhdGUgZnJhbWVyYXRlIGV2ZXJ5IDI1MG1zXHJcbiAgICBpZiAodGltZXN0YW1wIC0gbGFzdEZQUyA+PSAyNTApIHtcclxuICAgICAgZnJhbWVyYXRlLnRleHRDb250ZW50ID0gYEZQUzogJHsoXHJcbiAgICAgICAgKDEwMDAgKiBmcmFtZXMpIC9cclxuICAgICAgICAodGltZXN0YW1wIC0gbGFzdEZQUylcclxuICAgICAgKS50b0ZpeGVkKDEpfWA7XHJcblxyXG4gICAgICBmcmFtZXMgPSAwO1xyXG4gICAgICBsYXN0RlBTID0gdGltZXN0YW1wO1xyXG4gICAgfVxyXG5cclxuICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUobG9vcCk7XHJcbiAgfVxyXG5cclxuICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGxvb3ApO1xyXG59XHJcblxyXG4vLyB0b2dnbGUgcGxheS9wYXVzZVxyXG5leHBvcnQgZnVuY3Rpb24gcGxheVBhdXNlKCkge1xyXG4gIHBsYXkgPSAhcGxheTtcclxuXHJcbiAgaWYgKHBsYXkpIHtcclxuICAgIHBsYXlCdXR0b24udGV4dENvbnRlbnQgPSBcIlBhdXNlXCI7XHJcbiAgICBzdGVwQnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcclxuICB9IGVsc2Uge1xyXG4gICAgcGxheUJ1dHRvbi50ZXh0Q29udGVudCA9IFwiUGxheVwiO1xyXG4gICAgc3RlcEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gIH1cclxufVxyXG5cclxuLy8gc3RlcCBzaW11bGF0aW9uIGJ5IDEgZnJhbWVcclxuZXhwb3J0IGZ1bmN0aW9uIHN0ZXAoKSB7XHJcbiAgc2ltdWxhdGlvbi51cGRhdGUoMTAwMCAvIDYwKTsgLy8gQXNzdW1lcyA2MEZQU1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcmVjb25maWd1cmUoKSB7XHJcbiAgaWYgKHBsYXkpIHtcclxuICAgIHRoaXMucGxheVBhdXNlKCk7XHJcbiAgfVxyXG5cclxuICBjb25zdCBjb25maWcgPSBjb25maWdTZWxlY3QudmFsdWU7XHJcbiAgY29uc3QgYWdlbnRUeXBlID0gYWdlbnRUeXBlU2VsZWN0LnZhbHVlOyAvLyBUT0RPOiB3aXJlIHRoaXMgaW5cclxuICBjb25zdCBuID0gcGFyc2VJbnQobnVtYmVyT2ZBZ2VudHNJbnB1dC52YWx1ZSkgPz8gMDtcclxuXHJcbiAgLy8gU2VsZWN0IGFnZW50IGNvbnN0cnVjdG9yXHJcbiAgbGV0IGFnZW50Q29uc3RydWN0b3I7XHJcbiAgc3dpdGNoIChhZ2VudFR5cGUpIHtcclxuICAgIGNhc2UgXCJCYXNpY0FnZW50XCI6XHJcbiAgICAgIGFnZW50Q29uc3RydWN0b3IgPSAoXHJcbiAgICAgICAgaWQ6IG51bWJlcixcclxuICAgICAgICBwb3NpdGlvbjogeyB4OiBudW1iZXI7IHk6IG51bWJlciB9LFxyXG4gICAgICAgIGdvYWxQb3NpdGlvbjogeyB4OiBudW1iZXI7IHk6IG51bWJlciB9LFxyXG4gICAgICAgIHJhZGl1czogbnVtYmVyXHJcbiAgICAgICkgPT4gbmV3IEJhc2ljQWdlbnQoaWQsIHBvc2l0aW9uLCBnb2FsUG9zaXRpb24sIHJhZGl1cyk7XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgY2FzZSBcIlN0b3BBZ2VudFwiOlxyXG4gICAgICBhZ2VudENvbnN0cnVjdG9yID0gKFxyXG4gICAgICAgIGlkOiBudW1iZXIsXHJcbiAgICAgICAgcG9zaXRpb246IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfSxcclxuICAgICAgICBnb2FsUG9zaXRpb246IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfSxcclxuICAgICAgICByYWRpdXM6IG51bWJlclxyXG4gICAgICApID0+IG5ldyBTdG9wQWdlbnQoaWQsIHBvc2l0aW9uLCBnb2FsUG9zaXRpb24sIHJhZGl1cyk7XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgZGVmYXVsdDoge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBZ2VudCBub3QgaW1wbGVtZW50ZWRcIik7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBTZWxlY3QgY29uZmlndXJhdGlvblxyXG4gIHN3aXRjaCAoY29uZmlnKSB7XHJcbiAgICBjYXNlIFwiUmFuZG9tVG9SYW5kb21cIjoge1xyXG4gICAgICBzaW11bGF0aW9uLmluaXQoXHJcbiAgICAgICAgQ29uZmlndXJhdGlvbnMuUmFuZG9tVG9SYW5kb20oXHJcbiAgICAgICAgICBuLFxyXG4gICAgICAgICAgY2FudmFzLndpZHRoLFxyXG4gICAgICAgICAgY2FudmFzLmhlaWdodCxcclxuICAgICAgICAgIGFnZW50Q29uc3RydWN0b3JcclxuICAgICAgICApXHJcbiAgICAgICk7XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgfVxyXG4gICAgY2FzZSBcIlJhbmRvbVRvTGluZVwiOiB7XHJcbiAgICAgIHNpbXVsYXRpb24uaW5pdChcclxuICAgICAgICBDb25maWd1cmF0aW9ucy5SYW5kb21Ub0xpbmUoXHJcbiAgICAgICAgICBuLFxyXG4gICAgICAgICAgY2FudmFzLndpZHRoLFxyXG4gICAgICAgICAgY2FudmFzLmhlaWdodCxcclxuICAgICAgICAgIGFnZW50Q29uc3RydWN0b3JcclxuICAgICAgICApXHJcbiAgICAgICk7XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgfVxyXG4gICAgY2FzZSBcIkNpcmNsZVRvQ2lyY2xlXCI6IHtcclxuICAgICAgc2ltdWxhdGlvbi5pbml0KFxyXG4gICAgICAgIENvbmZpZ3VyYXRpb25zLkNpcmNsZVRvQ2lyY2xlKFxyXG4gICAgICAgICAgbixcclxuICAgICAgICAgIGNhbnZhcy53aWR0aCxcclxuICAgICAgICAgIGNhbnZhcy5oZWlnaHQsXHJcbiAgICAgICAgICBhZ2VudENvbnN0cnVjdG9yXHJcbiAgICAgICAgKVxyXG4gICAgICApO1xyXG4gICAgICBicmVhaztcclxuICAgIH1cclxuICAgIGRlZmF1bHQ6IHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ29uZmlndXJhdGlvbiBub3QgaW1wbGVtZW50ZWRcIik7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbiIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdGlmKF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0pIHtcblx0XHRyZXR1cm4gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiLy8gbW9kdWxlIGV4cG9ydHMgbXVzdCBiZSByZXR1cm5lZCBmcm9tIHJ1bnRpbWUgc28gZW50cnkgaW5saW5pbmcgaXMgZGlzYWJsZWRcbi8vIHN0YXJ0dXBcbi8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xucmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oMzg5KTtcbiIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IChleHBvcnRzLCBkZWZpbml0aW9uKSA9PiB7XG5cdGZvcih2YXIga2V5IGluIGRlZmluaXRpb24pIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBkZWZpbml0aW9uW2tleV0gfSk7XG5cdFx0fVxuXHR9XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IChvYmosIHByb3ApID0+IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApIiwiLy8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5yID0gKGV4cG9ydHMpID0+IHtcblx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG5cdH1cblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbn07Il0sInNvdXJjZVJvb3QiOiIifQ==