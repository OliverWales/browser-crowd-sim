var CrowdSimulator;CrowdSimulator=(()=>{"use strict";var t={999:(t,e,n)=>{n.r(e),n.d(e,{init:()=>p,playPause:()=>y,step:()=>x});var o=function(){function t(t){this._renderer=t,this._agents=[]}return t.prototype.addAgent=function(t){this._agents.push(t)},t.prototype.update=function(t){this._agents.forEach((function(e){e.update(t)}))},t.prototype.draw=function(){var t=this;this._renderer.clear(),this._agents.forEach((function(e){t._renderer.drawAgent(e)}))},t}(),i=function(){function t(t){this._context=t.getContext("2d")}return t.prototype.clear=function(){this._context.fillStyle="white",this._context.fillRect(0,0,this._context.canvas.width,this._context.canvas.height)},t.prototype.drawAgent=function(t){var e=t.getPosition(),n=t.getDirection();if(this._context.beginPath(),this._context.arc(e.x,e.y,t.Radius,0,2*Math.PI),0!==n.dx||0!==n.dy){var o=Math.sqrt(Math.pow(n.dx,2)+Math.pow(n.dy,2));this._context.moveTo(e.x,e.y),this._context.lineTo(e.x+t.Radius*n.dx/o,e.y+t.Radius*n.dy/o)}this._context.stroke()},t}(),r=function(){function t(t,e,n){this._position=t,this._goalPosition=e,this.Radius=n,this._direction={dx:0,dy:0}}return t.prototype.getPosition=function(){return this._position},t.prototype.getDirection=function(){return this._direction},t.prototype.update=function(t){var e={x:this._goalPosition.x-this._position.x,y:this._goalPosition.y-this._position.y},n=Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2));n>1&&(this._direction.dx=e.x/n,this._direction.dy=e.y/n,this._position.x+=this._direction.dx,this._position.y+=this._direction.dy)},t}(),a=document.getElementById("canvas"),s=document.getElementById("framerate"),d=document.getElementById("playButton"),c=document.getElementById("stepButton"),u=new o(new i(a)),h=!1;function p(){for(var t=0;t<25;t++){var e=new r({x:a.width*Math.random(),y:a.height*Math.random()},{x:(t+1)/26*a.width,y:a.height/2},20);u.addAgent(e)}var n=0,o=0,i=0;window.requestAnimationFrame((function t(e){var r=e-n;n=e,h&&u.update(r),u.draw(),i++,e-o>=250&&(s.textContent="FPS: "+(1e3*i/(e-o)).toFixed(1),i=0,o=e),window.requestAnimationFrame(t)}))}function y(){(h=!h)?(d.textContent="Pause",c.disabled=!0):(d.textContent="Play",c.disabled=!1)}function x(){u.update(1e3/60)}}},e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={exports:{}};return t[o](i,i.exports,n),i.exports}return n.d=(t,e)=>{for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n(999)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9Dcm93ZFNpbXVsYXRvci8uL3NyYy9TaW11bGF0aW9uLnRzIiwid2VicGFjazovL0Nyb3dkU2ltdWxhdG9yLy4vc3JjL1JlbmRlcmVyMkQudHMiLCJ3ZWJwYWNrOi8vQ3Jvd2RTaW11bGF0b3IvLi9zcmMvQmFzaWNBZ2VudC50cyIsIndlYnBhY2s6Ly9Dcm93ZFNpbXVsYXRvci8uL3NyYy9tYWluLnRzIiwid2VicGFjazovL0Nyb3dkU2ltdWxhdG9yL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL0Nyb3dkU2ltdWxhdG9yL3dlYnBhY2svc3RhcnR1cCIsIndlYnBhY2s6Ly9Dcm93ZFNpbXVsYXRvci93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vQ3Jvd2RTaW11bGF0b3Ivd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly9Dcm93ZFNpbXVsYXRvci93ZWJwYWNrL3J1bnRpbWUvbWFrZSBuYW1lc3BhY2Ugb2JqZWN0Il0sIm5hbWVzIjpbInJlbmRlcmVyIiwidGhpcyIsIl9yZW5kZXJlciIsIl9hZ2VudHMiLCJhZGRBZ2VudCIsImFnZW50IiwicHVzaCIsInVwZGF0ZSIsImRlbHRhVCIsImZvckVhY2giLCJkcmF3IiwiY2xlYXIiLCJkcmF3QWdlbnQiLCJjYW52YXMiLCJfY29udGV4dCIsImdldENvbnRleHQiLCJmaWxsU3R5bGUiLCJmaWxsUmVjdCIsIndpZHRoIiwiaGVpZ2h0IiwicG9zaXRpb24iLCJnZXRQb3NpdGlvbiIsImRpcmVjdGlvbiIsImdldERpcmVjdGlvbiIsImJlZ2luUGF0aCIsImFyYyIsIngiLCJ5IiwiUmFkaXVzIiwiTWF0aCIsIlBJIiwiZHgiLCJkeSIsIm1hZ25pdHVkZSIsInNxcnQiLCJtb3ZlVG8iLCJsaW5lVG8iLCJzdHJva2UiLCJnb2FsUG9zaXRpb24iLCJyYWRpdXMiLCJfcG9zaXRpb24iLCJfZ29hbFBvc2l0aW9uIiwiX2RpcmVjdGlvbiIsImdvYWxEaXJlY3Rpb24iLCJnb2FsRGlzdGFuY2UiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiZnJhbWVyYXRlIiwicGxheUJ1dHRvbiIsInN0ZXBCdXR0b24iLCJzaW11bGF0aW9uIiwiU2ltdWxhdGlvbiIsIlJlbmRlcmVyMkQiLCJwbGF5IiwiaW5pdCIsImkiLCJCYXNpY0FnZW50IiwicmFuZG9tIiwibGFzdFJlbmRlciIsImxhc3RGUFMiLCJmcmFtZXMiLCJ3aW5kb3ciLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJsb29wIiwidGltZXN0YW1wIiwidGV4dENvbnRlbnQiLCJ0b0ZpeGVkIiwicGxheVBhdXNlIiwiZGlzYWJsZWQiLCJzdGVwIiwiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsIl9fd2VicGFja19tb2R1bGVzX18iLCJkIiwiZGVmaW5pdGlvbiIsImtleSIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJvYmoiLCJwcm9wIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiXSwibWFwcGluZ3MiOiJnSUFHQSxpQkFJRSxXQUFZQSxHQUNWQyxLQUFLQyxVQUFZRixFQUNqQkMsS0FBS0UsUUFBVSxHQW1CbkIsT0FoQkUsWUFBQUMsU0FBQSxTQUFTQyxHQUNQSixLQUFLRSxRQUFRRyxLQUFLRCxJQUdwQixZQUFBRSxPQUFBLFNBQU9DLEdBQ0xQLEtBQUtFLFFBQVFNLFNBQVEsU0FBQ0osR0FDcEJBLEVBQU1FLE9BQU9DLE9BSWpCLFlBQUFFLEtBQUEsc0JBQ0VULEtBQUtDLFVBQVVTLFFBQ2ZWLEtBQUtFLFFBQVFNLFNBQVEsU0FBQ0osR0FDcEIsRUFBS0gsVUFBVVUsVUFBVVAsT0FHL0IsRUF6QkEsR0NBQSxhQUdFLFdBQVlRLEdB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RUFBVWtCLFlBQWMsU0FDckIsSUFBT0wsR0FDUEksRUFBWUwsSUFDYk8sUUFBUSxHQUVWTixFQUFTLEVBQ1RELEVBQVVLLEdBR1pILE9BQU9DLHNCQUFzQkMsTUFPMUIsU0FBU0ksS0FDZGQsR0FBUUEsSUFHTkwsRUFBV2lCLFlBQWMsUUFDekJoQixFQUFXbUIsVUFBVyxJQUV0QnBCLEVBQVdpQixZQUFjLE9BQ3pCaEIsRUFBV21CLFVBQVcsR0FLbkIsU0FBU0MsSUFDZG5CLEVBQVczQyxPQUFPLElBQU8sT0MxRXZCK0QsRUFBMkIsR0FHL0IsU0FBU0MsRUFBb0JDLEdBRTVCLEdBQUdGLEVBQXlCRSxHQUMzQixPQUFPRixFQUF5QkUsR0FBVUMsUUFHM0MsSUFBSUMsRUFBU0osRUFBeUJFLEdBQVksQ0FHakRDLFFBQVMsSUFPVixPQUhBRSxFQUFvQkgsR0FBVUUsRUFBUUEsRUFBT0QsUUFBU0YsR0FHL0NHLEVBQU9ELFFDakJmLE9DRkFGLEVBQW9CSyxFQUFJLENBQUNILEVBQVNJLEtBQ2pDLElBQUksSUFBSUMsS0FBT0QsRUFDWE4sRUFBb0JRLEVBQUVGLEVBQVlDLEtBQVNQLEVBQW9CUSxFQUFFTixFQUFTSyxJQUM1RUUsT0FBT0MsZUFBZVIsRUFBU0ssRUFBSyxDQUFFSSxZQUFZLEVBQU1DLElBQUtOLEVBQVdDLE1DSjNFUCxFQUFvQlEsRUFBSSxDQUFDSyxFQUFLQyxJQUFTTCxPQUFPTSxVQUFVQyxlQUFlQyxLQUFLSixFQUFLQyxHQ0NqRmQsRUFBb0JrQixFQUFLaEIsSUFDSCxvQkFBWGlCLFFBQTBCQSxPQUFPQyxhQUMxQ1gsT0FBT0MsZUFBZVIsRUFBU2lCLE9BQU9DLFlBQWEsQ0FBRUMsTUFBTyxXQUU3RFosT0FBT0MsZUFBZVIsRUFBUyxhQUFjLENBQUVtQixPQUFPLEtIRmhEckIsRUFBb0IsTSIsImZpbGUiOiJidW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJQWdlbnQgfSBmcm9tIFwiLi9JQWdlbnRcIjtcclxuaW1wb3J0IHsgSVJlbmRlcmVyIH0gZnJvbSBcIi4vSVJlbmRlcmVyXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgU2ltdWxhdGlvbiB7XHJcbiAgX3JlbmRlcmVyOiBJUmVuZGVyZXI7XHJcbiAgX2FnZW50czogSUFnZW50W107XHJcblxyXG4gIGNvbnN0cnVjdG9yKHJlbmRlcmVyOiBJUmVuZGVyZXIpIHtcclxuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICB0aGlzLl9hZ2VudHMgPSBbXTtcclxuICB9XHJcblxyXG4gIGFkZEFnZW50KGFnZW50OiBJQWdlbnQpIHtcclxuICAgIHRoaXMuX2FnZW50cy5wdXNoKGFnZW50KTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZShkZWx0YVQ6IG51bWJlcikge1xyXG4gICAgdGhpcy5fYWdlbnRzLmZvckVhY2goKGFnZW50KSA9PiB7XHJcbiAgICAgIGFnZW50LnVwZGF0ZShkZWx0YVQpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBkcmF3KCkge1xyXG4gICAgdGhpcy5fcmVuZGVyZXIuY2xlYXIoKTtcclxuICAgIHRoaXMuX2FnZW50cy5mb3JFYWNoKChhZ2VudCkgPT4ge1xyXG4gICAgICB0aGlzLl9yZW5kZXJlci5kcmF3QWdlbnQoYWdlbnQpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7IElBZ2VudCB9IGZyb20gXCIuL0lBZ2VudFwiO1xyXG5pbXBvcnQgeyBJUmVuZGVyZXIgfSBmcm9tIFwiLi9JUmVuZGVyZXJcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBSZW5kZXJlcjJEIGltcGxlbWVudHMgSVJlbmRlcmVyIHtcclxuICBfY29udGV4dDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEO1xyXG5cclxuICBjb25zdHJ1Y3RvcihjYW52YXM6IEhUTUxDYW52YXNFbGVtZW50KSB7XHJcbiAgICB0aGlzLl9jb250ZXh0ID0gY2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcclxuICB9XHJcblxyXG4gIGNsZWFyKCk6IHZvaWQge1xyXG4gICAgdGhpcy5fY29udGV4dC5maWxsU3R5bGUgPSBcIndoaXRlXCI7XHJcbiAgICB0aGlzLl9jb250ZXh0LmZpbGxSZWN0KFxyXG4gICAgICAwLFxyXG4gICAgICAwLFxyXG4gICAgICB0aGlzLl9jb250ZXh0LmNhbnZhcy53aWR0aCxcclxuICAgICAgdGhpcy5fY29udGV4dC5jYW52YXMuaGVpZ2h0XHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgZHJhd0FnZW50KGFnZW50OiBJQWdlbnQpIHtcclxuICAgIGxldCBwb3NpdGlvbiA9IGFnZW50LmdldFBvc2l0aW9uKCk7XHJcbiAgICBsZXQgZGlyZWN0aW9uID0gYWdlbnQuZ2V0RGlyZWN0aW9uKCk7XHJcblxyXG4gICAgdGhpcy5fY29udGV4dC5iZWdpblBhdGgoKTtcclxuXHJcbiAgICAvLyBkcmF3IGFnZW50XHJcbiAgICB0aGlzLl9jb250ZXh0LmFyYyhwb3NpdGlvbi54LCBwb3NpdGlvbi55LCBhZ2VudC5SYWRpdXMsIDAsIDIgKiBNYXRoLlBJKTtcclxuXHJcbiAgICAvLyBkcmF3IGRpcmVjdGlvblxyXG4gICAgaWYgKGRpcmVjdGlvbi5keCAhPT0gMCB8fCBkaXJlY3Rpb24uZHkgIT09IDApIHtcclxuICAgICAgbGV0IG1hZ25pdHVkZSA9IE1hdGguc3FydChkaXJlY3Rpb24uZHggKiogMiArIGRpcmVjdGlvbi5keSAqKiAyKTtcclxuXHJcbiAgICAgIHRoaXMuX2NvbnRleHQubW92ZVRvKHBvc2l0aW9uLngsIHBvc2l0aW9uLnkpO1xyXG4gICAgICB0aGlzLl9jb250ZXh0LmxpbmVUbyhcclxuICAgICAgICBwb3NpdGlvbi54ICsgKGFnZW50LlJhZGl1cyAqIGRpcmVjdGlvbi5keCkgLyBtYWduaXR1ZGUsXHJcbiAgICAgICAgcG9zaXRpb24ueSArIChhZ2VudC5SYWRpdXMgKiBkaXJlY3Rpb24uZHkpIC8gbWFnbml0dWRlXHJcbiAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5fY29udGV4dC5zdHJva2UoKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgSUFnZW50IH0gZnJvbSBcIi4vSUFnZW50XCI7XHJcblxyXG5leHBvcnQgY2xhc3MgQmFzaWNBZ2VudCBpbXBsZW1lbnRzIElBZ2VudCB7XHJcbiAgcHJpdmF0ZSBfcG9zaXRpb246IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfTtcclxuICBwcml2YXRlIF9nb2FsUG9zaXRpb246IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfTtcclxuICBwdWJsaWMgcmVhZG9ubHkgUmFkaXVzOiBudW1iZXI7XHJcblxyXG4gIHByaXZhdGUgX2RpcmVjdGlvbjogeyBkeDogbnVtYmVyOyBkeTogbnVtYmVyIH07XHJcblxyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcG9zaXRpb246IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfSxcclxuICAgIGdvYWxQb3NpdGlvbjogeyB4OiBudW1iZXI7IHk6IG51bWJlciB9LFxyXG4gICAgcmFkaXVzOiBudW1iZXJcclxuICApIHtcclxuICAgIHRoaXMuX3Bvc2l0aW9uID0gcG9zaXRpb247XHJcbiAgICB0aGlzLl9nb2FsUG9zaXRpb24gPSBnb2FsUG9zaXRpb247XHJcbiAgICB0aGlzLlJhZGl1cyA9IHJhZGl1cztcclxuXHJcbiAgICB0aGlzLl9kaXJlY3Rpb24gPSB7IGR4OiAwLCBkeTogMCB9O1xyXG4gIH1cclxuXHJcbiAgZ2V0UG9zaXRpb24oKTogeyB4OiBudW1iZXI7IHk6IG51bWJlciB9IHtcclxuICAgIHJldHVybiB0aGlzLl9wb3NpdGlvbjtcclxuICB9XHJcblxyXG4gIGdldERpcmVjdGlvbigpOiB7IGR4OiBudW1iZXI7IGR5OiBudW1iZXIgfSB7XHJcbiAgICByZXR1cm4gdGhpcy5fZGlyZWN0aW9uO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlKGRlbHRhVDogbnVtYmVyKTogdm9pZCB7XHJcbiAgICBsZXQgZ29hbERpcmVjdGlvbiA9IHtcclxuICAgICAgeDogdGhpcy5fZ29hbFBvc2l0aW9uLnggLSB0aGlzLl9wb3NpdGlvbi54LFxyXG4gICAgICB5OiB0aGlzLl9nb2FsUG9zaXRpb24ueSAtIHRoaXMuX3Bvc2l0aW9uLnksXHJcbiAgICB9O1xyXG4gICAgbGV0IGdvYWxEaXN0YW5jZSA9IE1hdGguc3FydChnb2FsRGlyZWN0aW9uLnggKiogMiArIGdvYWxEaXJlY3Rpb24ueSAqKiAyKTtcclxuXHJcbiAgICBpZiAoZ29hbERpc3RhbmNlID4gMSkge1xyXG4gICAgICB0aGlzLl9kaXJlY3Rpb24uZHggPSBnb2FsRGlyZWN0aW9uLnggLyBnb2FsRGlzdGFuY2U7XHJcbiAgICAgIHRoaXMuX2RpcmVjdGlvbi5keSA9IGdvYWxEaXJlY3Rpb24ueSAvIGdvYWxEaXN0YW5jZTtcclxuICAgICAgdGhpcy5fcG9zaXRpb24ueCArPSB0aGlzLl9kaXJlY3Rpb24uZHg7XHJcbiAgICAgIHRoaXMuX3Bvc2l0aW9uLnkgKz0gdGhpcy5fZGlyZWN0aW9uLmR5O1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgeyBTaW11bGF0aW9uIH0gZnJvbSBcIi4vU2ltdWxhdGlvblwiO1xyXG5pbXBvcnQgeyBSZW5kZXJlcjJEIH0gZnJvbSBcIi4vUmVuZGVyZXIyRFwiO1xyXG5pbXBvcnQgeyBCYXNpY0FnZW50IH0gZnJvbSBcIi4vQmFzaWNBZ2VudFwiO1xyXG5cclxuY29uc3QgY2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjYW52YXNcIikgYXMgSFRNTENhbnZhc0VsZW1lbnQ7XHJcbmNvbnN0IGZyYW1lcmF0ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZnJhbWVyYXRlXCIpIGFzIEhUTUxDYW52YXNFbGVtZW50O1xyXG5jb25zdCBwbGF5QnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwbGF5QnV0dG9uXCIpIGFzIEhUTUxCdXR0b25FbGVtZW50O1xyXG5jb25zdCBzdGVwQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzdGVwQnV0dG9uXCIpIGFzIEhUTUxCdXR0b25FbGVtZW50O1xyXG5cclxuY29uc3QgcmVuZGVyZXIgPSBuZXcgUmVuZGVyZXIyRChjYW52YXMpO1xyXG5jb25zdCBzaW11bGF0aW9uID0gbmV3IFNpbXVsYXRpb24ocmVuZGVyZXIpO1xyXG52YXIgcGxheSA9IGZhbHNlO1xyXG5cclxuLy8gaW5pdGlhbGlzZSBzaW11bGF0aW9uIGFuZCBiZWdpbiB1cGRhdGUvcmVuZGVyIGxvb3BcclxuZXhwb3J0IGZ1bmN0aW9uIGluaXQoKSB7XHJcbiAgbGV0IG4gPSAyNTtcclxuICBmb3IgKGxldCBpID0gMDsgaSA8IDI1OyBpKyspIHtcclxuICAgIGNvbnN0IGFnZW50ID0gbmV3IEJhc2ljQWdlbnQoXHJcbiAgICAgIHsgeDogY2FudmFzLndpZHRoICogTWF0aC5yYW5kb20oKSwgeTogY2FudmFzLmhlaWdodCAqIE1hdGgucmFuZG9tKCkgfSwgLy8gc3RhcnQgcG9zaXRpb25cclxuICAgICAgeyB4OiAoKGkgKyAxKSAvIChuICsgMSkpICogY2FudmFzLndpZHRoLCB5OiBjYW52YXMuaGVpZ2h0IC8gMiB9LCAvLyBnb2FsIHBvc2l0aW9uXHJcbiAgICAgIDIwIC8vIHJhZGl1c1xyXG4gICAgKTtcclxuXHJcbiAgICBzaW11bGF0aW9uLmFkZEFnZW50KGFnZW50KTtcclxuICB9XHJcblxyXG4gIGxldCBsYXN0UmVuZGVyID0gMDtcclxuICBsZXQgbGFzdEZQUyA9IDA7XHJcbiAgbGV0IGZyYW1lcyA9IDA7XHJcblxyXG4gIGZ1bmN0aW9uIGxvb3AodGltZXN0YW1wOiBudW1iZXIpIHtcclxuICAgIGxldCBkZWx0YVQgPSB0aW1lc3RhbXAgLSBsYXN0UmVuZGVyO1xyXG4gICAgbGFzdFJlbmRlciA9IHRpbWVzdGFtcDtcclxuXHJcbiAgICAvLyB1cGRhdGVcclxuICAgIGlmIChwbGF5KSB7XHJcbiAgICAgIHNpbXVsYXRpb24udXBkYXRlKGRlbHRhVCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gcmVuZGVyXHJcbiAgICBzaW11bGF0aW9uLmRyYXcoKTtcclxuICAgIGZyYW1lcysrO1xyXG5cclxuICAgIC8vIHJlY2FsY3VsYXRlIGZyYW1lcmF0ZSBldmVyeSAyNTBtc1xyXG4gICAgaWYgKHRpbWVzdGFtcCAtIGxhc3RGUFMgPj0gMjUwKSB7XHJcbiAgICAgIGZyYW1lcmF0ZS50ZXh0Q29udGVudCA9IGBGUFM6ICR7KFxyXG4gICAgICAgICgxMDAwICogZnJhbWVzKSAvXHJcbiAgICAgICAgKHRpbWVzdGFtcCAtIGxhc3RGUFMpXHJcbiAgICAgICkudG9GaXhlZCgxKX1gO1xyXG5cclxuICAgICAgZnJhbWVzID0gMDtcclxuICAgICAgbGFzdEZQUyA9IHRpbWVzdGFtcDtcclxuICAgIH1cclxuXHJcbiAgICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGxvb3ApO1xyXG4gIH1cclxuXHJcbiAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZShsb29wKTtcclxufVxyXG5cclxuLy8gdG9nZ2xlIHBsYXkvcGF1c2VcclxuZXhwb3J0IGZ1bmN0aW9uIHBsYXlQYXVzZSgpIHtcclxuICBwbGF5ID0gIXBsYXk7XHJcblxyXG4gIGlmIChwbGF5KSB7XHJcbiAgICBwbGF5QnV0dG9uLnRleHRDb250ZW50ID0gXCJQYXVzZVwiO1xyXG4gICAgc3RlcEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgfSBlbHNlIHtcclxuICAgIHBsYXlCdXR0b24udGV4dENvbnRlbnQgPSBcIlBsYXlcIjtcclxuICAgIHN0ZXBCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcclxuICB9XHJcbn1cclxuXHJcbi8vIHN0ZXAgc2ltdWxhdGlvbiBieSAxIGZyYW1lXHJcbmV4cG9ydCBmdW5jdGlvbiBzdGVwKCkge1xyXG4gIHNpbXVsYXRpb24udXBkYXRlKDEwMDAgLyA2MCk7IC8vIEFzc3VtZXMgNjBGUFNcclxufVxyXG4iLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHRpZihfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdKSB7XG5cdFx0cmV0dXJuIF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0uZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXShtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsIi8vIG1vZHVsZSBleHBvcnRzIG11c3QgYmUgcmV0dXJuZWQgZnJvbSBydW50aW1lIHNvIGVudHJ5IGlubGluaW5nIGlzIGRpc2FibGVkXG4vLyBzdGFydHVwXG4vLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbnJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKDk5OSk7XG4iLCIvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9ucyBmb3IgaGFybW9ueSBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSAoZXhwb3J0cywgZGVmaW5pdGlvbikgPT4ge1xuXHRmb3IodmFyIGtleSBpbiBkZWZpbml0aW9uKSB7XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGRlZmluaXRpb24sIGtleSkgJiYgIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBrZXkpKSB7XG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZGVmaW5pdGlvbltrZXldIH0pO1xuXHRcdH1cblx0fVxufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSAob2JqLCBwcm9wKSA9PiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKSIsIi8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uciA9IChleHBvcnRzKSA9PiB7XG5cdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuXHR9XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG59OyJdLCJzb3VyY2VSb290IjoiIn0=