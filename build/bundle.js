var CrowdSimulator;CrowdSimulator=(()=>{"use strict";var t={240:(t,e,n)=>{n.r(e),n.d(e,{init:()=>m,playPause:()=>g,reconfigure:()=>_,step:()=>x});var o=function(){function t(t){this._renderer=t,this._agents=[]}return t.prototype.init=function(t){this._agents=t.agents},t.prototype.update=function(t){this._agents.forEach((function(e){e.update(t)}))},t.prototype.draw=function(){var t=this;this._renderer.clear(),this._agents.forEach((function(e){t._renderer.drawAgent(e)}))},t}(),i=function(){function t(t){this._context=t.getContext("2d")}return t.prototype.clear=function(){this._context.fillStyle="white",this._context.fillRect(0,0,this._context.canvas.width,this._context.canvas.height)},t.prototype.drawAgent=function(t){var e=t.getPosition(),n=t.getDirection();if(this._context.beginPath(),this._context.arc(e.x,e.y,t.Radius,0,2*Math.PI),0!==n.dx||0!==n.dy){var o=Math.sqrt(Math.pow(n.dx,2)+Math.pow(n.dy,2));this._context.moveTo(e.x,e.y),this._context.lineTo(e.x+t.Radius*n.dx/o,e.y+t.Radius*n.dy/o)}this._context.stroke()},t}(),r=function(){function t(t,e,n){this._position=t,this._goalPosition=e,this.Radius=n,this._direction={dx:0,dy:0}}return t.prototype.getPosition=function(){return this._position},t.prototype.getDirection=function(){return this._direction},t.prototype.update=function(t){var e={x:this._goalPosition.x-this._position.x,y:this._goalPosition.y-this._position.y},n=Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2));n>t/16?(this._direction.dx=e.x/n,this._direction.dy=e.y/n,this._position.x+=t/16*this._direction.dx,this._position.y+=t/16*this._direction.dy):(this._position.x=this._goalPosition.x,this._position.y=this._goalPosition.y)},t}(),a=function(){function t(){}return t.RandomToRandom=function(t,e,n,o){for(var i=[],r=0;r<t;r++){var a=o({x:e*Math.random(),y:n*Math.random()},{x:e*Math.random(),y:n*Math.random()},20);i.push(a)}return{agents:i}},t.RandomToLine=function(t,e,n,o){for(var i=[],r=0;r<t;r++){var a=o({x:e*Math.random(),y:n*Math.random()},{x:(r+1)/(t+1)*e,y:n/2},20);i.push(a)}return{agents:i}},t.CircleToCircle=function(t,e,n,o){for(var i=[],r=e/2,a=n/2,s=n/2-25,d=0;d<t;d++){var c=2*Math.PI*d/t,u=o({x:r+s*Math.cos(c),y:a+s*Math.sin(c)},{x:r+s*Math.cos(c+Math.PI),y:a+s*Math.sin(c+Math.PI)},20);i.push(u)}return{agents:i}},t}(),s=document.getElementById("config"),d=document.getElementById("agentType"),c=document.getElementById("numberOfAgents"),u=document.getElementById("canvas"),h=document.getElementById("framerate"),p=document.getElementById("playButton"),l=document.getElementById("stepButton"),y=new o(new i(u)),f=!1;function m(){this.reconfigure();var t=0,e=0,n=0;window.requestAnimationFrame((function o(i){var r=i-t;t=i,f&&y.update(r),y.draw(),n++,i-e>=250&&(h.textContent="FPS: "+(1e3*n/(i-e)).toFixed(1),n=0,e=i),window.requestAnimationFrame(o)}))}function g(){(f=!f)?(p.textContent="Pause",l.disabled=!0):(p.textContent="Play",l.disabled=!1)}function x(){y.update(1e3/60)}function _(){var t;f&&this.playPause();var e,n=s.value,o=d.value,i=null!==(t=parseInt(c.value))&&void 0!==t?t:0;switch(o){case"BasicAgent":e=function(t,e,n){return new r(t,e,n)};break;default:throw new Error("Agent not implemented")}switch(n){case"RandomToRandom":y.init(a.RandomToRandom(i,u.width,u.height,e));break;case"RandomToLine":y.init(a.RandomToLine(i,u.width,u.height,e));break;case"CircleToCircle":y.init(a.CircleToCircle(i,u.width,u.height,e));break;default:throw new Error("Configuration not implemented")}}}},e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={exports:{}};return t[o](i,i.exports,n),i.exports}return n.d=(t,e)=>{for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n(240)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9Dcm93ZFNpbXVsYXRvci8uL3NyYy9TaW11bGF0aW9uLnRzIiwid2VicGFjazovL0Nyb3dkU2ltdWxhdG9yLy4vc3JjL1JlbmRlcmVyMkQudHMiLCJ3ZWJwYWNrOi8vQ3Jvd2RTaW11bGF0b3IvLi9zcmMvQmFzaWNBZ2VudC50cyIsIndlYnBhY2s6Ly9Dcm93ZFNpbXVsYXRvci8uL3NyYy9Db25maWd1cmF0aW9ucy50cyIsIndlYnBhY2s6Ly9Dcm93ZFNpbXVsYXRvci8uL3NyYy9tYWluLnRzIiwid2VicGFjazovL0Nyb3dkU2ltdWxhdG9yL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL0Nyb3dkU2ltdWxhdG9yL3dlYnBhY2svc3RhcnR1cCIsIndlYnBhY2s6Ly9Dcm93ZFNpbXVsYXRvci93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vQ3Jvd2RTaW11bGF0b3Ivd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly9Dcm93ZFNpbXVsYXRvci93ZWJwYWNrL3J1bnRpbWUvbWFrZSBuYW1lc3BhY2Ugb2JqZWN0Il0sIm5hbWVzIjpbInJlbmRlcmVyIiwidGhpcyIsIl9yZW5kZXJlciIsIl9hZ2VudHMiLCJpbml0IiwiY29uZmlnIiwiYWdlbnRzIiwidXBkYXRlIiwiZGVsdGFUIiwiZm9yRWFjaCIsImFnZW50IiwiZHJhdyIsImNsZWFyIiwiZHJhd0FnZW50IiwiY2FudmFzIiwiX2NvbnRleHQiLCJnZXRDb250ZXh0IiwiZmlsbFN0eWxlIiwiZmlsbFJlY3QiLCJ3aWR0aCIsImhlaWdodCIsInBvc2l0aW9uIiwiZ2V0UG9zaXRpb24iLCJkaXJlY3Rpb24iLCJnZXREaXJlY3Rpb24iLCJiZWdpblBhdGgiLCJhcmMiLCJ4IiwieSIsIlJhZGl1cyIsIk1hdGgiLCJQSSIsImR4IiwiZHkiLCJtYWduaXR1ZGUiLCJzcXJ0IiwibW92ZVRvIiwibGluZVRvIiwic3Ryb2tlIiwiZ29hbFBvc2l0aW9uIiwicmFkaXVzIiwiX3Bvc2l0aW9uIiwiX2dvYWxQb3NpdGlvbiIsIl9kaXJlY3Rpb24iLCJnb2FsRGlyZWN0aW9uIiwiZ29hbERpc3RhbmNlIiwiUmFuZG9tVG9SYW5kb20iLCJuIiwiYWdlbnRDb25zdHJ1Y3RvciIsImkiLCJyYW5kb20iLCJwdXNoIiwiUmFuZG9tVG9MaW5lIiwiQ2lyY2xlVG9DaXJjbGUiLCJjZW50cmVYIiwiY2VudHJlWSIsImFuZ2xlIiwiY29zIiwic2luIiwiY29uZmlnU2VsZWN0IiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImFnZW50VHlwZVNlbGVjdCIsIm51bWJlck9mQWdlbnRzSW5wdXQiLCJmcmFtZXJhdGUiLCJwbGF5QnV0dG9uIiwic3RlcEJ1dHRvbiIsInNpbXVsYXRpb24iLCJTaW11bGF0aW9uIiwiUmVuZGVyZXIyRCIsInBsYXkiLCJyZWNvbmZpZ3VyZSIsImxhc3RSZW5kZXIiLCJsYXN0RlBTIiwiZnJhbWVzIiwid2luZG93IiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwibG9vcCIsInRpbWVzdGFtcCIsInRleHRDb250ZW50IiwidG9GaXhlZCIsInBsYXlQYXVzZSIsImRpc2FibGVkIiwic3RlcCIsInZhbHVlIiwiYWdlbnRUeXBlIiwicGFyc2VJbnQiLCJCYXNpY0FnZW50IiwiRXJyb3IiLCJDb25maWd1cmF0aW9ucyIsIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJfX3dlYnBhY2tfbW9kdWxlc19fIiwiZCIsImRlZmluaXRpb24iLCJrZXkiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0Iiwib2JqIiwicHJvcCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyJdLCJtYXBwaW5ncyI6ImtKQUlBLGlCQUlF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SUNvbmZpZ3VyYXRpb24gfSBmcm9tIFwiLi9Db25maWd1cmF0aW9uc1wiO1xyXG5pbXBvcnQgeyBJQWdlbnQgfSBmcm9tIFwiLi9JQWdlbnRcIjtcclxuaW1wb3J0IHsgSVJlbmRlcmVyIH0gZnJvbSBcIi4vSVJlbmRlcmVyXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgU2ltdWxhdGlvbiB7XHJcbiAgX3JlbmRlcmVyOiBJUmVuZGVyZXI7XHJcbiAgX2FnZW50czogSUFnZW50W107XHJcblxyXG4gIGNvbnN0cnVjdG9yKHJlbmRlcmVyOiBJUmVuZGVyZXIpIHtcclxuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICB0aGlzLl9hZ2VudHMgPSBbXTtcclxuICB9XHJcblxyXG4gIGluaXQoY29uZmlnOiBJQ29uZmlndXJhdGlvbikge1xyXG4gICAgdGhpcy5fYWdlbnRzID0gY29uZmlnLmFnZW50cztcclxuICB9XHJcblxyXG4gIHVwZGF0ZShkZWx0YVQ6IG51bWJlcikge1xyXG4gICAgdGhpcy5fYWdlbnRzLmZvckVhY2goKGFnZW50KSA9PiB7XHJcbiAgICAgIGFnZW50LnVwZGF0ZShkZWx0YVQpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBkcmF3KCkge1xyXG4gICAgdGhpcy5fcmVuZGVyZXIuY2xlYXIoKTtcclxuICAgIHRoaXMuX2FnZW50cy5mb3JFYWNoKChhZ2VudCkgPT4ge1xyXG4gICAgICB0aGlzLl9yZW5kZXJlci5kcmF3QWdlbnQoYWdlbnQpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7IElBZ2VudCB9IGZyb20gXCIuL0lBZ2VudFwiO1xyXG5pbXBvcnQgeyBJUmVuZGVyZXIgfSBmcm9tIFwiLi9JUmVuZGVyZXJcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBSZW5kZXJlcjJEIGltcGxlbWVudHMgSVJlbmRlcmVyIHtcclxuICBfY29udGV4dDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEO1xyXG5cclxuICBjb25zdHJ1Y3RvcihjYW52YXM6IEhUTUxDYW52YXNFbGVtZW50KSB7XHJcbiAgICB0aGlzLl9jb250ZXh0ID0gY2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcclxuICB9XHJcblxyXG4gIGNsZWFyKCk6IHZvaWQge1xyXG4gICAgdGhpcy5fY29udGV4dC5maWxsU3R5bGUgPSBcIndoaXRlXCI7XHJcbiAgICB0aGlzLl9jb250ZXh0LmZpbGxSZWN0KFxyXG4gICAgICAwLFxyXG4gICAgICAwLFxyXG4gICAgICB0aGlzLl9jb250ZXh0LmNhbnZhcy53aWR0aCxcclxuICAgICAgdGhpcy5fY29udGV4dC5jYW52YXMuaGVpZ2h0XHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgZHJhd0FnZW50KGFnZW50OiBJQWdlbnQpIHtcclxuICAgIGxldCBwb3NpdGlvbiA9IGFnZW50LmdldFBvc2l0aW9uKCk7XHJcbiAgICBsZXQgZGlyZWN0aW9uID0gYWdlbnQuZ2V0RGlyZWN0aW9uKCk7XHJcblxyXG4gICAgdGhpcy5fY29udGV4dC5iZWdpblBhdGgoKTtcclxuXHJcbiAgICAvLyBkcmF3IGFnZW50XHJcbiAgICB0aGlzLl9jb250ZXh0LmFyYyhwb3NpdGlvbi54LCBwb3NpdGlvbi55LCBhZ2VudC5SYWRpdXMsIDAsIDIgKiBNYXRoLlBJKTtcclxuXHJcbiAgICAvLyBkcmF3IGRpcmVjdGlvblxyXG4gICAgaWYgKGRpcmVjdGlvbi5keCAhPT0gMCB8fCBkaXJlY3Rpb24uZHkgIT09IDApIHtcclxuICAgICAgbGV0IG1hZ25pdHVkZSA9IE1hdGguc3FydChkaXJlY3Rpb24uZHggKiogMiArIGRpcmVjdGlvbi5keSAqKiAyKTtcclxuXHJcbiAgICAgIHRoaXMuX2NvbnRleHQubW92ZVRvKHBvc2l0aW9uLngsIHBvc2l0aW9uLnkpO1xyXG4gICAgICB0aGlzLl9jb250ZXh0LmxpbmVUbyhcclxuICAgICAgICBwb3NpdGlvbi54ICsgKGFnZW50LlJhZGl1cyAqIGRpcmVjdGlvbi5keCkgLyBtYWduaXR1ZGUsXHJcbiAgICAgICAgcG9zaXRpb24ueSArIChhZ2VudC5SYWRpdXMgKiBkaXJlY3Rpb24uZHkpIC8gbWFnbml0dWRlXHJcbiAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5fY29udGV4dC5zdHJva2UoKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgSUFnZW50IH0gZnJvbSBcIi4vSUFnZW50XCI7XHJcblxyXG5leHBvcnQgY2xhc3MgQmFzaWNBZ2VudCBpbXBsZW1lbnRzIElBZ2VudCB7XHJcbiAgcHJpdmF0ZSBfcG9zaXRpb246IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfTtcclxuICBwcml2YXRlIF9nb2FsUG9zaXRpb246IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfTtcclxuICBwdWJsaWMgcmVhZG9ubHkgUmFkaXVzOiBudW1iZXI7XHJcblxyXG4gIHByaXZhdGUgX2RpcmVjdGlvbjogeyBkeDogbnVtYmVyOyBkeTogbnVtYmVyIH07XHJcblxyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcG9zaXRpb246IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfSxcclxuICAgIGdvYWxQb3NpdGlvbjogeyB4OiBudW1iZXI7IHk6IG51bWJlciB9LFxyXG4gICAgcmFkaXVzOiBudW1iZXJcclxuICApIHtcclxuICAgIHRoaXMuX3Bvc2l0aW9uID0gcG9zaXRpb247XHJcbiAgICB0aGlzLl9nb2FsUG9zaXRpb24gPSBnb2FsUG9zaXRpb247XHJcbiAgICB0aGlzLlJhZGl1cyA9IHJhZGl1cztcclxuXHJcbiAgICB0aGlzLl9kaXJlY3Rpb24gPSB7IGR4OiAwLCBkeTogMCB9O1xyXG4gIH1cclxuXHJcbiAgZ2V0UG9zaXRpb24oKTogeyB4OiBudW1iZXI7IHk6IG51bWJlciB9IHtcclxuICAgIHJldHVybiB0aGlzLl9wb3NpdGlvbjtcclxuICB9XHJcblxyXG4gIGdldERpcmVjdGlvbigpOiB7IGR4OiBudW1iZXI7IGR5OiBudW1iZXIgfSB7XHJcbiAgICByZXR1cm4gdGhpcy5fZGlyZWN0aW9uO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlKGRlbHRhVDogbnVtYmVyKTogdm9pZCB7XHJcbiAgICBsZXQgZ29hbERpcmVjdGlvbiA9IHtcclxuICAgICAgeDogdGhpcy5fZ29hbFBvc2l0aW9uLnggLSB0aGlzLl9wb3NpdGlvbi54LFxyXG4gICAgICB5OiB0aGlzLl9nb2FsUG9zaXRpb24ueSAtIHRoaXMuX3Bvc2l0aW9uLnksXHJcbiAgICB9O1xyXG4gICAgbGV0IGdvYWxEaXN0YW5jZSA9IE1hdGguc3FydChnb2FsRGlyZWN0aW9uLnggKiogMiArIGdvYWxEaXJlY3Rpb24ueSAqKiAyKTtcclxuXHJcbiAgICBpZiAoZ29hbERpc3RhbmNlID4gZGVsdGFUIC8gMTYpIHtcclxuICAgICAgdGhpcy5fZGlyZWN0aW9uLmR4ID0gZ29hbERpcmVjdGlvbi54IC8gZ29hbERpc3RhbmNlO1xyXG4gICAgICB0aGlzLl9kaXJlY3Rpb24uZHkgPSBnb2FsRGlyZWN0aW9uLnkgLyBnb2FsRGlzdGFuY2U7XHJcbiAgICAgIHRoaXMuX3Bvc2l0aW9uLnggKz0gKGRlbHRhVCAvIDE2KSAqIHRoaXMuX2RpcmVjdGlvbi5keDtcclxuICAgICAgdGhpcy5fcG9zaXRpb24ueSArPSAoZGVsdGFUIC8gMTYpICogdGhpcy5fZGlyZWN0aW9uLmR5O1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fcG9zaXRpb24ueCA9IHRoaXMuX2dvYWxQb3NpdGlvbi54O1xyXG4gICAgICB0aGlzLl9wb3NpdGlvbi55ID0gdGhpcy5fZ29hbFBvc2l0aW9uLnk7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7IElBZ2VudCB9IGZyb20gXCIuL0lBZ2VudFwiO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBJQ29uZmlndXJhdGlvbiB7XHJcbiAgYWdlbnRzOiBJQWdlbnRbXTtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIENvbmZpZ3VyYXRpb25zIHtcclxuICBzdGF0aWMgUmFuZG9tVG9SYW5kb20oXHJcbiAgICBuOiBudW1iZXIsXHJcbiAgICB3aWR0aDogbnVtYmVyLFxyXG4gICAgaGVpZ2h0OiBudW1iZXIsXHJcbiAgICBhZ2VudENvbnN0cnVjdG9yOiAoXHJcbiAgICAgIHN0YXJ0UG9zaXRpb246IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfSxcclxuICAgICAgZ29hbFBvc2l0aW9uOiB7IHg6IG51bWJlcjsgeTogbnVtYmVyIH0sXHJcbiAgICAgIHJhZGl1czogbnVtYmVyXHJcbiAgICApID0+IElBZ2VudFxyXG4gICkge1xyXG4gICAgLy8gUmFuZG9tIHN0YXJ0IHBvc2l0aW9uIHRvIHJhbmRvbSBnb2FsIHBvc2l0aW9uXHJcbiAgICBsZXQgYWdlbnRzOiBJQWdlbnRbXSA9IFtdO1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBuOyBpKyspIHtcclxuICAgICAgY29uc3QgYWdlbnQgPSBhZ2VudENvbnN0cnVjdG9yKFxyXG4gICAgICAgIHsgeDogd2lkdGggKiBNYXRoLnJhbmRvbSgpLCB5OiBoZWlnaHQgKiBNYXRoLnJhbmRvbSgpIH0sXHJcbiAgICAgICAgeyB4OiB3aWR0aCAqIE1hdGgucmFuZG9tKCksIHk6IGhlaWdodCAqIE1hdGgucmFuZG9tKCkgfSxcclxuICAgICAgICAyMFxyXG4gICAgICApO1xyXG4gICAgICBhZ2VudHMucHVzaChhZ2VudCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHsgYWdlbnRzOiBhZ2VudHMgfSBhcyBJQ29uZmlndXJhdGlvbjtcclxuICB9XHJcblxyXG4gIHN0YXRpYyBSYW5kb21Ub0xpbmUoXHJcbiAgICBuOiBudW1iZXIsXHJcbiAgICB3aWR0aDogbnVtYmVyLFxyXG4gICAgaGVpZ2h0OiBudW1iZXIsXHJcbiAgICBhZ2VudENvbnN0cnVjdG9yOiAoXHJcbiAgICAgIHN0YXJ0UG9zaXRpb246IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfSxcclxuICAgICAgZ29hbFBvc2l0aW9uOiB7IHg6IG51bWJlcjsgeTogbnVtYmVyIH0sXHJcbiAgICAgIHJhZGl1czogbnVtYmVyXHJcbiAgICApID0+IElBZ2VudFxyXG4gICkge1xyXG4gICAgLy8gUmFuZG9tIHN0YXJ0IHBvc2l0aW9uIHRvIGZpeGVkIHBvc2l0aW9uIG9uIGxpbmVcclxuICAgIGxldCBhZ2VudHM6IElBZ2VudFtdID0gW107XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG47IGkrKykge1xyXG4gICAgICBjb25zdCBhZ2VudCA9IGFnZW50Q29uc3RydWN0b3IoXHJcbiAgICAgICAgeyB4OiB3aWR0aCAqIE1hdGgucmFuZG9tKCksIHk6IGhlaWdodCAqIE1hdGgucmFuZG9tKCkgfSxcclxuICAgICAgICB7IHg6ICgoaSArIDEpIC8gKG4gKyAxKSkgKiB3aWR0aCwgeTogaGVpZ2h0IC8gMiB9LFxyXG4gICAgICAgIDIwXHJcbiAgICAgICk7XHJcbiAgICAgIGFnZW50cy5wdXNoKGFnZW50KTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4geyBhZ2VudHM6IGFnZW50cyB9IGFzIElDb25maWd1cmF0aW9uO1xyXG4gIH1cclxuXHJcbiAgc3RhdGljIENpcmNsZVRvQ2lyY2xlKFxyXG4gICAgbjogbnVtYmVyLFxyXG4gICAgd2lkdGg6IG51bWJlcixcclxuICAgIGhlaWdodDogbnVtYmVyLFxyXG4gICAgYWdlbnRDb25zdHJ1Y3RvcjogKFxyXG4gICAgICBzdGFydFBvc2l0aW9uOiB7IHg6IG51bWJlcjsgeTogbnVtYmVyIH0sXHJcbiAgICAgIGdvYWxQb3NpdGlvbjogeyB4OiBudW1iZXI7IHk6IG51bWJlciB9LFxyXG4gICAgICByYWRpdXM6IG51bWJlclxyXG4gICAgKSA9PiBJQWdlbnRcclxuICApIHtcclxuICAgIC8vIFBvc2l0aW9uIG9uIHJhZGl1cyBvZiBjaXJjbGUgdG8gb3Bwb3NpdGUgcG9pbnRcclxuICAgIGxldCBhZ2VudHM6IElBZ2VudFtdID0gW107XHJcbiAgICBjb25zdCBjZW50cmVYID0gd2lkdGggLyAyO1xyXG4gICAgY29uc3QgY2VudHJlWSA9IGhlaWdodCAvIDI7XHJcbiAgICBjb25zdCByYWRpdXMgPSBoZWlnaHQgLyAyIC0gMjU7XHJcblxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBuOyBpKyspIHtcclxuICAgICAgY29uc3QgYW5nbGUgPSAoMiAqIE1hdGguUEkgKiBpKSAvIG47XHJcbiAgICAgIGNvbnN0IGFnZW50ID0gYWdlbnRDb25zdHJ1Y3RvcihcclxuICAgICAgICB7XHJcbiAgICAgICAgICB4OiBjZW50cmVYICsgcmFkaXVzICogTWF0aC5jb3MoYW5nbGUpLFxyXG4gICAgICAgICAgeTogY2VudHJlWSArIHJhZGl1cyAqIE1hdGguc2luKGFuZ2xlKSxcclxuICAgICAgICB9LFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIHg6IGNlbnRyZVggKyByYWRpdXMgKiBNYXRoLmNvcyhhbmdsZSArIE1hdGguUEkpLFxyXG4gICAgICAgICAgeTogY2VudHJlWSArIHJhZGl1cyAqIE1hdGguc2luKGFuZ2xlICsgTWF0aC5QSSksXHJcbiAgICAgICAgfSxcclxuICAgICAgICAyMFxyXG4gICAgICApO1xyXG4gICAgICBhZ2VudHMucHVzaChhZ2VudCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHsgYWdlbnRzOiBhZ2VudHMgfSBhcyBJQ29uZmlndXJhdGlvbjtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgU2ltdWxhdGlvbiB9IGZyb20gXCIuL1NpbXVsYXRpb25cIjtcclxuaW1wb3J0IHsgUmVuZGVyZXIyRCB9IGZyb20gXCIuL1JlbmRlcmVyMkRcIjtcclxuaW1wb3J0IHsgQmFzaWNBZ2VudCB9IGZyb20gXCIuL0Jhc2ljQWdlbnRcIjtcclxuaW1wb3J0IHsgQ29uZmlndXJhdGlvbnMsIElDb25maWd1cmF0aW9uIH0gZnJvbSBcIi4vQ29uZmlndXJhdGlvbnNcIjtcclxuXHJcbmNvbnN0IGNvbmZpZ1NlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY29uZmlnXCIpIGFzIEhUTUxTZWxlY3RFbGVtZW50O1xyXG5jb25zdCBhZ2VudFR5cGVTZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcclxuICBcImFnZW50VHlwZVwiXHJcbikgYXMgSFRNTFNlbGVjdEVsZW1lbnQ7XHJcbmNvbnN0IG51bWJlck9mQWdlbnRzSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcclxuICBcIm51bWJlck9mQWdlbnRzXCJcclxuKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xyXG5cclxuY29uc3QgY2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjYW52YXNcIikgYXMgSFRNTENhbnZhc0VsZW1lbnQ7XHJcbmNvbnN0IGZyYW1lcmF0ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZnJhbWVyYXRlXCIpIGFzIEhUTUxQYXJhZ3JhcGhFbGVtZW50O1xyXG5jb25zdCBwbGF5QnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwbGF5QnV0dG9uXCIpIGFzIEhUTUxCdXR0b25FbGVtZW50O1xyXG5jb25zdCBzdGVwQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzdGVwQnV0dG9uXCIpIGFzIEhUTUxCdXR0b25FbGVtZW50O1xyXG5cclxuY29uc3QgcmVuZGVyZXIgPSBuZXcgUmVuZGVyZXIyRChjYW52YXMpO1xyXG5jb25zdCBzaW11bGF0aW9uID0gbmV3IFNpbXVsYXRpb24ocmVuZGVyZXIpO1xyXG52YXIgcGxheSA9IGZhbHNlO1xyXG5cclxuLy8gaW5pdGlhbGlzZSBzaW11bGF0aW9uIGFuZCBiZWdpbiB1cGRhdGUvcmVuZGVyIGxvb3BcclxuZXhwb3J0IGZ1bmN0aW9uIGluaXQoKSB7XHJcbiAgdGhpcy5yZWNvbmZpZ3VyZSgpO1xyXG5cclxuICBsZXQgbGFzdFJlbmRlciA9IDA7XHJcbiAgbGV0IGxhc3RGUFMgPSAwO1xyXG4gIGxldCBmcmFtZXMgPSAwO1xyXG5cclxuICBmdW5jdGlvbiBsb29wKHRpbWVzdGFtcDogbnVtYmVyKSB7XHJcbiAgICBsZXQgZGVsdGFUID0gdGltZXN0YW1wIC0gbGFzdFJlbmRlcjtcclxuICAgIGxhc3RSZW5kZXIgPSB0aW1lc3RhbXA7XHJcblxyXG4gICAgLy8gdXBkYXRlXHJcbiAgICBpZiAocGxheSkge1xyXG4gICAgICBzaW11bGF0aW9uLnVwZGF0ZShkZWx0YVQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIHJlbmRlclxyXG4gICAgc2ltdWxhdGlvbi5kcmF3KCk7XHJcbiAgICBmcmFtZXMrKztcclxuXHJcbiAgICAvLyByZWNhbGN1bGF0ZSBmcmFtZXJhdGUgZXZlcnkgMjUwbXNcclxuICAgIGlmICh0aW1lc3RhbXAgLSBsYXN0RlBTID49IDI1MCkge1xyXG4gICAgICBmcmFtZXJhdGUudGV4dENvbnRlbnQgPSBgRlBTOiAkeyhcclxuICAgICAgICAoMTAwMCAqIGZyYW1lcykgL1xyXG4gICAgICAgICh0aW1lc3RhbXAgLSBsYXN0RlBTKVxyXG4gICAgICApLnRvRml4ZWQoMSl9YDtcclxuXHJcbiAgICAgIGZyYW1lcyA9IDA7XHJcbiAgICAgIGxhc3RGUFMgPSB0aW1lc3RhbXA7XHJcbiAgICB9XHJcblxyXG4gICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZShsb29wKTtcclxuICB9XHJcblxyXG4gIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUobG9vcCk7XHJcbn1cclxuXHJcbi8vIHRvZ2dsZSBwbGF5L3BhdXNlXHJcbmV4cG9ydCBmdW5jdGlvbiBwbGF5UGF1c2UoKSB7XHJcbiAgcGxheSA9ICFwbGF5O1xyXG5cclxuICBpZiAocGxheSkge1xyXG4gICAgcGxheUJ1dHRvbi50ZXh0Q29udGVudCA9IFwiUGF1c2VcIjtcclxuICAgIHN0ZXBCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBwbGF5QnV0dG9uLnRleHRDb250ZW50ID0gXCJQbGF5XCI7XHJcbiAgICBzdGVwQnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgfVxyXG59XHJcblxyXG4vLyBzdGVwIHNpbXVsYXRpb24gYnkgMSBmcmFtZVxyXG5leHBvcnQgZnVuY3Rpb24gc3RlcCgpIHtcclxuICBzaW11bGF0aW9uLnVwZGF0ZSgxMDAwIC8gNjApOyAvLyBBc3N1bWVzIDYwRlBTXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiByZWNvbmZpZ3VyZSgpIHtcclxuICBpZiAocGxheSkge1xyXG4gICAgdGhpcy5wbGF5UGF1c2UoKTtcclxuICB9XHJcblxyXG4gIGNvbnN0IGNvbmZpZyA9IGNvbmZpZ1NlbGVjdC52YWx1ZTtcclxuICBjb25zdCBhZ2VudFR5cGUgPSBhZ2VudFR5cGVTZWxlY3QudmFsdWU7IC8vIFRPRE86IHdpcmUgdGhpcyBpblxyXG4gIGNvbnN0IG4gPSBwYXJzZUludChudW1iZXJPZkFnZW50c0lucHV0LnZhbHVlKSA/PyAwO1xyXG5cclxuICAvLyBTZWxlY3QgYWdlbnQgY29uc3RydWN0b3JcclxuICBsZXQgYWdlbnRDb25zdHJ1Y3RvcjtcclxuICBzd2l0Y2ggKGFnZW50VHlwZSkge1xyXG4gICAgY2FzZSBcIkJhc2ljQWdlbnRcIjpcclxuICAgICAgYWdlbnRDb25zdHJ1Y3RvciA9IChcclxuICAgICAgICBwb3NpdGlvbjogeyB4OiBudW1iZXI7IHk6IG51bWJlciB9LFxyXG4gICAgICAgIGdvYWxQb3NpdGlvbjogeyB4OiBudW1iZXI7IHk6IG51bWJlciB9LFxyXG4gICAgICAgIHJhZGl1czogbnVtYmVyXHJcbiAgICAgICkgPT4gbmV3IEJhc2ljQWdlbnQocG9zaXRpb24sIGdvYWxQb3NpdGlvbiwgcmFkaXVzKTtcclxuICAgICAgYnJlYWs7XHJcbiAgICBkZWZhdWx0OiB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkFnZW50IG5vdCBpbXBsZW1lbnRlZFwiKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIFNlbGVjdCBjb25maWd1cmF0aW9uXHJcbiAgc3dpdGNoIChjb25maWcpIHtcclxuICAgIGNhc2UgXCJSYW5kb21Ub1JhbmRvbVwiOiB7XHJcbiAgICAgIHNpbXVsYXRpb24uaW5pdChcclxuICAgICAgICBDb25maWd1cmF0aW9ucy5SYW5kb21Ub1JhbmRvbShcclxuICAgICAgICAgIG4sXHJcbiAgICAgICAgICBjYW52YXMud2lkdGgsXHJcbiAgICAgICAgICBjYW52YXMuaGVpZ2h0LFxyXG4gICAgICAgICAgYWdlbnRDb25zdHJ1Y3RvclxyXG4gICAgICAgIClcclxuICAgICAgKTtcclxuICAgICAgYnJlYWs7XHJcbiAgICB9XHJcbiAgICBjYXNlIFwiUmFuZG9tVG9MaW5lXCI6IHtcclxuICAgICAgc2ltdWxhdGlvbi5pbml0KFxyXG4gICAgICAgIENvbmZpZ3VyYXRpb25zLlJhbmRvbVRvTGluZShcclxuICAgICAgICAgIG4sXHJcbiAgICAgICAgICBjYW52YXMud2lkdGgsXHJcbiAgICAgICAgICBjYW52YXMuaGVpZ2h0LFxyXG4gICAgICAgICAgYWdlbnRDb25zdHJ1Y3RvclxyXG4gICAgICAgIClcclxuICAgICAgKTtcclxuICAgICAgYnJlYWs7XHJcbiAgICB9XHJcbiAgICBjYXNlIFwiQ2lyY2xlVG9DaXJjbGVcIjoge1xyXG4gICAgICBzaW11bGF0aW9uLmluaXQoXHJcbiAgICAgICAgQ29uZmlndXJhdGlvbnMuQ2lyY2xlVG9DaXJjbGUoXHJcbiAgICAgICAgICBuLFxyXG4gICAgICAgICAgY2FudmFzLndpZHRoLFxyXG4gICAgICAgICAgY2FudmFzLmhlaWdodCxcclxuICAgICAgICAgIGFnZW50Q29uc3RydWN0b3JcclxuICAgICAgICApXHJcbiAgICAgICk7XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgfVxyXG4gICAgZGVmYXVsdDoge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDb25maWd1cmF0aW9uIG5vdCBpbXBsZW1lbnRlZFwiKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuIiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0aWYoX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSkge1xuXHRcdHJldHVybiBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0obW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCIvLyBtb2R1bGUgZXhwb3J0cyBtdXN0IGJlIHJldHVybmVkIGZyb20gcnVudGltZSBzbyBlbnRyeSBpbmxpbmluZyBpcyBkaXNhYmxlZFxuLy8gc3RhcnR1cFxuLy8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG5yZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygyNDApO1xuIiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCkiLCIvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSAoZXhwb3J0cykgPT4ge1xuXHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcblx0fVxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xufTsiXSwic291cmNlUm9vdCI6IiJ9