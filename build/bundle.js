var CrowdSimulator;CrowdSimulator=(()=>{"use strict";var t={668:(t,i,o)=>{o.r(i),o.d(i,{init:()=>x,playPause:()=>m,reconfigure:()=>P,step:()=>w});var n=function(){function t(t,i){this._renderer=t,this._agents=i}return t.prototype.init=function(t){this._agents.addAgents(t.agents)},t.prototype.update=function(t){var i=this;this._agents.forEach((function(o){o.update(t,i._agents.getAll())}))},t.prototype.draw=function(){var t=this;this._renderer.clear(),this._agents.forEach((function(i){t._renderer.drawAgent(i)}))},t}(),e=function(){function t(t){this._context=t.getContext("2d")}return t.prototype.clear=function(){this._context.fillStyle="white",this._context.fillRect(0,0,this._context.canvas.width,this._context.canvas.height)},t.prototype.drawAgent=function(t){var i=t.getPosition(),o=t.getDirection();if(this._context.beginPath(),t.getIsDone()?this._context.strokeStyle="#00FF00":t.getIsStuck()?this._context.strokeStyle="#FF0000":this._context.strokeStyle="#000000",this._context.arc(i.x,i.y,t.Radius,0,2*Math.PI),0!==o.dx||0!==o.dy){var n=Math.sqrt(Math.pow(o.dx,2)+Math.pow(o.dy,2));this._context.moveTo(i.x,i.y),this._context.lineTo(i.x+t.Radius*o.dx/n,i.y+t.Radius*o.dy/n)}this._context.stroke()},t}(),s=function(){function t(t,i,o,n){this.Id=t,this._position=i,this._goalPosition=o,this.Radius=n,this._direction={dx:0,dy:0},this._isDone=!1}return t.prototype.getPosition=function(){return this._position},t.prototype.getDirection=function(){return this._direction},t.prototype.getIsDone=function(){return this._isDone},t.prototype.getIsStuck=function(){return!1},t.prototype.update=function(t,i){if(!this._isDone){var o={x:this._goalPosition.x-this._position.x,y:this._goalPosition.y-this._position.y},n=Math.sqrt(Math.pow(o.x,2)+Math.pow(o.y,2));n>60*t/1e3?(this._direction.dx=o.x/n,this._direction.dy=o.y/n,this._position.x+=60*t/1e3*this._direction.dx,this._position.y+=60*t/1e3*this._direction.dy):(this._position.x=this._goalPosition.x,this._position.y=this._goalPosition.y,this._isDone=!0)}},t}(),r=function(){function t(t,i,o,n){this.Id=t,this._position=i,this._goalPosition=o,this.Radius=n,this._direction={dx:0,dy:0},this._isDone=!1,this._isStuck=!1}return t.prototype.getPosition=function(){return this._position},t.prototype.getDirection=function(){return this._direction},t.prototype.getIsDone=function(){return this._isDone},t.prototype.getIsStuck=function(){return this._isStuck},t.prototype.update=function(t,i){var o=this;if(!this._isDone){var n={x:this._goalPosition.x-this._position.x,y:this._goalPosition.y-this._position.y},e=Math.sqrt(Math.pow(n.x,2)+Math.pow(n.y,2));if(e>60*t/1e3){this._direction.dx=n.x/e,this._direction.dy=n.y/e;var s=this._position.x+20*this._direction.dx,r=this._position.y+20*this._direction.dy;this._isStuck=!1,i.forEach((function(t){t.Id!=o.Id&&o.collides(t,{x:s,y:r})&&(o._isStuck=!0)})),this._isStuck||(this._position.x+=60*t/1e3*this._direction.dx,this._position.y+=60*t/1e3*this._direction.dy)}else this._position.x=this._goalPosition.x,this._position.y=this._goalPosition.y,this._isDone=!0}},t.prototype.collides=function(t,i){var o=i.x,n=i.y,e=this.Radius,s=t.getPosition().x,r=t.getPosition().y,a=t.Radius;return Math.sqrt(Math.pow(o-s,2)+Math.pow(n-r,2))<e+a},t}(),a=function(){function t(){}return t.RandomToRandom=function(t,i,o,n){for(var e=[],s=0;s<t;s++){var r=n(s,{x:i*Math.random(),y:o*Math.random()},{x:i*Math.random(),y:o*Math.random()},20);e.push(r)}return{agents:e}},t.RandomToLine=function(t,i,o,n){for(var e=[],s=0;s<t;s++){var r=n(s,{x:i*Math.random(),y:o*Math.random()},{x:(s+1)/(t+1)*i,y:o/2},20);e.push(r)}return{agents:e}},t.CircleToCircle=function(t,i,o,n){for(var e=[],s=i/2,r=o/2,a=o/2-25,h=0;h<t;h++){var u=2*Math.PI*h/t,c=n(h,{x:s+a*Math.cos(u),y:r+a*Math.sin(u)},{x:s+a*Math.cos(u+Math.PI),y:r+a*Math.sin(u+Math.PI)},20);e.push(c)}return{agents:e}},t}(),h=function(){function t(){this._agents=[]}return t.prototype.addAgent=function(t){this._agents.push(t)},t.prototype.addAgents=function(t){this._agents=this._agents.concat(t)},t.prototype.getAll=function(){return this._agents},t.prototype.getNeighboursInRangeRectilinear=function(t,i){return this._agents.filter((function(o){return o.Id!==t.Id&&Math.abs(t.getPosition().x-o.getPosition().x)<=i&&Math.abs(t.getPosition().y-o.getPosition().y)<=i}))},t.prototype.getNeighboursInRangeEuclidean=function(t,i){return this._agents.filter((function(o){return o.Id!==t.Id&&Math.pow(t.getPosition().x-o.getPosition().x,2)+Math.pow(t.getPosition().y-o.getPosition().y,2)<=Math.pow(i,2)}))},t.prototype.forEach=function(t){this._agents.forEach((function(i){return t(i)}))},t}(),u=document.getElementById("config"),c=document.getElementById("agentType"),d=document.getElementById("numberOfAgents"),p=document.getElementById("canvas"),y=document.getElementById("framerate"),g=document.getElementById("playButton"),_=document.getElementById("stepButton"),f=new n(new e(p),new h),l=!1;function x(){this.reconfigure();var t=0,i=0,o=0;window.requestAnimationFrame((function n(e){var s=e-t;t=e,l&&f.update(s),f.draw(),o++,e-i>=250&&(y.textContent="FPS: "+(1e3*o/(e-i)).toFixed(1),o=0,i=e),window.requestAnimationFrame(n)}))}function m(){(l=!l)?(g.textContent="Pause",_.disabled=!0):(g.textContent="Play",_.disabled=!1)}function w(){f.update(1e3/60)}function P(){var t;l&&this.playPause();var i,o=u.value,n=c.value,e=null!==(t=parseInt(d.value))&&void 0!==t?t:0;switch(n){case"BasicAgent":i=function(t,i,o,n){return new s(t,i,o,n)};break;case"StopAgent":i=function(t,i,o,n){return new r(t,i,o,n)};break;default:throw new Error("Agent not implemented")}switch(o){case"RandomToRandom":f.init(a.RandomToRandom(e,p.width,p.height,i));break;case"RandomToLine":f.init(a.RandomToLine(e,p.width,p.height,i));break;case"CircleToCircle":f.init(a.CircleToCircle(e,p.width,p.height,i));break;default:throw new Error("Configuration not implemented")}}}},i={};function o(n){if(i[n])return i[n].exports;var e=i[n]={exports:{}};return t[n](e,e.exports,o),e.exports}return o.d=(t,i)=>{for(var n in i)o.o(i,n)&&!o.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:i[n]})},o.o=(t,i)=>Object.prototype.hasOwnProperty.call(t,i),o.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o(668)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9Dcm93ZFNpbXVsYXRvci8uL3NyYy9TaW11bGF0aW9uLnRzIiwid2VicGFjazovL0Nyb3dkU2ltdWxhdG9yLy4vc3JjL1JlbmRlcmVyMkQudHMiLCJ3ZWJwYWNrOi8vQ3Jvd2RTaW11bGF0b3IvLi9zcmMvQmFzaWNBZ2VudC50cyIsIndlYnBhY2s6Ly9Dcm93ZFNpbXVsYXRvci8uL3NyYy9TdG9wQWdlbnQudHMiLCJ3ZWJwYWNrOi8vQ3Jvd2RTaW11bGF0b3IvLi9zcmMvQ29uZmlndXJhdGlvbnMudHMiLCJ3ZWJwYWNrOi8vQ3Jvd2RTaW11bGF0b3IvLi9zcmMvQWdlbnRMaXN0LnRzIiwid2VicGFjazovL0Nyb3dkU2ltdWxhdG9yLy4vc3JjL21haW4udHMiLCJ3ZWJwYWNrOi8vQ3Jvd2RTaW11bGF0b3Ivd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vQ3Jvd2RTaW11bGF0b3Ivd2VicGFjay9zdGFydHVwIiwid2VicGFjazovL0Nyb3dkU2ltdWxhdG9yL3dlYnBhY2svcnVudGltZS9kZWZpbmUgcHJvcGVydHkgZ2V0dGVycyIsIndlYnBhY2s6Ly9Dcm93ZFNpbXVsYXRvci93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovL0Nyb3dkU2ltdWxhdG9yL3dlYnBhY2svcnVudGltZS9tYWtlIG5hbWVzcGFjZSBvYmplY3QiXSwibmFtZXMiOlsicmVuZGVyZXIiLCJhZ2VudHMiLCJ0aGlzIiwiX3JlbmRlcmVyIiwiX2FnZW50cyIsImluaXQiLCJjb25maWciLCJhZGRBZ2VudHMiLCJ1cGRhdGUiLCJkZWx0YVQiLCJmb3JFYWNoIiwiYWdlbnQiLCJnZXRBbGwiLCJkcmF3IiwiY2xlYXIiLCJkcmF3QWdlbnQiLCJjYW52YXMiLCJfY29udGV4dCIsImdldENvbnRleHQiLCJmaWxsU3R5bGUiLCJmaWxsUmVjdCIsIndpZHRoIiwiaGVpZ2h0IiwicG9zaXRpb24iLCJnZXRQb3NpdGlvbiIsImRpcmVjdGlvbiIsImdldERpcmVjdGlvbiIsImJlZ2luUGF0aCIsImdldElzRG9uZSIsInN0cm9rZVN0eWxlIiwiZ2V0SXNTdHVjayIsImFyYyIsIngiLCJ5IiwiUmFkaXVzIiwiTWF0aCIsIlBJIiwiZHgiLCJkeSIsIm1hZ25pdHVkZSIsInNxcnQiLCJtb3ZlVG8iLCJsaW5lVG8iLCJzdHJva2UiLCJpZCIsInN0YXJ0UG9zaXRpb24iLCJnb2FsUG9zaXRpb24iLCJyYWRpdXMiLCJJZCIsIl9wb3NpdGlvbiIsIl9nb2FsUG9zaXRpb24iLCJfZGlyZWN0aW9uIiwiX2lzRG9uZSIsImdvYWxEaXJlY3Rpb24iLCJnb2FsRGlzdGFuY2UiLCJfaXNTdHVjayIsImNvbGxpZGVzIiwiYTF4IiwiYTF5IiwiYTFyIiwiYTJ4IiwiYTJ5IiwiYTJyIiwiUmFuZG9tVG9SYW5kb20iLCJuIiwiYWdlbnRDb25zdHJ1Y3RvciIsImkiLCJyYW5kb20iLCJwdXNoIiwiUmFuZG9tVG9MaW5lIiwiQ2lyY2xlVG9DaXJjbGUiLCJjZW50cmVYIiwiY2VudHJlWSIsImFuZ2xlIiwiY29zIiwic2luIiwiYWRkQWdlbnQiLCJjb25jYXQiLCJnZXROZWlnaGJvdXJzSW5SYW5nZVJlY3RpbGluZWFyIiwicmFuZ2UiLCJmaWx0ZXIiLCJvdGhlciIsImFicyIsImdldE5laWdoYm91cnNJblJhbmdlRXVjbGlkZWFuIiwiZnVuIiwiY29uZmlnU2VsZWN0IiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImFnZW50VHlwZVNlbGVjdCIsIm51bWJlck9mQWdlbnRzSW5wdXQiLCJmcmFtZXJhdGUiLCJwbGF5QnV0dG9uIiwic3RlcEJ1dHRvbiIsInNpbXVsYXRpb24iLCJTaW11bGF0aW9uIiwiUmVuZGVyZXIyRCIsIkFnZW50TGlzdCIsInBsYXkiLCJyZWNvbmZpZ3VyZSIsImxhc3RSZW5kZXIiLCJsYXN0RlBTIiwiZnJhbWVzIiwid2luZG93IiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwibG9vcCIsInRpbWVzdGFtcCIsInRleHRDb250ZW50IiwidG9GaXhlZCIsInBsYXlQYXVzZSIsImRpc2FibGVkIiwic3RlcCIsInZhbHVlIiwiYWdlbnRUeXBlIiwicGFyc2VJbnQiLCJCYXNpY0FnZW50IiwiU3RvcEFnZW50IiwiRXJyb3IiLCJDb25maWd1cmF0aW9ucyIsIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJfX3dlYnBhY2tfbW9kdWxlc19fIiwiZCIsImRlZmluaXRpb24iLCJrZXkiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0Iiwib2JqIiwicHJvcCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyJdLCJtYXBwaW5ncyI6ImtKQUlBLGlCQUlFLFdBQVlBLEVBQXFCQyxHQUMvQkMsS0FBS0MsVUFBWUgsRUFDakJFLEtBQUtFLFFBQVVILEVBbUJuQixPQWhCRSxZQUFBSSxLQUFBLFNBQUtDLEdBQ0hKLEtBQUtFLFFBQVFHLFVBQVVELEVBQU9MLFNBR2hDLFlBQUFPLE9BQUEsU0FBT0MsR0FBUCxXQUNFUCxLQUFLRSxRQUFRTSxTQUFRLFNBQUNDLEdBQ3BCQSxFQUFNSCxPQUFPQyxFQUFRLEVBQUtMLFFBQVFRLGNBSXRDLFlBQUFDLEtBQUEsc0JBQ0VYLEtBQUtDLFVBQVVXLFFBQ2ZaLEtBQUtFLFFBQVFNLFNBQVEsU0FBQ0MsR0FDcEIsRUFBS1IsVUFBVVksVUFBVUosT0FHL0IsRUF6QkEsR0NEQSxhQUdFLFdBQVlLLEdBQ1ZkLEtBQUtlLFNBQVdELEVBQU9FLFdBQVcsTUEwQ3RDLE9BdkNFLFlBQUFKLE1BQUEsV0FDRVosS0FBS2UsU0FBU0UsVUFBWSxRQUMxQmpCLEtBQUtlLFNBQVNHLFNBQ1osRUFDQSxFQUNBbEIsS0FBS2UsU0FBU0QsT0FBT0ssTUFDckJuQixLQUFLZSxTQUFTRCxPQUFPTSxTQUl6QixZQUFBUCxVQUFBLFNBQVVKLEdBQ1Is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QUM1RUUsT0FBT0MsZUFBZVIsRUFBU0ssRUFBSyxDQUFFSSxZQUFZLEVBQU1DLElBQUtOLEVBQVdDLE1DSjNFUCxFQUFvQlEsRUFBSSxDQUFDSyxFQUFLQyxJQUFTTCxPQUFPTSxVQUFVQyxlQUFlQyxLQUFLSixFQUFLQyxHQ0NqRmQsRUFBb0JrQixFQUFLaEIsSUFDSCxvQkFBWGlCLFFBQTBCQSxPQUFPQyxhQUMxQ1gsT0FBT0MsZUFBZVIsRUFBU2lCLE9BQU9DLFlBQWEsQ0FBRTVCLE1BQU8sV0FFN0RpQixPQUFPQyxlQUFlUixFQUFTLGFBQWMsQ0FBRVYsT0FBTyxLSEZoRFEsRUFBb0IsTSIsImZpbGUiOiJidW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJQWdlbnRDb2xsZWN0aW9uIH0gZnJvbSBcIi4vSUFnZW50Q29sbGVjdGlvblwiO1xyXG5pbXBvcnQgeyBJUmVuZGVyZXIgfSBmcm9tIFwiLi9JUmVuZGVyZXJcIjtcclxuaW1wb3J0IHsgSUNvbmZpZ3VyYXRpb24gfSBmcm9tIFwiLi9Db25maWd1cmF0aW9uc1wiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFNpbXVsYXRpb24ge1xyXG4gIF9yZW5kZXJlcjogSVJlbmRlcmVyO1xyXG4gIF9hZ2VudHM6IElBZ2VudENvbGxlY3Rpb247XHJcblxyXG4gIGNvbnN0cnVjdG9yKHJlbmRlcmVyOiBJUmVuZGVyZXIsIGFnZW50czogSUFnZW50Q29sbGVjdGlvbikge1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2FnZW50cyA9IGFnZW50cztcclxuICB9XHJcblxyXG4gIGluaXQoY29uZmlnOiBJQ29uZmlndXJhdGlvbikge1xyXG4gICAgdGhpcy5fYWdlbnRzLmFkZEFnZW50cyhjb25maWcuYWdlbnRzKTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZShkZWx0YVQ6IG51bWJlcikge1xyXG4gICAgdGhpcy5fYWdlbnRzLmZvckVhY2goKGFnZW50KSA9PiB7XHJcbiAgICAgIGFnZW50LnVwZGF0ZShkZWx0YVQsIHRoaXMuX2FnZW50cy5nZXRBbGwoKSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGRyYXcoKSB7XHJcbiAgICB0aGlzLl9yZW5kZXJlci5jbGVhcigpO1xyXG4gICAgdGhpcy5fYWdlbnRzLmZvckVhY2goKGFnZW50KSA9PiB7XHJcbiAgICAgIHRoaXMuX3JlbmRlcmVyLmRyYXdBZ2VudChhZ2VudCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgSUFnZW50IH0gZnJvbSBcIi4vSUFnZW50XCI7XHJcbmltcG9ydCB7IElSZW5kZXJlciB9IGZyb20gXCIuL0lSZW5kZXJlclwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFJlbmRlcmVyMkQgaW1wbGVtZW50cyBJUmVuZGVyZXIge1xyXG4gIF9jb250ZXh0OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQ7XHJcblxyXG4gIGNvbnN0cnVjdG9yKGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnQpIHtcclxuICAgIHRoaXMuX2NvbnRleHQgPSBjYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpO1xyXG4gIH1cclxuXHJcbiAgY2xlYXIoKTogdm9pZCB7XHJcbiAgICB0aGlzLl9jb250ZXh0LmZpbGxTdHlsZSA9IFwid2hpdGVcIjtcclxuICAgIHRoaXMuX2NvbnRleHQuZmlsbFJlY3QoXHJcbiAgICAgIDAsXHJcbiAgICAgIDAsXHJcbiAgICAgIHRoaXMuX2NvbnRleHQuY2FudmFzLndpZHRoLFxyXG4gICAgICB0aGlzLl9jb250ZXh0LmNhbnZhcy5oZWlnaHRcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBkcmF3QWdlbnQoYWdlbnQ6IElBZ2VudCkge1xyXG4gICAgbGV0IHBvc2l0aW9uID0gYWdlbnQuZ2V0UG9zaXRpb24oKTtcclxuICAgIGxldCBkaXJlY3Rpb24gPSBhZ2VudC5nZXREaXJlY3Rpb24oKTtcclxuXHJcbiAgICB0aGlzLl9jb250ZXh0LmJlZ2luUGF0aCgpO1xyXG5cclxuICAgIC8vIGRyYXcgYWdlbnRcclxuICAgIGlmIChhZ2VudC5nZXRJc0RvbmUoKSkge1xyXG4gICAgICB0aGlzLl9jb250ZXh0LnN0cm9rZVN0eWxlID0gXCIjMDBGRjAwXCI7XHJcbiAgICB9IGVsc2UgaWYgKGFnZW50LmdldElzU3R1Y2soKSkge1xyXG4gICAgICB0aGlzLl9jb250ZXh0LnN0cm9rZVN0eWxlID0gXCIjRkYwMDAwXCI7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9jb250ZXh0LnN0cm9rZVN0eWxlID0gXCIjMDAwMDAwXCI7XHJcbiAgICB9XHJcbiAgICB0aGlzLl9jb250ZXh0LmFyYyhwb3NpdGlvbi54LCBwb3NpdGlvbi55LCBhZ2VudC5SYWRpdXMsIDAsIDIgKiBNYXRoLlBJKTtcclxuXHJcbiAgICAvLyBkcmF3IGRpcmVjdGlvblxyXG4gICAgaWYgKGRpcmVjdGlvbi5keCAhPT0gMCB8fCBkaXJlY3Rpb24uZHkgIT09IDApIHtcclxuICAgICAgbGV0IG1hZ25pdHVkZSA9IE1hdGguc3FydChkaXJlY3Rpb24uZHggKiogMiArIGRpcmVjdGlvbi5keSAqKiAyKTtcclxuXHJcbiAgICAgIHRoaXMuX2NvbnRleHQubW92ZVRvKHBvc2l0aW9uLngsIHBvc2l0aW9uLnkpO1xyXG4gICAgICB0aGlzLl9jb250ZXh0LmxpbmVUbyhcclxuICAgICAgICBwb3NpdGlvbi54ICsgKGFnZW50LlJhZGl1cyAqIGRpcmVjdGlvbi5keCkgLyBtYWduaXR1ZGUsXHJcbiAgICAgICAgcG9zaXRpb24ueSArIChhZ2VudC5SYWRpdXMgKiBkaXJlY3Rpb24uZHkpIC8gbWFnbml0dWRlXHJcbiAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5fY29udGV4dC5zdHJva2UoKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgSUFnZW50IH0gZnJvbSBcIi4vSUFnZW50XCI7XHJcblxyXG5leHBvcnQgY2xhc3MgQmFzaWNBZ2VudCBpbXBsZW1lbnRzIElBZ2VudCB7XHJcbiAgcHVibGljIHJlYWRvbmx5IElkOiBudW1iZXI7XHJcbiAgcHVibGljIHJlYWRvbmx5IFJhZGl1czogbnVtYmVyO1xyXG5cclxuICBwcml2YXRlIF9wb3NpdGlvbjogeyB4OiBudW1iZXI7IHk6IG51bWJlciB9O1xyXG4gIHByaXZhdGUgX2dvYWxQb3NpdGlvbjogeyB4OiBudW1iZXI7IHk6IG51bWJlciB9O1xyXG4gIHByaXZhdGUgX2RpcmVjdGlvbjogeyBkeDogbnVtYmVyOyBkeTogbnVtYmVyIH07XHJcbiAgcHJpdmF0ZSBfaXNEb25lOiBib29sZWFuO1xyXG5cclxuICBjb25zdHJ1Y3RvcihcclxuICAgIGlkOiBudW1iZXIsXHJcbiAgICBzdGFydFBvc2l0aW9uOiB7IHg6IG51bWJlcjsgeTogbnVtYmVyIH0sXHJcbiAgICBnb2FsUG9zaXRpb246IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfSxcclxuICAgIHJhZGl1czogbnVtYmVyXHJcbiAgKSB7XHJcbiAgICB0aGlzLklkID0gaWQ7XHJcbiAgICB0aGlzLl9wb3NpdGlvbiA9IHN0YXJ0UG9zaXRpb247XHJcbiAgICB0aGlzLl9nb2FsUG9zaXRpb24gPSBnb2FsUG9zaXRpb247XHJcbiAgICB0aGlzLlJhZGl1cyA9IHJhZGl1cztcclxuXHJcbiAgICB0aGlzLl9kaXJlY3Rpb24gPSB7IGR4OiAwLCBkeTogMCB9O1xyXG4gICAgdGhpcy5faXNEb25lID0gZmFsc2U7XHJcbiAgfVxyXG5cclxuICBnZXRQb3NpdGlvbigpOiB7IHg6IG51bWJlcjsgeTogbnVtYmVyIH0ge1xyXG4gICAgcmV0dXJuIHRoaXMuX3Bvc2l0aW9uO1xyXG4gIH1cclxuXHJcbiAgZ2V0RGlyZWN0aW9uKCk6IHsgZHg6IG51bWJlcjsgZHk6IG51bWJlciB9IHtcclxuICAgIHJldHVybiB0aGlzLl9kaXJlY3Rpb247XHJcbiAgfVxyXG5cclxuICBnZXRJc0RvbmUoKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gdGhpcy5faXNEb25lO1xyXG4gIH1cclxuXHJcbiAgZ2V0SXNTdHVjaygpOiBib29sZWFuIHtcclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZShkZWx0YVQ6IG51bWJlciwgX2FnZW50czogSUFnZW50W10pOiB2b2lkIHtcclxuICAgIGlmICh0aGlzLl9pc0RvbmUpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIGxldCBnb2FsRGlyZWN0aW9uID0ge1xyXG4gICAgICB4OiB0aGlzLl9nb2FsUG9zaXRpb24ueCAtIHRoaXMuX3Bvc2l0aW9uLngsXHJcbiAgICAgIHk6IHRoaXMuX2dvYWxQb3NpdGlvbi55IC0gdGhpcy5fcG9zaXRpb24ueSxcclxuICAgIH07XHJcbiAgICBsZXQgZ29hbERpc3RhbmNlID0gTWF0aC5zcXJ0KGdvYWxEaXJlY3Rpb24ueCAqKiAyICsgZ29hbERpcmVjdGlvbi55ICoqIDIpO1xyXG5cclxuICAgIGlmIChnb2FsRGlzdGFuY2UgPiAoZGVsdGFUICogNjApIC8gMTAwMCkge1xyXG4gICAgICB0aGlzLl9kaXJlY3Rpb24uZHggPSBnb2FsRGlyZWN0aW9uLnggLyBnb2FsRGlzdGFuY2U7XHJcbiAgICAgIHRoaXMuX2RpcmVjdGlvbi5keSA9IGdvYWxEaXJlY3Rpb24ueSAvIGdvYWxEaXN0YW5jZTtcclxuICAgICAgdGhpcy5fcG9zaXRpb24ueCArPSAoKGRlbHRhVCAqIDYwKSAvIDEwMDApICogdGhpcy5fZGlyZWN0aW9uLmR4O1xyXG4gICAgICB0aGlzLl9wb3NpdGlvbi55ICs9ICgoZGVsdGFUICogNjApIC8gMTAwMCkgKiB0aGlzLl9kaXJlY3Rpb24uZHk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9wb3NpdGlvbi54ID0gdGhpcy5fZ29hbFBvc2l0aW9uLng7XHJcbiAgICAgIHRoaXMuX3Bvc2l0aW9uLnkgPSB0aGlzLl9nb2FsUG9zaXRpb24ueTtcclxuICAgICAgdGhpcy5faXNEb25lID0gdHJ1ZTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgSUFnZW50IH0gZnJvbSBcIi4vSUFnZW50XCI7XHJcblxyXG5leHBvcnQgY2xhc3MgU3RvcEFnZW50IGltcGxlbWVudHMgSUFnZW50IHtcclxuICBwdWJsaWMgcmVhZG9ubHkgSWQ6IG51bWJlcjtcclxuICBwdWJsaWMgcmVhZG9ubHkgUmFkaXVzOiBudW1iZXI7XHJcblxyXG4gIHByaXZhdGUgX3Bvc2l0aW9uOiB7IHg6IG51bWJlcjsgeTogbnVtYmVyIH07XHJcbiAgcHJpdmF0ZSBfZ29hbFBvc2l0aW9uOiB7IHg6IG51bWJlcjsgeTogbnVtYmVyIH07XHJcbiAgcHJpdmF0ZSBfZGlyZWN0aW9uOiB7IGR4OiBudW1iZXI7IGR5OiBudW1iZXIgfTtcclxuICBwcml2YXRlIF9pc0RvbmU6IGJvb2xlYW47XHJcbiAgcHJpdmF0ZSBfaXNTdHVjazogYm9vbGVhbjtcclxuXHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBpZDogbnVtYmVyLFxyXG4gICAgc3RhcnRQb3NpdGlvbjogeyB4OiBudW1iZXI7IHk6IG51bWJlciB9LFxyXG4gICAgZ29hbFBvc2l0aW9uOiB7IHg6IG51bWJlcjsgeTogbnVtYmVyIH0sXHJcbiAgICByYWRpdXM6IG51bWJlclxyXG4gICkge1xyXG4gICAgdGhpcy5JZCA9IGlkO1xyXG4gICAgdGhpcy5fcG9zaXRpb24gPSBzdGFydFBvc2l0aW9uO1xyXG4gICAgdGhpcy5fZ29hbFBvc2l0aW9uID0gZ29hbFBvc2l0aW9uO1xyXG4gICAgdGhpcy5SYWRpdXMgPSByYWRpdXM7XHJcblxyXG4gICAgdGhpcy5fZGlyZWN0aW9uID0geyBkeDogMCwgZHk6IDAgfTtcclxuICAgIHRoaXMuX2lzRG9uZSA9IGZhbHNlO1xyXG4gICAgdGhpcy5faXNTdHVjayA9IGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgZ2V0UG9zaXRpb24oKTogeyB4OiBudW1iZXI7IHk6IG51bWJlciB9IHtcclxuICAgIHJldHVybiB0aGlzLl9wb3NpdGlvbjtcclxuICB9XHJcblxyXG4gIGdldERpcmVjdGlvbigpOiB7IGR4OiBudW1iZXI7IGR5OiBudW1iZXIgfSB7XHJcbiAgICByZXR1cm4gdGhpcy5fZGlyZWN0aW9uO1xyXG4gIH1cclxuXHJcbiAgZ2V0SXNEb25lKCk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIHRoaXMuX2lzRG9uZTtcclxuICB9XHJcblxyXG4gIGdldElzU3R1Y2soKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gdGhpcy5faXNTdHVjaztcclxuICB9XHJcblxyXG4gIHVwZGF0ZShkZWx0YVQ6IG51bWJlciwgYWdlbnRzOiBJQWdlbnRbXSk6IHZvaWQge1xyXG4gICAgaWYgKHRoaXMuX2lzRG9uZSkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgbGV0IGdvYWxEaXJlY3Rpb24gPSB7XHJcbiAgICAgIHg6IHRoaXMuX2dvYWxQb3NpdGlvbi54IC0gdGhpcy5fcG9zaXRpb24ueCxcclxuICAgICAgeTogdGhpcy5fZ29hbFBvc2l0aW9uLnkgLSB0aGlzLl9wb3NpdGlvbi55LFxyXG4gICAgfTtcclxuICAgIGxldCBnb2FsRGlzdGFuY2UgPSBNYXRoLnNxcnQoZ29hbERpcmVjdGlvbi54ICoqIDIgKyBnb2FsRGlyZWN0aW9uLnkgKiogMik7XHJcblxyXG4gICAgaWYgKGdvYWxEaXN0YW5jZSA+IChkZWx0YVQgKiA2MCkgLyAxMDAwKSB7XHJcbiAgICAgIHRoaXMuX2RpcmVjdGlvbi5keCA9IGdvYWxEaXJlY3Rpb24ueCAvIGdvYWxEaXN0YW5jZTtcclxuICAgICAgdGhpcy5fZGlyZWN0aW9uLmR5ID0gZ29hbERpcmVjdGlvbi55IC8gZ29hbERpc3RhbmNlO1xyXG4gICAgICBsZXQgaGVhZGluZ1ggPSB0aGlzLl9wb3NpdGlvbi54ICsgMjAgKiB0aGlzLl9kaXJlY3Rpb24uZHg7XHJcbiAgICAgIGxldCBoZWFkaW5nWSA9IHRoaXMuX3Bvc2l0aW9uLnkgKyAyMCAqIHRoaXMuX2RpcmVjdGlvbi5keTtcclxuXHJcbiAgICAgIHRoaXMuX2lzU3R1Y2sgPSBmYWxzZTtcclxuICAgICAgYWdlbnRzLmZvckVhY2goKGFnZW50KSA9PiB7XHJcbiAgICAgICAgaWYgKFxyXG4gICAgICAgICAgYWdlbnQuSWQgIT0gdGhpcy5JZCAmJlxyXG4gICAgICAgICAgdGhpcy5jb2xsaWRlcyhhZ2VudCwgeyB4OiBoZWFkaW5nWCwgeTogaGVhZGluZ1kgfSlcclxuICAgICAgICApIHtcclxuICAgICAgICAgIHRoaXMuX2lzU3R1Y2sgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcblxyXG4gICAgICBpZiAoIXRoaXMuX2lzU3R1Y2spIHtcclxuICAgICAgICB0aGlzLl9wb3NpdGlvbi54ICs9ICgoZGVsdGFUICogNjApIC8gMTAwMCkgKiB0aGlzLl9kaXJlY3Rpb24uZHg7XHJcbiAgICAgICAgdGhpcy5fcG9zaXRpb24ueSArPSAoKGRlbHRhVCAqIDYwKSAvIDEwMDApICogdGhpcy5fZGlyZWN0aW9uLmR5O1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9wb3NpdGlvbi54ID0gdGhpcy5fZ29hbFBvc2l0aW9uLng7XHJcbiAgICAgIHRoaXMuX3Bvc2l0aW9uLnkgPSB0aGlzLl9nb2FsUG9zaXRpb24ueTtcclxuICAgICAgdGhpcy5faXNEb25lID0gdHJ1ZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGNvbGxpZGVzKGFnZW50OiBJQWdlbnQsIHBvc2l0aW9uOiB7IHg6IG51bWJlcjsgeTogbnVtYmVyIH0pOiBib29sZWFuIHtcclxuICAgIGxldCBhMXggPSBwb3NpdGlvbi54O1xyXG4gICAgbGV0IGExeSA9IHBvc2l0aW9uLnk7XHJcbiAgICBsZXQgYTFyID0gdGhpcy5SYWRpdXM7XHJcbiAgICBsZXQgYTJ4ID0gYWdlbnQuZ2V0UG9zaXRpb24oKS54O1xyXG4gICAgbGV0IGEyeSA9IGFnZW50LmdldFBvc2l0aW9uKCkueTtcclxuICAgIGxldCBhMnIgPSBhZ2VudC5SYWRpdXM7XHJcblxyXG4gICAgcmV0dXJuIE1hdGguc3FydCgoYTF4IC0gYTJ4KSAqKiAyICsgKGExeSAtIGEyeSkgKiogMikgPCBhMXIgKyBhMnI7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7IElBZ2VudCB9IGZyb20gXCIuL0lBZ2VudFwiO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBJQ29uZmlndXJhdGlvbiB7XHJcbiAgYWdlbnRzOiBJQWdlbnRbXTtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIENvbmZpZ3VyYXRpb25zIHtcclxuICBzdGF0aWMgUmFuZG9tVG9SYW5kb20oXHJcbiAgICBuOiBudW1iZXIsXHJcbiAgICB3aWR0aDogbnVtYmVyLFxyXG4gICAgaGVpZ2h0OiBudW1iZXIsXHJcbiAgICBhZ2VudENvbnN0cnVjdG9yOiAoXHJcbiAgICAgIGlkOiBudW1iZXIsXHJcbiAgICAgIHN0YXJ0UG9zaXRpb246IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfSxcclxuICAgICAgZ29hbFBvc2l0aW9uOiB7IHg6IG51bWJlcjsgeTogbnVtYmVyIH0sXHJcbiAgICAgIHJhZGl1czogbnVtYmVyXHJcbiAgICApID0+IElBZ2VudFxyXG4gICkge1xyXG4gICAgLy8gUmFuZG9tIHN0YXJ0IHBvc2l0aW9uIHRvIHJhbmRvbSBnb2FsIHBvc2l0aW9uXHJcbiAgICBsZXQgYWdlbnRzOiBJQWdlbnRbXSA9IFtdO1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBuOyBpKyspIHtcclxuICAgICAgY29uc3QgYWdlbnQgPSBhZ2VudENvbnN0cnVjdG9yKFxyXG4gICAgICAgIGksXHJcbiAgICAgICAgeyB4OiB3aWR0aCAqIE1hdGgucmFuZG9tKCksIHk6IGhlaWdodCAqIE1hdGgucmFuZG9tKCkgfSxcclxuICAgICAgICB7IHg6IHdpZHRoICogTWF0aC5yYW5kb20oKSwgeTogaGVpZ2h0ICogTWF0aC5yYW5kb20oKSB9LFxyXG4gICAgICAgIDIwXHJcbiAgICAgICk7XHJcbiAgICAgIGFnZW50cy5wdXNoKGFnZW50KTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4geyBhZ2VudHM6IGFnZW50cyB9IGFzIElDb25maWd1cmF0aW9uO1xyXG4gIH1cclxuXHJcbiAgc3RhdGljIFJhbmRvbVRvTGluZShcclxuICAgIG46IG51bWJlcixcclxuICAgIHdpZHRoOiBudW1iZXIsXHJcbiAgICBoZWlnaHQ6IG51bWJlcixcclxuICAgIGFnZW50Q29uc3RydWN0b3I6IChcclxuICAgICAgaWQ6IG51bWJlcixcclxuICAgICAgc3RhcnRQb3NpdGlvbjogeyB4OiBudW1iZXI7IHk6IG51bWJlciB9LFxyXG4gICAgICBnb2FsUG9zaXRpb246IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfSxcclxuICAgICAgcmFkaXVzOiBudW1iZXJcclxuICAgICkgPT4gSUFnZW50XHJcbiAgKSB7XHJcbiAgICAvLyBSYW5kb20gc3RhcnQgcG9zaXRpb24gdG8gZml4ZWQgcG9zaXRpb24gb24gbGluZVxyXG4gICAgbGV0IGFnZW50czogSUFnZW50W10gPSBbXTtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbjsgaSsrKSB7XHJcbiAgICAgIGNvbnN0IGFnZW50ID0gYWdlbnRDb25zdHJ1Y3RvcihcclxuICAgICAgICBpLFxyXG4gICAgICAgIHsgeDogd2lkdGggKiBNYXRoLnJhbmRvbSgpLCB5OiBoZWlnaHQgKiBNYXRoLnJhbmRvbSgpIH0sXHJcbiAgICAgICAgeyB4OiAoKGkgKyAxKSAvIChuICsgMSkpICogd2lkdGgsIHk6IGhlaWdodCAvIDIgfSxcclxuICAgICAgICAyMFxyXG4gICAgICApO1xyXG4gICAgICBhZ2VudHMucHVzaChhZ2VudCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHsgYWdlbnRzOiBhZ2VudHMgfSBhcyBJQ29uZmlndXJhdGlvbjtcclxuICB9XHJcblxyXG4gIHN0YXRpYyBDaXJjbGVUb0NpcmNsZShcclxuICAgIG46IG51bWJlcixcclxuICAgIHdpZHRoOiBudW1iZXIsXHJcbiAgICBoZWlnaHQ6IG51bWJlcixcclxuICAgIGFnZW50Q29uc3RydWN0b3I6IChcclxuICAgICAgaWQ6IG51bWJlcixcclxuICAgICAgc3RhcnRQb3NpdGlvbjogeyB4OiBudW1iZXI7IHk6IG51bWJlciB9LFxyXG4gICAgICBnb2FsUG9zaXRpb246IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfSxcclxuICAgICAgcmFkaXVzOiBudW1iZXJcclxuICAgICkgPT4gSUFnZW50XHJcbiAgKSB7XHJcbiAgICAvLyBQb3NpdGlvbiBvbiByYWRpdXMgb2YgY2lyY2xlIHRvIG9wcG9zaXRlIHBvaW50XHJcbiAgICBsZXQgYWdlbnRzOiBJQWdlbnRbXSA9IFtdO1xyXG4gICAgY29uc3QgY2VudHJlWCA9IHdpZHRoIC8gMjtcclxuICAgIGNvbnN0IGNlbnRyZVkgPSBoZWlnaHQgLyAyO1xyXG4gICAgY29uc3QgcmFkaXVzID0gaGVpZ2h0IC8gMiAtIDI1O1xyXG5cclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbjsgaSsrKSB7XHJcbiAgICAgIGNvbnN0IGFuZ2xlID0gKDIgKiBNYXRoLlBJICogaSkgLyBuO1xyXG4gICAgICBjb25zdCBhZ2VudCA9IGFnZW50Q29uc3RydWN0b3IoXHJcbiAgICAgICAgaSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICB4OiBjZW50cmVYICsgcmFkaXVzICogTWF0aC5jb3MoYW5nbGUpLFxyXG4gICAgICAgICAgeTogY2VudHJlWSArIHJhZGl1cyAqIE1hdGguc2luKGFuZ2xlKSxcclxuICAgICAgICB9LFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIHg6IGNlbnRyZVggKyByYWRpdXMgKiBNYXRoLmNvcyhhbmdsZSArIE1hdGguUEkpLFxyXG4gICAgICAgICAgeTogY2VudHJlWSArIHJhZGl1cyAqIE1hdGguc2luKGFuZ2xlICsgTWF0aC5QSSksXHJcbiAgICAgICAgfSxcclxuICAgICAgICAyMFxyXG4gICAgICApO1xyXG4gICAgICBhZ2VudHMucHVzaChhZ2VudCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHsgYWdlbnRzOiBhZ2VudHMgfSBhcyBJQ29uZmlndXJhdGlvbjtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgSUFnZW50Q29sbGVjdGlvbiB9IGZyb20gXCIuL0lBZ2VudENvbGxlY3Rpb25cIjtcclxuaW1wb3J0IHsgSUFnZW50IH0gZnJvbSBcIi4vSUFnZW50XCI7XHJcblxyXG5leHBvcnQgY2xhc3MgQWdlbnRMaXN0IGltcGxlbWVudHMgSUFnZW50Q29sbGVjdGlvbiB7XHJcbiAgcHJpdmF0ZSBfYWdlbnRzOiBJQWdlbnRbXTtcclxuXHJcbiAgY29uc3RydWN0b3IoKSB7XHJcbiAgICB0aGlzLl9hZ2VudHMgPSBbXTtcclxuICB9XHJcblxyXG4gIGFkZEFnZW50KGFnZW50OiBJQWdlbnQpIHtcclxuICAgIHRoaXMuX2FnZW50cy5wdXNoKGFnZW50KTtcclxuICB9XHJcblxyXG4gIGFkZEFnZW50cyhhZ2VudHM6IElBZ2VudFtdKSB7XHJcbiAgICB0aGlzLl9hZ2VudHMgPSB0aGlzLl9hZ2VudHMuY29uY2F0KGFnZW50cyk7XHJcbiAgfVxyXG5cclxuICBnZXRBbGwoKTogSUFnZW50W10ge1xyXG4gICAgcmV0dXJuIHRoaXMuX2FnZW50cztcclxuICB9XHJcblxyXG4gIGdldE5laWdoYm91cnNJblJhbmdlUmVjdGlsaW5lYXIoYWdlbnQ6IElBZ2VudCwgcmFuZ2U6IG51bWJlcik6IElBZ2VudFtdIHtcclxuICAgIHJldHVybiB0aGlzLl9hZ2VudHMuZmlsdGVyKFxyXG4gICAgICAob3RoZXIpID0+XHJcbiAgICAgICAgb3RoZXIuSWQgIT09IGFnZW50LklkICYmXHJcbiAgICAgICAgTWF0aC5hYnMoYWdlbnQuZ2V0UG9zaXRpb24oKS54IC0gb3RoZXIuZ2V0UG9zaXRpb24oKS54KSA8PSByYW5nZSAmJlxyXG4gICAgICAgIE1hdGguYWJzKGFnZW50LmdldFBvc2l0aW9uKCkueSAtIG90aGVyLmdldFBvc2l0aW9uKCkueSkgPD0gcmFuZ2VcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBnZXROZWlnaGJvdXJzSW5SYW5nZUV1Y2xpZGVhbihhZ2VudDogSUFnZW50LCByYW5nZTogbnVtYmVyKTogSUFnZW50W10ge1xyXG4gICAgcmV0dXJuIHRoaXMuX2FnZW50cy5maWx0ZXIoXHJcbiAgICAgIChvdGhlcikgPT5cclxuICAgICAgICBvdGhlci5JZCAhPT0gYWdlbnQuSWQgJiZcclxuICAgICAgICAoYWdlbnQuZ2V0UG9zaXRpb24oKS54IC0gb3RoZXIuZ2V0UG9zaXRpb24oKS54KSAqKiAyICtcclxuICAgICAgICAgIChhZ2VudC5nZXRQb3NpdGlvbigpLnkgLSBvdGhlci5nZXRQb3NpdGlvbigpLnkpICoqIDIgPD1cclxuICAgICAgICAgIHJhbmdlICoqIDJcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBmb3JFYWNoKGZ1bjogKGFnZW50OiBJQWdlbnQpID0+IHZvaWQpOiB2b2lkIHtcclxuICAgIHRoaXMuX2FnZW50cy5mb3JFYWNoKChhZ2VudCkgPT4gZnVuKGFnZW50KSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7IFNpbXVsYXRpb24gfSBmcm9tIFwiLi9TaW11bGF0aW9uXCI7XHJcbmltcG9ydCB7IFJlbmRlcmVyMkQgfSBmcm9tIFwiLi9SZW5kZXJlcjJEXCI7XHJcblxyXG5pbXBvcnQgeyBCYXNpY0FnZW50IH0gZnJvbSBcIi4vQmFzaWNBZ2VudFwiO1xyXG5pbXBvcnQgeyBTdG9wQWdlbnQgfSBmcm9tIFwiLi9TdG9wQWdlbnRcIjtcclxuaW1wb3J0IHsgQ29uZmlndXJhdGlvbnMgfSBmcm9tIFwiLi9Db25maWd1cmF0aW9uc1wiO1xyXG5pbXBvcnQgeyBBZ2VudExpc3QgfSBmcm9tIFwiLi9BZ2VudExpc3RcIjtcclxuXHJcbmNvbnN0IGNvbmZpZ1NlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY29uZmlnXCIpIGFzIEhUTUxTZWxlY3RFbGVtZW50O1xyXG5jb25zdCBhZ2VudFR5cGVTZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcclxuICBcImFnZW50VHlwZVwiXHJcbikgYXMgSFRNTFNlbGVjdEVsZW1lbnQ7XHJcbmNvbnN0IG51bWJlck9mQWdlbnRzSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcclxuICBcIm51bWJlck9mQWdlbnRzXCJcclxuKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xyXG5cclxuY29uc3QgY2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjYW52YXNcIikgYXMgSFRNTENhbnZhc0VsZW1lbnQ7XHJcbmNvbnN0IGZyYW1lcmF0ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZnJhbWVyYXRlXCIpIGFzIEhUTUxQYXJhZ3JhcGhFbGVtZW50O1xyXG5jb25zdCBwbGF5QnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwbGF5QnV0dG9uXCIpIGFzIEhUTUxCdXR0b25FbGVtZW50O1xyXG5jb25zdCBzdGVwQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzdGVwQnV0dG9uXCIpIGFzIEhUTUxCdXR0b25FbGVtZW50O1xyXG5cclxuY29uc3QgcmVuZGVyZXIgPSBuZXcgUmVuZGVyZXIyRChjYW52YXMpO1xyXG5jb25zdCBzaW11bGF0aW9uID0gbmV3IFNpbXVsYXRpb24ocmVuZGVyZXIsIG5ldyBBZ2VudExpc3QoKSk7XHJcbnZhciBwbGF5ID0gZmFsc2U7XHJcblxyXG4vLyBpbml0aWFsaXNlIHNpbXVsYXRpb24gYW5kIGJlZ2luIHVwZGF0ZS9yZW5kZXIgbG9vcFxyXG5leHBvcnQgZnVuY3Rpb24gaW5pdCgpIHtcclxuICB0aGlzLnJlY29uZmlndXJlKCk7XHJcblxyXG4gIGxldCBsYXN0UmVuZGVyID0gMDtcclxuICBsZXQgbGFzdEZQUyA9IDA7XHJcbiAgbGV0IGZyYW1lcyA9IDA7XHJcblxyXG4gIGZ1bmN0aW9uIGxvb3AodGltZXN0YW1wOiBudW1iZXIpIHtcclxuICAgIGxldCBkZWx0YVQgPSB0aW1lc3RhbXAgLSBsYXN0UmVuZGVyO1xyXG4gICAgbGFzdFJlbmRlciA9IHRpbWVzdGFtcDtcclxuXHJcbiAgICAvLyB1cGRhdGVcclxuICAgIGlmIChwbGF5KSB7XHJcbiAgICAgIHNpbXVsYXRpb24udXBkYXRlKGRlbHRhVCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gcmVuZGVyXHJcbiAgICBzaW11bGF0aW9uLmRyYXcoKTtcclxuICAgIGZyYW1lcysrO1xyXG5cclxuICAgIC8vIHJlY2FsY3VsYXRlIGZyYW1lcmF0ZSBldmVyeSAyNTBtc1xyXG4gICAgaWYgKHRpbWVzdGFtcCAtIGxhc3RGUFMgPj0gMjUwKSB7XHJcbiAgICAgIGZyYW1lcmF0ZS50ZXh0Q29udGVudCA9IGBGUFM6ICR7KFxyXG4gICAgICAgICgxMDAwICogZnJhbWVzKSAvXHJcbiAgICAgICAgKHRpbWVzdGFtcCAtIGxhc3RGUFMpXHJcbiAgICAgICkudG9GaXhlZCgxKX1gO1xyXG5cclxuICAgICAgZnJhbWVzID0gMDtcclxuICAgICAgbGFzdEZQUyA9IHRpbWVzdGFtcDtcclxuICAgIH1cclxuXHJcbiAgICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGxvb3ApO1xyXG4gIH1cclxuXHJcbiAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZShsb29wKTtcclxufVxyXG5cclxuLy8gdG9nZ2xlIHBsYXkvcGF1c2VcclxuZXhwb3J0IGZ1bmN0aW9uIHBsYXlQYXVzZSgpIHtcclxuICBwbGF5ID0gIXBsYXk7XHJcblxyXG4gIGlmIChwbGF5KSB7XHJcbiAgICBwbGF5QnV0dG9uLnRleHRDb250ZW50ID0gXCJQYXVzZVwiO1xyXG4gICAgc3RlcEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgfSBlbHNlIHtcclxuICAgIHBsYXlCdXR0b24udGV4dENvbnRlbnQgPSBcIlBsYXlcIjtcclxuICAgIHN0ZXBCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcclxuICB9XHJcbn1cclxuXHJcbi8vIHN0ZXAgc2ltdWxhdGlvbiBieSAxIGZyYW1lXHJcbmV4cG9ydCBmdW5jdGlvbiBzdGVwKCkge1xyXG4gIHNpbXVsYXRpb24udXBkYXRlKDEwMDAgLyA2MCk7IC8vIEFzc3VtZXMgNjBGUFNcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHJlY29uZmlndXJlKCkge1xyXG4gIGlmIChwbGF5KSB7XHJcbiAgICB0aGlzLnBsYXlQYXVzZSgpO1xyXG4gIH1cclxuXHJcbiAgY29uc3QgY29uZmlnID0gY29uZmlnU2VsZWN0LnZhbHVlO1xyXG4gIGNvbnN0IGFnZW50VHlwZSA9IGFnZW50VHlwZVNlbGVjdC52YWx1ZTsgLy8gVE9ETzogd2lyZSB0aGlzIGluXHJcbiAgY29uc3QgbiA9IHBhcnNlSW50KG51bWJlck9mQWdlbnRzSW5wdXQudmFsdWUpID8/IDA7XHJcblxyXG4gIC8vIFNlbGVjdCBhZ2VudCBjb25zdHJ1Y3RvclxyXG4gIGxldCBhZ2VudENvbnN0cnVjdG9yO1xyXG4gIHN3aXRjaCAoYWdlbnRUeXBlKSB7XHJcbiAgICBjYXNlIFwiQmFzaWNBZ2VudFwiOlxyXG4gICAgICBhZ2VudENvbnN0cnVjdG9yID0gKFxyXG4gICAgICAgIGlkOiBudW1iZXIsXHJcbiAgICAgICAgcG9zaXRpb246IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfSxcclxuICAgICAgICBnb2FsUG9zaXRpb246IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfSxcclxuICAgICAgICByYWRpdXM6IG51bWJlclxyXG4gICAgICApID0+IG5ldyBCYXNpY0FnZW50KGlkLCBwb3NpdGlvbiwgZ29hbFBvc2l0aW9uLCByYWRpdXMpO1xyXG4gICAgICBicmVhaztcclxuICAgIGNhc2UgXCJTdG9wQWdlbnRcIjpcclxuICAgICAgYWdlbnRDb25zdHJ1Y3RvciA9IChcclxuICAgICAgICBpZDogbnVtYmVyLFxyXG4gICAgICAgIHBvc2l0aW9uOiB7IHg6IG51bWJlcjsgeTogbnVtYmVyIH0sXHJcbiAgICAgICAgZ29hbFBvc2l0aW9uOiB7IHg6IG51bWJlcjsgeTogbnVtYmVyIH0sXHJcbiAgICAgICAgcmFkaXVzOiBudW1iZXJcclxuICAgICAgKSA9PiBuZXcgU3RvcEFnZW50KGlkLCBwb3NpdGlvbiwgZ29hbFBvc2l0aW9uLCByYWRpdXMpO1xyXG4gICAgICBicmVhaztcclxuICAgIGRlZmF1bHQ6IHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQWdlbnQgbm90IGltcGxlbWVudGVkXCIpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gU2VsZWN0IGNvbmZpZ3VyYXRpb25cclxuICBzd2l0Y2ggKGNvbmZpZykge1xyXG4gICAgY2FzZSBcIlJhbmRvbVRvUmFuZG9tXCI6IHtcclxuICAgICAgc2ltdWxhdGlvbi5pbml0KFxyXG4gICAgICAgIENvbmZpZ3VyYXRpb25zLlJhbmRvbVRvUmFuZG9tKFxyXG4gICAgICAgICAgbixcclxuICAgICAgICAgIGNhbnZhcy53aWR0aCxcclxuICAgICAgICAgIGNhbnZhcy5oZWlnaHQsXHJcbiAgICAgICAgICBhZ2VudENvbnN0cnVjdG9yXHJcbiAgICAgICAgKVxyXG4gICAgICApO1xyXG4gICAgICBicmVhaztcclxuICAgIH1cclxuICAgIGNhc2UgXCJSYW5kb21Ub0xpbmVcIjoge1xyXG4gICAgICBzaW11bGF0aW9uLmluaXQoXHJcbiAgICAgICAgQ29uZmlndXJhdGlvbnMuUmFuZG9tVG9MaW5lKFxyXG4gICAgICAgICAgbixcclxuICAgICAgICAgIGNhbnZhcy53aWR0aCxcclxuICAgICAgICAgIGNhbnZhcy5oZWlnaHQsXHJcbiAgICAgICAgICBhZ2VudENvbnN0cnVjdG9yXHJcbiAgICAgICAgKVxyXG4gICAgICApO1xyXG4gICAgICBicmVhaztcclxuICAgIH1cclxuICAgIGNhc2UgXCJDaXJjbGVUb0NpcmNsZVwiOiB7XHJcbiAgICAgIHNpbXVsYXRpb24uaW5pdChcclxuICAgICAgICBDb25maWd1cmF0aW9ucy5DaXJjbGVUb0NpcmNsZShcclxuICAgICAgICAgIG4sXHJcbiAgICAgICAgICBjYW52YXMud2lkdGgsXHJcbiAgICAgICAgICBjYW52YXMuaGVpZ2h0LFxyXG4gICAgICAgICAgYWdlbnRDb25zdHJ1Y3RvclxyXG4gICAgICAgIClcclxuICAgICAgKTtcclxuICAgICAgYnJlYWs7XHJcbiAgICB9XHJcbiAgICBkZWZhdWx0OiB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkNvbmZpZ3VyYXRpb24gbm90IGltcGxlbWVudGVkXCIpO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHRpZihfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdKSB7XG5cdFx0cmV0dXJuIF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0uZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXShtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsIi8vIG1vZHVsZSBleHBvcnRzIG11c3QgYmUgcmV0dXJuZWQgZnJvbSBydW50aW1lIHNvIGVudHJ5IGlubGluaW5nIGlzIGRpc2FibGVkXG4vLyBzdGFydHVwXG4vLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbnJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKDY2OCk7XG4iLCIvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9ucyBmb3IgaGFybW9ueSBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSAoZXhwb3J0cywgZGVmaW5pdGlvbikgPT4ge1xuXHRmb3IodmFyIGtleSBpbiBkZWZpbml0aW9uKSB7XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGRlZmluaXRpb24sIGtleSkgJiYgIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBrZXkpKSB7XG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZGVmaW5pdGlvbltrZXldIH0pO1xuXHRcdH1cblx0fVxufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSAob2JqLCBwcm9wKSA9PiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKSIsIi8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uciA9IChleHBvcnRzKSA9PiB7XG5cdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuXHR9XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG59OyJdLCJzb3VyY2VSb290IjoiIn0=