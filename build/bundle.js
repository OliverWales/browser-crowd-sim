var CrowdSimulator;CrowdSimulator=(()=>{"use strict";var t={240:(t,n,e)=>{e.r(n),e.d(n,{init:()=>p,playPause:()=>y,reconfigure:()=>x,step:()=>l});var o=function(){function t(t){this._renderer=t,this._agents=[]}return t.prototype.init=function(t){this._agents=t.agents},t.prototype.update=function(t){this._agents.forEach((function(n){n.update(t)}))},t.prototype.draw=function(){var t=this;this._renderer.clear(),this._agents.forEach((function(n){t._renderer.drawAgent(n)}))},t}(),i=function(){function t(t){this._context=t.getContext("2d")}return t.prototype.clear=function(){this._context.fillStyle="white",this._context.fillRect(0,0,this._context.canvas.width,this._context.canvas.height)},t.prototype.drawAgent=function(t){var n=t.getPosition(),e=t.getDirection();if(this._context.beginPath(),this._context.arc(n.x,n.y,t.Radius,0,2*Math.PI),0!==e.dx||0!==e.dy){var o=Math.sqrt(Math.pow(e.dx,2)+Math.pow(e.dy,2));this._context.moveTo(n.x,n.y),this._context.lineTo(n.x+t.Radius*e.dx/o,n.y+t.Radius*e.dy/o)}this._context.stroke()},t}(),r=function(){function t(t,n,e){this._position=t,this._goalPosition=n,this.Radius=e,this._direction={dx:0,dy:0}}return t.prototype.getPosition=function(){return this._position},t.prototype.getDirection=function(){return this._direction},t.prototype.update=function(t){var n={x:this._goalPosition.x-this._position.x,y:this._goalPosition.y-this._position.y},e=Math.sqrt(Math.pow(n.x,2)+Math.pow(n.y,2));e>1&&(this._direction.dx=n.x/e,this._direction.dy=n.y/e,this._position.x+=this._direction.dx,this._position.y+=this._direction.dy)},t}(),a=function(){function t(){}return t.RandomToRandom=function(t,n,e,o){for(var i=[],r=0;r<t;r++){var a=o({x:n*Math.random(),y:e*Math.random()},{x:n*Math.random(),y:e*Math.random()},20);i.push(a)}return{agents:i}},t.RandomToLine=function(t,n,e,o){for(var i=[],r=0;r<t;r++){var a=o({x:n*Math.random(),y:e*Math.random()},{x:(r+1)/(t+1)*n,y:e/2},20);i.push(a)}return{agents:i}},t.CircleToCircle=function(t,n,e,o){for(var i=[],r=n/2,a=e/2,s=e/2-25,u=0;u<t;u++){var h=2*Math.PI*u/t,d=o({x:r+s*Math.cos(h),y:a+s*Math.sin(h)},{x:r+s*Math.cos(h+Math.PI),y:a+s*Math.sin(h+Math.PI)},20);i.push(d)}return{agents:i}},t}(),s=document.getElementById("canvas"),u=document.getElementById("framerate"),h=document.getElementById("playButton"),d=document.getElementById("stepButton"),c=new o(new i(s)),f=!1;function p(){this.reconfigure(0);var t=0,n=0,e=0;window.requestAnimationFrame((function o(i){var r=i-t;t=i,f&&c.update(r),c.draw(),e++,i-n>=250&&(u.textContent="FPS: "+(1e3*e/(i-n)).toFixed(1),e=0,n=i),window.requestAnimationFrame(o)}))}function y(){(f=!f)?(h.textContent="Pause",d.disabled=!0):(h.textContent="Play",d.disabled=!1)}function l(){c.update(1e3/60)}function x(t){switch(f&&this.playPause(),t){case 0:c.init(a.RandomToRandom(25,s.width,s.height,(function(t,n,e){return new r(t,n,e)})));break;case 1:c.init(a.RandomToLine(25,s.width,s.height,(function(t,n,e){return new r(t,n,e)})));break;case 2:c.init(a.CircleToCircle(25,s.width,s.height,(function(t,n,e){return new r(t,n,e)})));break;default:throw new Error("Configuration not implemented")}}a.RandomToRandom(25,s.width,s.height,(function(t,n,e){return new r(t,n,e)})),a.RandomToLine(25,s.width,s.height,(function(t,n,e){return new r(t,n,e)})),a.CircleToCircle(25,s.width,s.height,(function(t,n,e){return new r(t,n,e)}))}},n={};function e(o){if(n[o])return n[o].exports;var i=n[o]={exports:{}};return t[o](i,i.exports,e),i.exports}return e.d=(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},e.o=(t,n)=>Object.prototype.hasOwnProperty.call(t,n),e.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e(240)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9Dcm93ZFNpbXVsYXRvci8uL3NyYy9TaW11bGF0aW9uLnRzIiwid2VicGFjazovL0Nyb3dkU2ltdWxhdG9yLy4vc3JjL1JlbmRlcmVyMkQudHMiLCJ3ZWJwYWNrOi8vQ3Jvd2RTaW11bGF0b3IvLi9zcmMvQmFzaWNBZ2VudC50cyIsIndlYnBhY2s6Ly9Dcm93ZFNpbXVsYXRvci8uL3NyYy9Db25maWd1cmF0aW9ucy50cyIsIndlYnBhY2s6Ly9Dcm93ZFNpbXVsYXRvci8uL3NyYy9tYWluLnRzIiwid2VicGFjazovL0Nyb3dkU2ltdWxhdG9yL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL0Nyb3dkU2ltdWxhdG9yL3dlYnBhY2svc3RhcnR1cCIsIndlYnBhY2s6Ly9Dcm93ZFNpbXVsYXRvci93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vQ3Jvd2RTaW11bGF0b3Ivd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly9Dcm93ZFNpbXVsYXRvci93ZWJwYWNrL3J1bnRpbWUvbWFrZSBuYW1lc3BhY2Ugb2JqZWN0Il0sIm5hbWVzIjpbInJlbmRlcmVyIiwidGhpcyIsIl9yZW5kZXJlciIsIl9hZ2VudHMiLCJpbml0IiwiY29uZmlnIiwiYWdlbnRzIiwidXBkYXRlIiwiZGVsdGFUIiwiZm9yRWFjaCIsImFnZW50IiwiZHJhdyIsImNsZWFyIiwiZHJhd0FnZW50IiwiY2FudmFzIiwiX2NvbnRleHQiLCJnZXRDb250ZXh0IiwiZmlsbFN0eWxlIiwiZmlsbFJlY3QiLCJ3aWR0aCIsImhlaWdodCIsInBvc2l0aW9uIiwiZ2V0UG9zaXRpb24iLCJkaXJlY3Rpb24iLCJnZXREaXJlY3Rpb24iLCJiZWdpblBhdGgiLCJhcmMiLCJ4IiwieSIsIlJhZGl1cyIsIk1hdGgiLCJQSSIsImR4IiwiZHkiLCJtYWduaXR1ZGUiLCJzcXJ0IiwibW92ZVRvIiwibGluZVRvIiwic3Ryb2tlIiwiZ29hbFBvc2l0aW9uIiwicmFkaXVzIiwiX3Bvc2l0aW9uIiwiX2dvYWxQb3NpdGlvbiIsIl9kaXJlY3Rpb24iLCJnb2FsRGlyZWN0aW9uIiwiZ29hbERpc3RhbmNlIiwiUmFuZG9tVG9SYW5kb20iLCJuIiwiYWdlbnRDb25zdHJ1Y3RvciIsImkiLCJyYW5kb20iLCJwdXNoIiwiUmFuZG9tVG9MaW5lIiwiQ2lyY2xlVG9DaXJjbGUiLCJjZW50cmVYIiwiY2VudHJlWSIsImFuZ2xlIiwiY29zIiwic2luIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImZyYW1lcmF0ZSIsInBsYXlCdXR0b24iLCJzdGVwQnV0dG9uIiwic2ltdWxhdGlvbiIsIlNpbXVsYXRpb24iLCJSZW5kZXJlcjJEIiwicGxheSIsInJlY29uZmlndXJlIiwibGFzdFJlbmRlciIsImxhc3RGUFMiLCJmcmFtZXMiLCJ3aW5kb3ciLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJsb29wIiwidGltZXN0YW1wIiwidGV4dENvbnRlbnQiLCJ0b0ZpeGVkIiwicGxheVBhdXNlIiwiZGlzYWJsZWQiLCJzdGVwIiwiaW5kZXgiLCJDb25maWd1cmF0aW9ucyIsInMiLCJnIiwiciIsIkJhc2ljQWdlbnQiLCJFcnJvciIsInBvcyIsImdvYWxQb3MiLCJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsImQiLCJkZWZpbml0aW9uIiwia2V5IiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsIm9iaiIsInByb3AiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIl0sIm1hcHBpbmdzIjoia0pBSUEsaUJBSUUsV0FBWUEsR0FDVkMsS0FBS0MsVUFBWUYsRUFDakJDLEtBQUtFLFFBQVUsR0Ft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b24gfSBmcm9tIFwiLi9Db25maWd1cmF0aW9uc1wiO1xyXG5pbXBvcnQgeyBJQWdlbnQgfSBmcm9tIFwiLi9JQWdlbnRcIjtcclxuaW1wb3J0IHsgSVJlbmRlcmVyIH0gZnJvbSBcIi4vSVJlbmRlcmVyXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgU2ltdWxhdGlvbiB7XHJcbiAgX3JlbmRlcmVyOiBJUmVuZGVyZXI7XHJcbiAgX2FnZW50czogSUFnZW50W107XHJcblxyXG4gIGNvbnN0cnVjdG9yKHJlbmRlcmVyOiBJUmVuZGVyZXIpIHtcclxuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICB0aGlzLl9hZ2VudHMgPSBbXTtcclxuICB9XHJcblxyXG4gIGluaXQoY29uZmlnOiBJQ29uZmlndXJhdGlvbikge1xyXG4gICAgdGhpcy5fYWdlbnRzID0gY29uZmlnLmFnZW50cztcclxuICB9XHJcblxyXG4gIHVwZGF0ZShkZWx0YVQ6IG51bWJlcikge1xyXG4gICAgdGhpcy5fYWdlbnRzLmZvckVhY2goKGFnZW50KSA9PiB7XHJcbiAgICAgIGFnZW50LnVwZGF0ZShkZWx0YVQpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBkcmF3KCkge1xyXG4gICAgdGhpcy5fcmVuZGVyZXIuY2xlYXIoKTtcclxuICAgIHRoaXMuX2FnZW50cy5mb3JFYWNoKChhZ2VudCkgPT4ge1xyXG4gICAgICB0aGlzLl9yZW5kZXJlci5kcmF3QWdlbnQoYWdlbnQpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7IElBZ2VudCB9IGZyb20gXCIuL0lBZ2VudFwiO1xyXG5pbXBvcnQgeyBJUmVuZGVyZXIgfSBmcm9tIFwiLi9JUmVuZGVyZXJcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBSZW5kZXJlcjJEIGltcGxlbWVudHMgSVJlbmRlcmVyIHtcclxuICBfY29udGV4dDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEO1xyXG5cclxuICBjb25zdHJ1Y3RvcihjYW52YXM6IEhUTUxDYW52YXNFbGVtZW50KSB7XHJcbiAgICB0aGlzLl9jb250ZXh0ID0gY2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcclxuICB9XHJcblxyXG4gIGNsZWFyKCk6IHZvaWQge1xyXG4gICAgdGhpcy5fY29udGV4dC5maWxsU3R5bGUgPSBcIndoaXRlXCI7XHJcbiAgICB0aGlzLl9jb250ZXh0LmZpbGxSZWN0KFxyXG4gICAgICAwLFxyXG4gICAgICAwLFxyXG4gICAgICB0aGlzLl9jb250ZXh0LmNhbnZhcy53aWR0aCxcclxuICAgICAgdGhpcy5fY29udGV4dC5jYW52YXMuaGVpZ2h0XHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgZHJhd0FnZW50KGFnZW50OiBJQWdlbnQpIHtcclxuICAgIGxldCBwb3NpdGlvbiA9IGFnZW50LmdldFBvc2l0aW9uKCk7XHJcbiAgICBsZXQgZGlyZWN0aW9uID0gYWdlbnQuZ2V0RGlyZWN0aW9uKCk7XHJcblxyXG4gICAgdGhpcy5fY29udGV4dC5iZWdpblBhdGgoKTtcclxuXHJcbiAgICAvLyBkcmF3IGFnZW50XHJcbiAgICB0aGlzLl9jb250ZXh0LmFyYyhwb3NpdGlvbi54LCBwb3NpdGlvbi55LCBhZ2VudC5SYWRpdXMsIDAsIDIgKiBNYXRoLlBJKTtcclxuXHJcbiAgICAvLyBkcmF3IGRpcmVjdGlvblxyXG4gICAgaWYgKGRpcmVjdGlvbi5keCAhPT0gMCB8fCBkaXJlY3Rpb24uZHkgIT09IDApIHtcclxuICAgICAgbGV0IG1hZ25pdHVkZSA9IE1hdGguc3FydChkaXJlY3Rpb24uZHggKiogMiArIGRpcmVjdGlvbi5keSAqKiAyKTtcclxuXHJcbiAgICAgIHRoaXMuX2NvbnRleHQubW92ZVRvKHBvc2l0aW9uLngsIHBvc2l0aW9uLnkpO1xyXG4gICAgICB0aGlzLl9jb250ZXh0LmxpbmVUbyhcclxuICAgICAgICBwb3NpdGlvbi54ICsgKGFnZW50LlJhZGl1cyAqIGRpcmVjdGlvbi5keCkgLyBtYWduaXR1ZGUsXHJcbiAgICAgICAgcG9zaXRpb24ueSArIChhZ2VudC5SYWRpdXMgKiBkaXJlY3Rpb24uZHkpIC8gbWFnbml0dWRlXHJcbiAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5fY29udGV4dC5zdHJva2UoKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgSUFnZW50IH0gZnJvbSBcIi4vSUFnZW50XCI7XHJcblxyXG5leHBvcnQgY2xhc3MgQmFzaWNBZ2VudCBpbXBsZW1lbnRzIElBZ2VudCB7XHJcbiAgcHJpdmF0ZSBfcG9zaXRpb246IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfTtcclxuICBwcml2YXRlIF9nb2FsUG9zaXRpb246IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfTtcclxuICBwdWJsaWMgcmVhZG9ubHkgUmFkaXVzOiBudW1iZXI7XHJcblxyXG4gIHByaXZhdGUgX2RpcmVjdGlvbjogeyBkeDogbnVtYmVyOyBkeTogbnVtYmVyIH07XHJcblxyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcG9zaXRpb246IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfSxcclxuICAgIGdvYWxQb3NpdGlvbjogeyB4OiBudW1iZXI7IHk6IG51bWJlciB9LFxyXG4gICAgcmFkaXVzOiBudW1iZXJcclxuICApIHtcclxuICAgIHRoaXMuX3Bvc2l0aW9uID0gcG9zaXRpb247XHJcbiAgICB0aGlzLl9nb2FsUG9zaXRpb24gPSBnb2FsUG9zaXRpb247XHJcbiAgICB0aGlzLlJhZGl1cyA9IHJhZGl1cztcclxuXHJcbiAgICB0aGlzLl9kaXJlY3Rpb24gPSB7IGR4OiAwLCBkeTogMCB9O1xyXG4gIH1cclxuXHJcbiAgZ2V0UG9zaXRpb24oKTogeyB4OiBudW1iZXI7IHk6IG51bWJlciB9IHtcclxuICAgIHJldHVybiB0aGlzLl9wb3NpdGlvbjtcclxuICB9XHJcblxyXG4gIGdldERpcmVjdGlvbigpOiB7IGR4OiBudW1iZXI7IGR5OiBudW1iZXIgfSB7XHJcbiAgICByZXR1cm4gdGhpcy5fZGlyZWN0aW9uO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlKGRlbHRhVDogbnVtYmVyKTogdm9pZCB7XHJcbiAgICBsZXQgZ29hbERpcmVjdGlvbiA9IHtcclxuICAgICAgeDogdGhpcy5fZ29hbFBvc2l0aW9uLnggLSB0aGlzLl9wb3NpdGlvbi54LFxyXG4gICAgICB5OiB0aGlzLl9nb2FsUG9zaXRpb24ueSAtIHRoaXMuX3Bvc2l0aW9uLnksXHJcbiAgICB9O1xyXG4gICAgbGV0IGdvYWxEaXN0YW5jZSA9IE1hdGguc3FydChnb2FsRGlyZWN0aW9uLnggKiogMiArIGdvYWxEaXJlY3Rpb24ueSAqKiAyKTtcclxuXHJcbiAgICBpZiAoZ29hbERpc3RhbmNlID4gMSkge1xyXG4gICAgICB0aGlzLl9kaXJlY3Rpb24uZHggPSBnb2FsRGlyZWN0aW9uLnggLyBnb2FsRGlzdGFuY2U7XHJcbiAgICAgIHRoaXMuX2RpcmVjdGlvbi5keSA9IGdvYWxEaXJlY3Rpb24ueSAvIGdvYWxEaXN0YW5jZTtcclxuICAgICAgdGhpcy5fcG9zaXRpb24ueCArPSB0aGlzLl9kaXJlY3Rpb24uZHg7XHJcbiAgICAgIHRoaXMuX3Bvc2l0aW9uLnkgKz0gdGhpcy5fZGlyZWN0aW9uLmR5O1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgeyBJQWdlbnQgfSBmcm9tIFwiLi9JQWdlbnRcIjtcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSUNvbmZpZ3VyYXRpb24ge1xyXG4gIGFnZW50czogSUFnZW50W107XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBDb25maWd1cmF0aW9ucyB7XHJcbiAgc3RhdGljIFJhbmRvbVRvUmFuZG9tKFxyXG4gICAgbjogbnVtYmVyLFxyXG4gICAgd2lkdGg6IG51bWJlcixcclxuICAgIGhlaWdodDogbnVtYmVyLFxyXG4gICAgYWdlbnRDb25zdHJ1Y3RvcjogKFxyXG4gICAgICBzdGFydFBvc2l0aW9uOiB7IHg6IG51bWJlcjsgeTogbnVtYmVyIH0sXHJcbiAgICAgIGdvYWxQb3NpdGlvbjogeyB4OiBudW1iZXI7IHk6IG51bWJlciB9LFxyXG4gICAgICByYWRpdXM6IG51bWJlclxyXG4gICAgKSA9PiBJQWdlbnRcclxuICApIHtcclxuICAgIC8vIFJhbmRvbSBzdGFydCBwb3NpdGlvbiB0byByYW5kb20gZ29hbCBwb3NpdGlvblxyXG4gICAgbGV0IGFnZW50czogSUFnZW50W10gPSBbXTtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbjsgaSsrKSB7XHJcbiAgICAgIGNvbnN0IGFnZW50ID0gYWdlbnRDb25zdHJ1Y3RvcihcclxuICAgICAgICB7IHg6IHdpZHRoICogTWF0aC5yYW5kb20oKSwgeTogaGVpZ2h0ICogTWF0aC5yYW5kb20oKSB9LFxyXG4gICAgICAgIHsgeDogd2lkdGggKiBNYXRoLnJhbmRvbSgpLCB5OiBoZWlnaHQgKiBNYXRoLnJhbmRvbSgpIH0sXHJcbiAgICAgICAgMjBcclxuICAgICAgKTtcclxuICAgICAgYWdlbnRzLnB1c2goYWdlbnQpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7IGFnZW50czogYWdlbnRzIH0gYXMgSUNvbmZpZ3VyYXRpb247XHJcbiAgfVxyXG5cclxuICBzdGF0aWMgUmFuZG9tVG9MaW5lKFxyXG4gICAgbjogbnVtYmVyLFxyXG4gICAgd2lkdGg6IG51bWJlcixcclxuICAgIGhlaWdodDogbnVtYmVyLFxyXG4gICAgYWdlbnRDb25zdHJ1Y3RvcjogKFxyXG4gICAgICBzdGFydFBvc2l0aW9uOiB7IHg6IG51bWJlcjsgeTogbnVtYmVyIH0sXHJcbiAgICAgIGdvYWxQb3NpdGlvbjogeyB4OiBudW1iZXI7IHk6IG51bWJlciB9LFxyXG4gICAgICByYWRpdXM6IG51bWJlclxyXG4gICAgKSA9PiBJQWdlbnRcclxuICApIHtcclxuICAgIC8vIFJhbmRvbSBzdGFydCBwb3NpdGlvbiB0byBmaXhlZCBwb3NpdGlvbiBvbiBsaW5lXHJcbiAgICBsZXQgYWdlbnRzOiBJQWdlbnRbXSA9IFtdO1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBuOyBpKyspIHtcclxuICAgICAgY29uc3QgYWdlbnQgPSBhZ2VudENvbnN0cnVjdG9yKFxyXG4gICAgICAgIHsgeDogd2lkdGggKiBNYXRoLnJhbmRvbSgpLCB5OiBoZWlnaHQgKiBNYXRoLnJhbmRvbSgpIH0sXHJcbiAgICAgICAgeyB4OiAoKGkgKyAxKSAvIChuICsgMSkpICogd2lkdGgsIHk6IGhlaWdodCAvIDIgfSxcclxuICAgICAgICAyMFxyXG4gICAgICApO1xyXG4gICAgICBhZ2VudHMucHVzaChhZ2VudCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHsgYWdlbnRzOiBhZ2VudHMgfSBhcyBJQ29uZmlndXJhdGlvbjtcclxuICB9XHJcblxyXG4gIHN0YXRpYyBDaXJjbGVUb0NpcmNsZShcclxuICAgIG46IG51bWJlcixcclxuICAgIHdpZHRoOiBudW1iZXIsXHJcbiAgICBoZWlnaHQ6IG51bWJlcixcclxuICAgIGFnZW50Q29uc3RydWN0b3I6IChcclxuICAgICAgc3RhcnRQb3NpdGlvbjogeyB4OiBudW1iZXI7IHk6IG51bWJlciB9LFxyXG4gICAgICBnb2FsUG9zaXRpb246IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfSxcclxuICAgICAgcmFkaXVzOiBudW1iZXJcclxuICAgICkgPT4gSUFnZW50XHJcbiAgKSB7XHJcbiAgICAvLyBQb3NpdGlvbiBvbiByYWRpdXMgb2YgY2lyY2xlIHRvIG9wcG9zaXRlIHBvaW50XHJcbiAgICBsZXQgYWdlbnRzOiBJQWdlbnRbXSA9IFtdO1xyXG4gICAgY29uc3QgY2VudHJlWCA9IHdpZHRoIC8gMjtcclxuICAgIGNvbnN0IGNlbnRyZVkgPSBoZWlnaHQgLyAyO1xyXG4gICAgY29uc3QgcmFkaXVzID0gaGVpZ2h0IC8gMiAtIDI1O1xyXG5cclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbjsgaSsrKSB7XHJcbiAgICAgIGNvbnN0IGFuZ2xlID0gKDIgKiBNYXRoLlBJICogaSkgLyBuO1xyXG4gICAgICBjb25zdCBhZ2VudCA9IGFnZW50Q29uc3RydWN0b3IoXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgeDogY2VudHJlWCArIHJhZGl1cyAqIE1hdGguY29zKGFuZ2xlKSxcclxuICAgICAgICAgIHk6IGNlbnRyZVkgKyByYWRpdXMgKiBNYXRoLnNpbihhbmdsZSksXHJcbiAgICAgICAgfSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICB4OiBjZW50cmVYICsgcmFkaXVzICogTWF0aC5jb3MoYW5nbGUgKyBNYXRoLlBJKSxcclxuICAgICAgICAgIHk6IGNlbnRyZVkgKyByYWRpdXMgKiBNYXRoLnNpbihhbmdsZSArIE1hdGguUEkpLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgMjBcclxuICAgICAgKTtcclxuICAgICAgYWdlbnRzLnB1c2goYWdlbnQpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7IGFnZW50czogYWdlbnRzIH0gYXMgSUNvbmZpZ3VyYXRpb247XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7IFNpbXVsYXRpb24gfSBmcm9tIFwiLi9TaW11bGF0aW9uXCI7XHJcbmltcG9ydCB7IFJlbmRlcmVyMkQgfSBmcm9tIFwiLi9SZW5kZXJlcjJEXCI7XHJcbmltcG9ydCB7IEJhc2ljQWdlbnQgfSBmcm9tIFwiLi9CYXNpY0FnZW50XCI7XHJcbmltcG9ydCB7IENvbmZpZ3VyYXRpb25zLCBJQ29uZmlndXJhdGlvbiB9IGZyb20gXCIuL0NvbmZpZ3VyYXRpb25zXCI7XHJcblxyXG5jb25zdCBjYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNhbnZhc1wiKSBhcyBIVE1MQ2FudmFzRWxlbWVudDtcclxuY29uc3QgZnJhbWVyYXRlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJmcmFtZXJhdGVcIikgYXMgSFRNTENhbnZhc0VsZW1lbnQ7XHJcbmNvbnN0IHBsYXlCdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBsYXlCdXR0b25cIikgYXMgSFRNTEJ1dHRvbkVsZW1lbnQ7XHJcbmNvbnN0IHN0ZXBCdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInN0ZXBCdXR0b25cIikgYXMgSFRNTEJ1dHRvbkVsZW1lbnQ7XHJcblxyXG5jb25zdCByZW5kZXJlciA9IG5ldyBSZW5kZXJlcjJEKGNhbnZhcyk7XHJcbmNvbnN0IHNpbXVsYXRpb24gPSBuZXcgU2ltdWxhdGlvbihyZW5kZXJlcik7XHJcbnZhciBwbGF5ID0gZmFsc2U7XHJcblxyXG5jb25zdCBjb25maWd1cmF0aW9uczogSUNvbmZpZ3VyYXRpb25bXSA9IFtcclxuICBDb25maWd1cmF0aW9ucy5SYW5kb21Ub1JhbmRvbShcclxuICAgIDI1LFxyXG4gICAgY2FudmFzLndpZHRoLFxyXG4gICAgY2FudmFzLmhlaWdodCxcclxuICAgIChwb3MsIGdvYWxQb3MsIHJhZGl1cykgPT4gbmV3IEJhc2ljQWdlbnQocG9zLCBnb2FsUG9zLCByYWRpdXMpXHJcbiAgKSxcclxuICBDb25maWd1cmF0aW9ucy5SYW5kb21Ub0xpbmUoXHJcbiAgICAyNSxcclxuICAgIGNhbnZhcy53aWR0aCxcclxuICAgIGNhbnZhcy5oZWlnaHQsXHJcbiAgICAocG9zLCBnb2FsUG9zLCByYWRpdXMpID0+IG5ldyBCYXNpY0FnZW50KHBvcywgZ29hbFBvcywgcmFkaXVzKVxyXG4gICksXHJcbiAgQ29uZmlndXJhdGlvbnMuQ2lyY2xlVG9DaXJjbGUoXHJcbiAgICAyNSxcclxuICAgIGNhbnZhcy53aWR0aCxcclxuICAgIGNhbnZhcy5oZWlnaHQsXHJcbiAgICAocG9zLCBnb2FsUG9zLCByYWRpdXMpID0+IG5ldyBCYXNpY0FnZW50KHBvcywgZ29hbFBvcywgcmFkaXVzKVxyXG4gICksXHJcbl07XHJcblxyXG4vLyBpbml0aWFsaXNlIHNpbXVsYXRpb24gYW5kIGJlZ2luIHVwZGF0ZS9yZW5kZXIgbG9vcFxyXG5leHBvcnQgZnVuY3Rpb24gaW5pdCgpIHtcclxuICB0aGlzLnJlY29uZmlndXJlKDApO1xyXG5cclxuICBsZXQgbGFzdFJlbmRlciA9IDA7XHJcbiAgbGV0IGxhc3RGUFMgPSAwO1xyXG4gIGxldCBmcmFtZXMgPSAwO1xyXG5cclxuICBmdW5jdGlvbiBsb29wKHRpbWVzdGFtcDogbnVtYmVyKSB7XHJcbiAgICBsZXQgZGVsdGFUID0gdGltZXN0YW1wIC0gbGFzdFJlbmRlcjtcclxuICAgIGxhc3RSZW5kZXIgPSB0aW1lc3RhbXA7XHJcblxyXG4gICAgLy8gdXBkYXRlXHJcbiAgICBpZiAocGxheSkge1xyXG4gICAgICBzaW11bGF0aW9uLnVwZGF0ZShkZWx0YVQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIHJlbmRlclxyXG4gICAgc2ltdWxhdGlvbi5kcmF3KCk7XHJcbiAgICBmcmFtZXMrKztcclxuXHJcbiAgICAvLyByZWNhbGN1bGF0ZSBmcmFtZXJhdGUgZXZlcnkgMjUwbXNcclxuICAgIGlmICh0aW1lc3RhbXAgLSBsYXN0RlBTID49IDI1MCkge1xyXG4gICAgICBmcmFtZXJhdGUudGV4dENvbnRlbnQgPSBgRlBTOiAkeyhcclxuICAgICAgICAoMTAwMCAqIGZyYW1lcykgL1xyXG4gICAgICAgICh0aW1lc3RhbXAgLSBsYXN0RlBTKVxyXG4gICAgICApLnRvRml4ZWQoMSl9YDtcclxuXHJcbiAgICAgIGZyYW1lcyA9IDA7XHJcbiAgICAgIGxhc3RGUFMgPSB0aW1lc3RhbXA7XHJcbiAgICB9XHJcblxyXG4gICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZShsb29wKTtcclxuICB9XHJcblxyXG4gIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUobG9vcCk7XHJcbn1cclxuXHJcbi8vIHRvZ2dsZSBwbGF5L3BhdXNlXHJcbmV4cG9ydCBmdW5jdGlvbiBwbGF5UGF1c2UoKSB7XHJcbiAgcGxheSA9ICFwbGF5O1xyXG5cclxuICBpZiAocGxheSkge1xyXG4gICAgcGxheUJ1dHRvbi50ZXh0Q29udGVudCA9IFwiUGF1c2VcIjtcclxuICAgIHN0ZXBCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBwbGF5QnV0dG9uLnRleHRDb250ZW50ID0gXCJQbGF5XCI7XHJcbiAgICBzdGVwQnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgfVxyXG59XHJcblxyXG4vLyBzdGVwIHNpbXVsYXRpb24gYnkgMSBmcmFtZVxyXG5leHBvcnQgZnVuY3Rpb24gc3RlcCgpIHtcclxuICBzaW11bGF0aW9uLnVwZGF0ZSgxMDAwIC8gNjApOyAvLyBBc3N1bWVzIDYwRlBTXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiByZWNvbmZpZ3VyZShpbmRleDogbnVtYmVyKSB7XHJcbiAgaWYgKHBsYXkpIHtcclxuICAgIHRoaXMucGxheVBhdXNlKCk7XHJcbiAgfVxyXG5cclxuICBjb25zdCBuID0gMjU7XHJcblxyXG4gIHN3aXRjaCAoaW5kZXgpIHtcclxuICAgIGNhc2UgMDoge1xyXG4gICAgICBzaW11bGF0aW9uLmluaXQoXHJcbiAgICAgICAgQ29uZmlndXJhdGlvbnMuUmFuZG9tVG9SYW5kb20oXHJcbiAgICAgICAgICBuLFxyXG4gICAgICAgICAgY2FudmFzLndpZHRoLFxyXG4gICAgICAgICAgY2FudmFzLmhlaWdodCxcclxuICAgICAgICAgIChzLCBnLCByKSA9PiBuZXcgQmFzaWNBZ2VudChzLCBnLCByKVxyXG4gICAgICAgIClcclxuICAgICAgKTtcclxuICAgICAgYnJlYWs7XHJcbiAgICB9XHJcbiAgICBjYXNlIDE6IHtcclxuICAgICAgc2ltdWxhdGlvbi5pbml0KFxyXG4gICAgICAgIENvbmZpZ3VyYXRpb25zLlJhbmRvbVRvTGluZShcclxuICAgICAgICAgIG4sXHJcbiAgICAgICAgICBjYW52YXMud2lkdGgsXHJcbiAgICAgICAgICBjYW52YXMuaGVpZ2h0LFxyXG4gICAgICAgICAgKHMsIGcsIHIpID0+IG5ldyBCYXNpY0FnZW50KHMsIGcsIHIpXHJcbiAgICAgICAgKVxyXG4gICAgICApO1xyXG4gICAgICBicmVhaztcclxuICAgIH1cclxuICAgIGNhc2UgMjoge1xyXG4gICAgICBzaW11bGF0aW9uLmluaXQoXHJcbiAgICAgICAgQ29uZmlndXJhdGlvbnMuQ2lyY2xlVG9DaXJjbGUoXHJcbiAgICAgICAgICBuLFxyXG4gICAgICAgICAgY2FudmFzLndpZHRoLFxyXG4gICAgICAgICAgY2FudmFzLmhlaWdodCxcclxuICAgICAgICAgIChzLCBnLCByKSA9PiBuZXcgQmFzaWNBZ2VudChzLCBnLCByKVxyXG4gICAgICAgIClcclxuICAgICAgKTtcclxuICAgICAgYnJlYWs7XHJcbiAgICB9XHJcbiAgICBkZWZhdWx0OiB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkNvbmZpZ3VyYXRpb24gbm90IGltcGxlbWVudGVkXCIpO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHRpZihfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdKSB7XG5cdFx0cmV0dXJuIF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0uZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXShtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsIi8vIG1vZHVsZSBleHBvcnRzIG11c3QgYmUgcmV0dXJuZWQgZnJvbSBydW50aW1lIHNvIGVudHJ5IGlubGluaW5nIGlzIGRpc2FibGVkXG4vLyBzdGFydHVwXG4vLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbnJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKDI0MCk7XG4iLCIvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9ucyBmb3IgaGFybW9ueSBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSAoZXhwb3J0cywgZGVmaW5pdGlvbikgPT4ge1xuXHRmb3IodmFyIGtleSBpbiBkZWZpbml0aW9uKSB7XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGRlZmluaXRpb24sIGtleSkgJiYgIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBrZXkpKSB7XG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZGVmaW5pdGlvbltrZXldIH0pO1xuXHRcdH1cblx0fVxufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSAob2JqLCBwcm9wKSA9PiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKSIsIi8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uciA9IChleHBvcnRzKSA9PiB7XG5cdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuXHR9XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG59OyJdLCJzb3VyY2VSb290IjoiIn0=