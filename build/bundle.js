var CrowdSimulator;CrowdSimulator=(()=>{"use strict";var t={389:(t,i,n)=>{n.r(i),n.d(i,{init:()=>x,playPause:()=>P,reconfigure:()=>v,step:()=>m});var o=function(){function t(t,i){this._renderer=t,this._agents=i}return t.prototype.init=function(t){this._agents.init(t.agents)},t.prototype.update=function(t){var i=this;this._agents.forEach((function(n){if(0==n.Id){var o=i._agents.getNeighboursInRangeRectilinear(n,200);o.forEach((function(t){t.makeStuck()})),console.log(o.length)}n.update(t,i._agents.getNeighboursInRangeRectilinear(n,200))})),this._agents.init(this._agents.getAll())},t.prototype.draw=function(){var t=this;this._renderer.clear(),this._agents.forEach((function(i){t._renderer.drawAgent(i)}))},t}(),e=function(){function t(t){this._context=t.getContext("2d")}return t.prototype.clear=function(){this._context.fillStyle="white",this._context.fillRect(0,0,this._context.canvas.width,this._context.canvas.height)},t.prototype.drawAgent=function(t){var i=t.getPosition(),n=t.getDirection();if(this._context.beginPath(),t.getIsDone()?this._context.strokeStyle="#00FF00":t.getIsStuck()?this._context.strokeStyle="#FF0000":this._context.strokeStyle="#000000",0==t.Id&&(this._context.strokeStyle="#FF00FF"),this._context.arc(i.x,i.y,t.Radius,0,2*Math.PI),0!==n.dx||0!==n.dy){var o=Math.sqrt(Math.pow(n.dx,2)+Math.pow(n.dy,2));this._context.moveTo(i.x,i.y),this._context.lineTo(i.x+t.Radius*n.dx/o,i.y+t.Radius*n.dy/o)}this._context.stroke()},t}(),r=function(){function t(t,i,n,o){this.Id=t,this._position=i,this._goalPosition=n,this.Radius=o,this._direction={dx:0,dy:0},this._isDone=!1}return t.prototype.getPosition=function(){return this._position},t.prototype.getDirection=function(){return this._direction},t.prototype.getIsDone=function(){return this._isDone},t.prototype.getIsStuck=function(){return this._isStuck},t.prototype.makeStuck=function(){this._isStuck=!0},t.prototype.update=function(t,i){if(!this._isDone){var n={x:this._goalPosition.x-this._position.x,y:this._goalPosition.y-this._position.y},o=Math.sqrt(Math.pow(n.x,2)+Math.pow(n.y,2));o>60*t/1e3?(this._direction.dx=n.x/o,this._direction.dy=n.y/o,this._position.x+=60*t/1e3*this._direction.dx,this._position.y+=60*t/1e3*this._direction.dy):(this._position.x=this._goalPosition.x,this._position.y=this._goalPosition.y,this._isDone=!0)}},t}(),s=function(){function t(t,i,n,o){this.Id=t,this._position=i,this._goalPosition=n,this.Radius=o,this._direction={dx:0,dy:0},this._isDone=!1,this._isStuck=!1}return t.prototype.getPosition=function(){return this._position},t.prototype.getDirection=function(){return this._direction},t.prototype.getIsDone=function(){return this._isDone},t.prototype.getIsStuck=function(){return this._isStuck},t.prototype.makeStuck=function(){this._isStuck=!0},t.prototype.update=function(t,i){var n=this;if(!this._isDone){var o={x:this._goalPosition.x-this._position.x,y:this._goalPosition.y-this._position.y},e=Math.sqrt(Math.pow(o.x,2)+Math.pow(o.y,2));if(e>60*t/1e3){this._direction.dx=o.x/e,this._direction.dy=o.y/e;var r=this._position.x+20*this._direction.dx,s=this._position.y+20*this._direction.dy;this._isStuck=!1,i.forEach((function(t){t.Id!=n.Id&&n.collides(t,{x:r,y:s})&&(n._isStuck=!0)})),this._isStuck||(this._position.x+=60*t/1e3*this._direction.dx,this._position.y+=60*t/1e3*this._direction.dy)}else this._position.x=this._goalPosition.x,this._position.y=this._goalPosition.y,this._isDone=!0}},t.prototype.collides=function(t,i){var n=i.x,o=i.y,e=this.Radius,r=t.getPosition().x,s=t.getPosition().y,a=t.Radius;return Math.sqrt(Math.pow(n-r,2)+Math.pow(o-s,2))<e+a},t}(),a=function(){function t(){}return t.RandomToRandom=function(t,i,n,o){for(var e=[],r=0;r<t;r++){var s=o(r,{x:i*Math.random(),y:n*Math.random()},{x:i*Math.random(),y:n*Math.random()},20);e.push(s)}return{agents:e}},t.RandomToLine=function(t,i,n,o){for(var e=[],r=0;r<t;r++){var s=o(r,{x:i*Math.random(),y:n*Math.random()},{x:(r+1)/(t+1)*i,y:n/2},20);e.push(s)}return{agents:e}},t.CircleToCircle=function(t,i,n,o){for(var e=[],r=i/2,s=n/2,a=n/2-25,h=0;h<t;h++){var c=2*Math.PI*h/t,u=o(h,{x:r+a*Math.cos(c),y:s+a*Math.sin(c)},{x:r+a*Math.cos(c+Math.PI),y:s+a*Math.sin(c+Math.PI)},20);e.push(u)}return{agents:e}},t}(),h=function(){function t(){}return t.prototype.init=function(t){this._root=this.construct(t,!0)},t.prototype.getAll=function(){return this.get(this._root)},t.prototype.getNeighboursInRangeRectilinear=function(t,i){var n=t.getPosition().x-i,o=t.getPosition().y-i,e=t.getPosition().x+i,r=t.getPosition().y+i;return this.rectilinear(this._root,n,o,e,r,!0).filter((function(i){return i.Id!==t.Id}))},t.prototype.rectilinear=function(t,i,n,o,e,r){if(null==t)return[];var s=[];return r?(t.agent.getPosition().x<=o&&(s=s.concat(this.rectilinear(t.left,i,n,o,e,!r))),t.agent.getPosition().x>=i&&(s=s.concat(this.rectilinear(t.right,i,n,o,e,!r)))):(t.agent.getPosition().y<=e&&(s=s.concat(this.rectilinear(t.left,i,n,o,e,!r))),t.agent.getPosition().y>=n&&(s=s.concat(this.rectilinear(t.right,i,n,o,e,!r)))),t.agent.getPosition().x>=i&&t.agent.getPosition().y>=n&&t.agent.getPosition().x<=o&&t.agent.getPosition().y<=e&&(s=s.concat(t.agent)),s},t.prototype.getNeighboursInRangeEuclidean=function(t,i){return this.getNeighboursInRangeRectilinear(t,i).filter((function(n){return n.Id!==t.Id&&Math.pow(t.getPosition().x-n.getPosition().x,2)+Math.pow(t.getPosition().y-n.getPosition().y,2)<=Math.pow(i,2)}))},t.prototype.forEach=function(t){this.apply(this._root,t)},t.prototype.construct=function(t,i){if(0===t.length)return null;var n=Math.floor(t.length/2),o=i?t.sort((function(t,i){return t.getPosition().x-i.getPosition().x})):t.sort((function(t,i){return t.getPosition().y-i.getPosition().y})),e=this.construct(o.slice(0,n),!i),r=this.construct(o.slice(n+1,t.length),!i);return{agent:t[n],left:e,right:r}},t.prototype.insert=function(t,i,n){return null==i?{agent:t,left:null,right:null}:(n?t.getPosition().x<i.agent.getPosition().x?i.left=this.insert(t,i.left,!n):i.right=this.insert(t,i.right,!n):t.getPosition().y<i.agent.getPosition().y?i.left=this.insert(t,i.left,!n):i.right=this.insert(t,i.right,!n),i)},t.prototype.get=function(t){return null==t?[]:this.get(t.left).concat(this.get(t.right)).concat(t.agent)},t.prototype.apply=function(t,i){null!=t&&(i(t.agent),this.apply(t.left,i),this.apply(t.right,i))},t}(),c=document.getElementById("config"),u=document.getElementById("agentType"),g=document.getElementById("numberOfAgents"),d=document.getElementById("canvas"),p=document.getElementById("framerate"),l=document.getElementById("playButton"),y=document.getElementById("stepButton"),f=new o(new e(d),new h),_=!1;function x(){this.reconfigure();var t=0,i=0,n=0;window.requestAnimationFrame((function o(e){var r=e-t;t=e,_&&f.update(r),f.draw(),n++,e-i>=250&&(p.textContent="FPS: "+(1e3*n/(e-i)).toFixed(1),n=0,i=e),window.requestAnimationFrame(o)}))}function P(){(_=!_)?(l.textContent="Pause",y.disabled=!0):(l.textContent="Play",y.disabled=!1)}function m(){f.update(1e3/60)}function v(){var t;_&&this.playPause();var i,n=c.value,o=u.value,e=null!==(t=parseInt(g.value))&&void 0!==t?t:0;switch(o){case"BasicAgent":i=function(t,i,n,o){return new r(t,i,n,o)};break;case"StopAgent":i=function(t,i,n,o){return new s(t,i,n,o)};break;default:throw new Error("Agent not implemented")}switch(n){case"RandomToRandom":f.init(a.RandomToRandom(e,d.width,d.height,i));break;case"RandomToLine":f.init(a.RandomToLine(e,d.width,d.height,i));break;case"CircleToCircle":f.init(a.CircleToCircle(e,d.width,d.height,i));break;default:throw new Error("Configuration not implemented")}}}},i={};function n(o){if(i[o])return i[o].exports;var e=i[o]={exports:{}};return t[o](e,e.exports,n),e.exports}return n.d=(t,i)=>{for(var o in i)n.o(i,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:i[o]})},n.o=(t,i)=>Object.prototype.hasOwnProperty.call(t,i),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n(389)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9Dcm93ZFNpbXVsYXRvci8uL3NyYy9TaW11bGF0aW9uLnRzIiwid2VicGFjazovL0Nyb3dkU2ltdWxhdG9yLy4vc3JjL1JlbmRlcmVyMkQudHMiLCJ3ZWJwYWNrOi8vQ3Jvd2RTaW11bGF0b3IvLi9zcmMvQmFzaWNBZ2VudC50cyIsIndlYnBhY2s6Ly9Dcm93ZFNpbXVsYXRvci8uL3NyYy9TdG9wQWdlbnQudHMiLCJ3ZWJwYWNrOi8vQ3Jvd2RTaW11bGF0b3IvLi9zcmMvQ29uZmlndXJhdGlvbnMudHMiLCJ3ZWJwYWNrOi8vQ3Jvd2RTaW11bGF0b3IvLi9zcmMvQWdlbnRUcmVlLnRzIiwid2VicGFjazovL0Nyb3dkU2ltdWxhdG9yLy4vc3JjL21haW4udHMiLCJ3ZWJwYWNrOi8vQ3Jvd2RTaW11bGF0b3Ivd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vQ3Jvd2RTaW11bGF0b3Ivd2VicGFjay9zdGFydHVwIiwid2VicGFjazovL0Nyb3dkU2ltdWxhdG9yL3dlYnBhY2svcnVudGltZS9kZWZpbmUgcHJvcGVydHkgZ2V0dGVycyIsIndlYnBhY2s6Ly9Dcm93ZFNpbXVsYXRvci93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovL0Nyb3dkU2ltdWxhdG9yL3dlYnBhY2svcnVudGltZS9tYWtlIG5hbWVzcGFjZSBvYmplY3QiXSwibmFtZXMiOlsicmVuZGVyZXIiLCJhZ2VudHMiLCJ0aGlzIiwiX3JlbmRlcmVyIiwiX2FnZW50cyIsImluaXQiLCJjb25maWciLCJ1cGRhdGUiLCJkZWx0YVQiLCJmb3JFYWNoIiwiYWdlbnQiLCJJZCIsIm5laWdoYm91cnMiLCJnZXROZWlnaGJvdXJzSW5SYW5nZVJlY3RpbGluZWFyIiwiYSIsIm1ha2VTdHVjayIsImNvbnNvbGUiLCJsb2ciLCJsZW5ndGgiLCJnZXRBbGwiLCJkcmF3IiwiY2xlYXIiLCJkcmF3QWdlbnQiLCJjYW52YXMiLCJfY29udGV4dCIsImdldENvbnRleHQiLCJmaWxsU3R5bGUiLCJmaWxsUmVjdCIsIndpZHRoIiwiaGVpZ2h0IiwicG9zaXRpb24iLCJnZXRQb3NpdGlvbiIsImRpcmVjdGlvbiIsImdldERpcmVjdGlvbiIsImJlZ2luUGF0aCIsImdldElzRG9uZSIsInN0cm9rZVN0eWxlIiwiZ2V0SXNTdHVjayIsImFyYyIsIngiLCJ5IiwiUmFkaXVzIiwiTWF0aCIsIlBJIiwiZHgiLCJkeSIsIm1hZ25pdHVkZSIsInNxcnQiLCJtb3ZlVG8iLCJsaW5lVG8iLCJzdHJva2UiLCJpZCIsInN0YXJ0UG9zaXRpb24iLCJnb2FsUG9zaXRpb24iLCJyYWRpdXMiLCJfcG9zaXRpb24iLCJfZ29hbFBvc2l0aW9uIiwiX2RpcmVjdGlvbiIsIl9pc0RvbmUiLCJfaXNTdHVjayIsImdvYWxEaXJlY3Rpb24iLCJnb2FsRGlzdGFuY2UiLCJjb2xsaWRlcyIsImExeCIsImExeSIsImExciIsImEyeCIsImEyeSIsImEyciIsIlJhbmRvbVRvUmFuZG9tIiwibiIsImFnZW50Q29uc3RydWN0b3IiLCJpIiwicmFuZG9tIiwicHVzaCIsIlJhbmRvbVRvTGluZSIsIkNpcmNsZVRvQ2lyY2xlIiwiY2VudHJlWCIsImNlbnRyZVkiLCJhbmdsZSIsImNvcyIsInNpbiIsIl9yb290IiwiY29uc3RydWN0IiwiZ2V0IiwicmFuZ2UiLCJtaW5YIiwibWluWSIsIm1heFgiLCJtYXhZIiwicmVjdGlsaW5lYXIiLCJmaWx0ZXIiLCJvdGhlciIsInJvb3QiLCJ4QXhpcyIsInJlcyIsImNvbmNhdCIsImxlZnQiLCJyaWdodCIsImdldE5laWdoYm91cnNJblJhbmdlRXVjbGlkZWFuIiwiZnVuIiwiYXBwbHkiLCJtaWQiLCJmbG9vciIsInNvcnRlZCIsInNvcnQiLCJiIiwic2xpY2UiLCJpbnNlcnQiLCJjb25maWdTZWxlY3QiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiYWdlbnRUeXBlU2VsZWN0IiwibnVtYmVyT2ZBZ2VudHNJbnB1dCIsImZyYW1lcmF0ZSIsInBsYXlCdXR0b24iLCJzdGVwQnV0dG9uIiwic2ltdWxhdGlvbiIsIlNpbXVsYXRpb24iLCJSZW5kZXJlcjJEIiwiQWdlbnRUcmVlIiwicGxheSIsInJlY29uZmlndXJlIiwibGFzdFJlbmRlciIsImxhc3RGUFMiLCJmcmFtZXMiLCJ3aW5kb3ciLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJsb29wIiwidGltZXN0YW1wIiwidGV4dENvbnRlbnQiLCJ0b0ZpeGVkIiwicGxheVBhdXNlIiwiZGlzYWJsZWQiLCJzdGVwIiwidmFsdWUiLCJhZ2VudFR5cGUiLCJwYXJzZUludCIsIkJhc2ljQWdlbnQiLCJTdG9wQWdlbnQiLCJFcnJvciIsIkNvbmZpZ3VyYXRpb25zIiwiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsIl9fd2VicGFja19tb2R1bGVzX18iLCJkIiwiZGVmaW5pdGlvbiIsImtleSIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJvYmoiLCJwcm9wIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIl0sIm1hcHBpbmdzIjoia0pBSUEsaUJBSUUsV0FBWUEsRUFBcUJDLEdBQy9CQyxLQUFLQyxVQUFZSCxFQUNqQkUsS0FBS0UsUUFBVUgsRUFtQ25CLE9BaENFLFlBQUFJLEtBQUEsU0FBS0MsR0FDSEosS0FBS0UsUUFBUUMsS0FBS0MsRUFBT0wsU0FHM0IsWUFBQU0sT0FBQSxTQUFPQyxHQUFQLFdBRUVOLEtBQUtFLFFBQVFLLFNBQVEsU0FBQ0MsR0FDcEIsR0FBZ0IsR0FBWkEsRUFBTUMsR0FBUyxDQUNqQixJQUFJQyxFQUFhLEVBQUtSLFFBQVFTLGdDQUM1QkgsRUFKTSxLQU9SRSxFQUFXSCxTQUFRLFNBQUNLLEdBQ2xCQSxFQUFFQyxlQUVKQyxRQUFRQyxJQUFJTCxFQUFXTSxRQUd6QlIsRUFBTUgsT0FDSkMsRUFDQSxF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b24gfSBmcm9tIFwiLi9JQWdlbnRDb2xsZWN0aW9uXCI7XHJcbmltcG9ydCB7IElSZW5kZXJlciB9IGZyb20gXCIuL0lSZW5kZXJlclwiO1xyXG5pbXBvcnQgeyBJQ29uZmlndXJhdGlvbiB9IGZyb20gXCIuL0NvbmZpZ3VyYXRpb25zXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgU2ltdWxhdGlvbiB7XHJcbiAgX3JlbmRlcmVyOiBJUmVuZGVyZXI7XHJcbiAgX2FnZW50czogSUFnZW50Q29sbGVjdGlvbjtcclxuXHJcbiAgY29uc3RydWN0b3IocmVuZGVyZXI6IElSZW5kZXJlciwgYWdlbnRzOiBJQWdlbnRDb2xsZWN0aW9uKSB7XHJcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgdGhpcy5fYWdlbnRzID0gYWdlbnRzO1xyXG4gIH1cclxuXHJcbiAgaW5pdChjb25maWc6IElDb25maWd1cmF0aW9uKSB7XHJcbiAgICB0aGlzLl9hZ2VudHMuaW5pdChjb25maWcuYWdlbnRzKTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZShkZWx0YVQ6IG51bWJlcikge1xyXG4gICAgbGV0IHJhbmdlID0gMjAwO1xyXG4gICAgdGhpcy5fYWdlbnRzLmZvckVhY2goKGFnZW50KSA9PiB7XHJcbiAgICAgIGlmIChhZ2VudC5JZCA9PSAwKSB7XHJcbiAgICAgICAgbGV0IG5laWdoYm91cnMgPSB0aGlzLl9hZ2VudHMuZ2V0TmVpZ2hib3Vyc0luUmFuZ2VSZWN0aWxpbmVhcihcclxuICAgICAgICAgIGFnZW50LFxyXG4gICAgICAgICAgcmFuZ2VcclxuICAgICAgICApO1xyXG4gICAgICAgIG5laWdoYm91cnMuZm9yRWFjaCgoYSkgPT4ge1xyXG4gICAgICAgICAgYS5tYWtlU3R1Y2soKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBjb25zb2xlLmxvZyhuZWlnaGJvdXJzLmxlbmd0aCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGFnZW50LnVwZGF0ZShcclxuICAgICAgICBkZWx0YVQsXHJcbiAgICAgICAgdGhpcy5fYWdlbnRzLmdldE5laWdoYm91cnNJblJhbmdlUmVjdGlsaW5lYXIoYWdlbnQsIHJhbmdlKVxyXG4gICAgICApO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLl9hZ2VudHMuaW5pdCh0aGlzLl9hZ2VudHMuZ2V0QWxsKCkpO1xyXG4gIH1cclxuXHJcbiAgZHJhdygpIHtcclxuICAgIHRoaXMuX3JlbmRlcmVyLmNsZWFyKCk7XHJcbiAgICB0aGlzLl9hZ2VudHMuZm9yRWFjaCgoYWdlbnQpID0+IHtcclxuICAgICAgdGhpcy5fcmVuZGVyZXIuZHJhd0FnZW50KGFnZW50KTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgeyBJQWdlbnQgfSBmcm9tIFwiLi9JQWdlbnRcIjtcclxuaW1wb3J0IHsgSVJlbmRlcmVyIH0gZnJvbSBcIi4vSVJlbmRlcmVyXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgUmVuZGVyZXIyRCBpbXBsZW1lbnRzIElSZW5kZXJlciB7XHJcbiAgX2NvbnRleHQ6IENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRDtcclxuXHJcbiAgY29uc3RydWN0b3IoY2FudmFzOiBIVE1MQ2FudmFzRWxlbWVudCkge1xyXG4gICAgdGhpcy5fY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XHJcbiAgfVxyXG5cclxuICBjbGVhcigpOiB2b2lkIHtcclxuICAgIHRoaXMuX2NvbnRleHQuZmlsbFN0eWxlID0gXCJ3aGl0ZVwiO1xyXG4gICAgdGhpcy5fY29udGV4dC5maWxsUmVjdChcclxuICAgICAgMCxcclxuICAgICAgMCxcclxuICAgICAgdGhpcy5fY29udGV4dC5jYW52YXMud2lkdGgsXHJcbiAgICAgIHRoaXMuX2NvbnRleHQuY2FudmFzLmhlaWdodFxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIGRyYXdBZ2VudChhZ2VudDogSUFnZW50KSB7XHJcbiAgICBsZXQgcG9zaXRpb24gPSBhZ2VudC5nZXRQb3NpdGlvbigpO1xyXG4gICAgbGV0IGRpcmVjdGlvbiA9IGFnZW50LmdldERpcmVjdGlvbigpO1xyXG5cclxuICAgIHRoaXMuX2NvbnRleHQuYmVnaW5QYXRoKCk7XHJcblxyXG4gICAgLy8gZHJhdyBhZ2VudFxyXG4gICAgaWYgKGFnZW50LmdldElzRG9uZSgpKSB7XHJcbiAgICAgIHRoaXMuX2NvbnRleHQuc3Ryb2tlU3R5bGUgPSBcIiMwMEZGMDBcIjtcclxuICAgIH0gZWxzZSBpZiAoYWdlbnQuZ2V0SXNTdHVjaygpKSB7XHJcbiAgICAgIHRoaXMuX2NvbnRleHQuc3Ryb2tlU3R5bGUgPSBcIiNGRjAwMDBcIjtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2NvbnRleHQuc3Ryb2tlU3R5bGUgPSBcIiMwMDAwMDBcIjtcclxuICAgIH1cclxuXHJcbiAgICAvLyBkZWJ1Z1xyXG4gICAgaWYgKGFnZW50LklkID09IDApIHtcclxuICAgICAgdGhpcy5fY29udGV4dC5zdHJva2VTdHlsZSA9IFwiI0ZGMDBGRlwiO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuX2NvbnRleHQuYXJjKHBvc2l0aW9uLngsIHBvc2l0aW9uLnksIGFnZW50LlJhZGl1cywgMCwgMiAqIE1hdGguUEkpO1xyXG5cclxuICAgIC8vIGRyYXcgZGlyZWN0aW9uXHJcbiAgICBpZiAoZGlyZWN0aW9uLmR4ICE9PSAwIHx8IGRpcmVjdGlvbi5keSAhPT0gMCkge1xyXG4gICAgICBsZXQgbWFnbml0dWRlID0gTWF0aC5zcXJ0KGRpcmVjdGlvbi5keCAqKiAyICsgZGlyZWN0aW9uLmR5ICoqIDIpO1xyXG5cclxuICAgICAgdGhpcy5fY29udGV4dC5tb3ZlVG8ocG9zaXRpb24ueCwgcG9zaXRpb24ueSk7XHJcbiAgICAgIHRoaXMuX2NvbnRleHQubGluZVRvKFxyXG4gICAgICAgIHBvc2l0aW9uLnggKyAoYWdlbnQuUmFkaXVzICogZGlyZWN0aW9uLmR4KSAvIG1hZ25pdHVkZSxcclxuICAgICAgICBwb3NpdGlvbi55ICsgKGFnZW50LlJhZGl1cyAqIGRpcmVjdGlvbi5keSkgLyBtYWduaXR1ZGVcclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLl9jb250ZXh0LnN0cm9rZSgpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgeyBJQWdlbnQgfSBmcm9tIFwiLi9JQWdlbnRcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBCYXNpY0FnZW50IGltcGxlbWVudHMgSUFnZW50IHtcclxuICBwdWJsaWMgcmVhZG9ubHkgSWQ6IG51bWJlcjtcclxuICBwdWJsaWMgcmVhZG9ubHkgUmFkaXVzOiBudW1iZXI7XHJcblxyXG4gIHByaXZhdGUgX3Bvc2l0aW9uOiB7IHg6IG51bWJlcjsgeTogbnVtYmVyIH07XHJcbiAgcHJpdmF0ZSBfZ29hbFBvc2l0aW9uOiB7IHg6IG51bWJlcjsgeTogbnVtYmVyIH07XHJcbiAgcHJpdmF0ZSBfZGlyZWN0aW9uOiB7IGR4OiBudW1iZXI7IGR5OiBudW1iZXIgfTtcclxuICBwcml2YXRlIF9pc0RvbmU6IGJvb2xlYW47XHJcbiAgcHJpdmF0ZSBfaXNTdHVjazogYm9vbGVhbjtcclxuXHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBpZDogbnVtYmVyLFxyXG4gICAgc3RhcnRQb3NpdGlvbjogeyB4OiBudW1iZXI7IHk6IG51bWJlciB9LFxyXG4gICAgZ29hbFBvc2l0aW9uOiB7IHg6IG51bWJlcjsgeTogbnVtYmVyIH0sXHJcbiAgICByYWRpdXM6IG51bWJlclxyXG4gICkge1xyXG4gICAgdGhpcy5JZCA9IGlkO1xyXG4gICAgdGhpcy5fcG9zaXRpb24gPSBzdGFydFBvc2l0aW9uO1xyXG4gICAgdGhpcy5fZ29hbFBvc2l0aW9uID0gZ29hbFBvc2l0aW9uO1xyXG4gICAgdGhpcy5SYWRpdXMgPSByYWRpdXM7XHJcblxyXG4gICAgdGhpcy5fZGlyZWN0aW9uID0geyBkeDogMCwgZHk6IDAgfTtcclxuICAgIHRoaXMuX2lzRG9uZSA9IGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgZ2V0UG9zaXRpb24oKTogeyB4OiBudW1iZXI7IHk6IG51bWJlciB9IHtcclxuICAgIHJldHVybiB0aGlzLl9wb3NpdGlvbjtcclxuICB9XHJcblxyXG4gIGdldERpcmVjdGlvbigpOiB7IGR4OiBudW1iZXI7IGR5OiBudW1iZXIgfSB7XHJcbiAgICByZXR1cm4gdGhpcy5fZGlyZWN0aW9uO1xyXG4gIH1cclxuXHJcbiAgZ2V0SXNEb25lKCk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIHRoaXMuX2lzRG9uZTtcclxuICB9XHJcblxyXG4gIGdldElzU3R1Y2soKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gdGhpcy5faXNTdHVjaztcclxuICB9XHJcblxyXG4gIG1ha2VTdHVjaygpIHtcclxuICAgIHRoaXMuX2lzU3R1Y2sgPSB0cnVlO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlKGRlbHRhVDogbnVtYmVyLCBfYWdlbnRzOiBJQWdlbnRbXSk6IHZvaWQge1xyXG4gICAgaWYgKHRoaXMuX2lzRG9uZSkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgbGV0IGdvYWxEaXJlY3Rpb24gPSB7XHJcbiAgICAgIHg6IHRoaXMuX2dvYWxQb3NpdGlvbi54IC0gdGhpcy5fcG9zaXRpb24ueCxcclxuICAgICAgeTogdGhpcy5fZ29hbFBvc2l0aW9uLnkgLSB0aGlzLl9wb3NpdGlvbi55LFxyXG4gICAgfTtcclxuICAgIGxldCBnb2FsRGlzdGFuY2UgPSBNYXRoLnNxcnQoZ29hbERpcmVjdGlvbi54ICoqIDIgKyBnb2FsRGlyZWN0aW9uLnkgKiogMik7XHJcblxyXG4gICAgaWYgKGdvYWxEaXN0YW5jZSA+IChkZWx0YVQgKiA2MCkgLyAxMDAwKSB7XHJcbiAgICAgIHRoaXMuX2RpcmVjdGlvbi5keCA9IGdvYWxEaXJlY3Rpb24ueCAvIGdvYWxEaXN0YW5jZTtcclxuICAgICAgdGhpcy5fZGlyZWN0aW9uLmR5ID0gZ29hbERpcmVjdGlvbi55IC8gZ29hbERpc3RhbmNlO1xyXG4gICAgICB0aGlzLl9wb3NpdGlvbi54ICs9ICgoZGVsdGFUICogNjApIC8gMTAwMCkgKiB0aGlzLl9kaXJlY3Rpb24uZHg7XHJcbiAgICAgIHRoaXMuX3Bvc2l0aW9uLnkgKz0gKChkZWx0YVQgKiA2MCkgLyAxMDAwKSAqIHRoaXMuX2RpcmVjdGlvbi5keTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX3Bvc2l0aW9uLnggPSB0aGlzLl9nb2FsUG9zaXRpb24ueDtcclxuICAgICAgdGhpcy5fcG9zaXRpb24ueSA9IHRoaXMuX2dvYWxQb3NpdGlvbi55O1xyXG4gICAgICB0aGlzLl9pc0RvbmUgPSB0cnVlO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgeyBJQWdlbnQgfSBmcm9tIFwiLi9JQWdlbnRcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBTdG9wQWdlbnQgaW1wbGVtZW50cyBJQWdlbnQge1xyXG4gIHB1YmxpYyByZWFkb25seSBJZDogbnVtYmVyO1xyXG4gIHB1YmxpYyByZWFkb25seSBSYWRpdXM6IG51bWJlcjtcclxuXHJcbiAgcHJpdmF0ZSBfcG9zaXRpb246IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfTtcclxuICBwcml2YXRlIF9nb2FsUG9zaXRpb246IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfTtcclxuICBwcml2YXRlIF9kaXJlY3Rpb246IHsgZHg6IG51bWJlcjsgZHk6IG51bWJlciB9O1xyXG4gIHByaXZhdGUgX2lzRG9uZTogYm9vbGVhbjtcclxuICBwcml2YXRlIF9pc1N0dWNrOiBib29sZWFuO1xyXG5cclxuICBjb25zdHJ1Y3RvcihcclxuICAgIGlkOiBudW1iZXIsXHJcbiAgICBzdGFydFBvc2l0aW9uOiB7IHg6IG51bWJlcjsgeTogbnVtYmVyIH0sXHJcbiAgICBnb2FsUG9zaXRpb246IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfSxcclxuICAgIHJhZGl1czogbnVtYmVyXHJcbiAgKSB7XHJcbiAgICB0aGlzLklkID0gaWQ7XHJcbiAgICB0aGlzLl9wb3NpdGlvbiA9IHN0YXJ0UG9zaXRpb247XHJcbiAgICB0aGlzLl9nb2FsUG9zaXRpb24gPSBnb2FsUG9zaXRpb247XHJcbiAgICB0aGlzLlJhZGl1cyA9IHJhZGl1cztcclxuXHJcbiAgICB0aGlzLl9kaXJlY3Rpb24gPSB7IGR4OiAwLCBkeTogMCB9O1xyXG4gICAgdGhpcy5faXNEb25lID0gZmFsc2U7XHJcbiAgICB0aGlzLl9pc1N0dWNrID0gZmFsc2U7XHJcbiAgfVxyXG5cclxuICBnZXRQb3NpdGlvbigpOiB7IHg6IG51bWJlcjsgeTogbnVtYmVyIH0ge1xyXG4gICAgcmV0dXJuIHRoaXMuX3Bvc2l0aW9uO1xyXG4gIH1cclxuXHJcbiAgZ2V0RGlyZWN0aW9uKCk6IHsgZHg6IG51bWJlcjsgZHk6IG51bWJlciB9IHtcclxuICAgIHJldHVybiB0aGlzLl9kaXJlY3Rpb247XHJcbiAgfVxyXG5cclxuICBnZXRJc0RvbmUoKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gdGhpcy5faXNEb25lO1xyXG4gIH1cclxuXHJcbiAgZ2V0SXNTdHVjaygpOiBib29sZWFuIHtcclxuICAgIHJldHVybiB0aGlzLl9pc1N0dWNrO1xyXG4gIH1cclxuXHJcbiAgbWFrZVN0dWNrKCkge1xyXG4gICAgdGhpcy5faXNTdHVjayA9IHRydWU7XHJcbiAgfVxyXG5cclxuICB1cGRhdGUoZGVsdGFUOiBudW1iZXIsIGFnZW50czogSUFnZW50W10pOiB2b2lkIHtcclxuICAgIGlmICh0aGlzLl9pc0RvbmUpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIGxldCBnb2FsRGlyZWN0aW9uID0ge1xyXG4gICAgICB4OiB0aGlzLl9nb2FsUG9zaXRpb24ueCAtIHRoaXMuX3Bvc2l0aW9uLngsXHJcbiAgICAgIHk6IHRoaXMuX2dvYWxQb3NpdGlvbi55IC0gdGhpcy5fcG9zaXRpb24ueSxcclxuICAgIH07XHJcbiAgICBsZXQgZ29hbERpc3RhbmNlID0gTWF0aC5zcXJ0KGdvYWxEaXJlY3Rpb24ueCAqKiAyICsgZ29hbERpcmVjdGlvbi55ICoqIDIpO1xyXG5cclxuICAgIGlmIChnb2FsRGlzdGFuY2UgPiAoZGVsdGFUICogNjApIC8gMTAwMCkge1xyXG4gICAgICB0aGlzLl9kaXJlY3Rpb24uZHggPSBnb2FsRGlyZWN0aW9uLnggLyBnb2FsRGlzdGFuY2U7XHJcbiAgICAgIHRoaXMuX2RpcmVjdGlvbi5keSA9IGdvYWxEaXJlY3Rpb24ueSAvIGdvYWxEaXN0YW5jZTtcclxuICAgICAgbGV0IGhlYWRpbmdYID0gdGhpcy5fcG9zaXRpb24ueCArIDIwICogdGhpcy5fZGlyZWN0aW9uLmR4O1xyXG4gICAgICBsZXQgaGVhZGluZ1kgPSB0aGlzLl9wb3NpdGlvbi55ICsgMjAgKiB0aGlzLl9kaXJlY3Rpb24uZHk7XHJcblxyXG4gICAgICB0aGlzLl9pc1N0dWNrID0gZmFsc2U7XHJcbiAgICAgIGFnZW50cy5mb3JFYWNoKChhZ2VudCkgPT4ge1xyXG4gICAgICAgIGlmIChcclxuICAgICAgICAgIGFnZW50LklkICE9IHRoaXMuSWQgJiZcclxuICAgICAgICAgIHRoaXMuY29sbGlkZXMoYWdlbnQsIHsgeDogaGVhZGluZ1gsIHk6IGhlYWRpbmdZIH0pXHJcbiAgICAgICAgKSB7XHJcbiAgICAgICAgICB0aGlzLl9pc1N0dWNrID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgaWYgKCF0aGlzLl9pc1N0dWNrKSB7XHJcbiAgICAgICAgdGhpcy5fcG9zaXRpb24ueCArPSAoKGRlbHRhVCAqIDYwKSAvIDEwMDApICogdGhpcy5fZGlyZWN0aW9uLmR4O1xyXG4gICAgICAgIHRoaXMuX3Bvc2l0aW9uLnkgKz0gKChkZWx0YVQgKiA2MCkgLyAxMDAwKSAqIHRoaXMuX2RpcmVjdGlvbi5keTtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fcG9zaXRpb24ueCA9IHRoaXMuX2dvYWxQb3NpdGlvbi54O1xyXG4gICAgICB0aGlzLl9wb3NpdGlvbi55ID0gdGhpcy5fZ29hbFBvc2l0aW9uLnk7XHJcbiAgICAgIHRoaXMuX2lzRG9uZSA9IHRydWU7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBjb2xsaWRlcyhhZ2VudDogSUFnZW50LCBwb3NpdGlvbjogeyB4OiBudW1iZXI7IHk6IG51bWJlciB9KTogYm9vbGVhbiB7XHJcbiAgICBsZXQgYTF4ID0gcG9zaXRpb24ueDtcclxuICAgIGxldCBhMXkgPSBwb3NpdGlvbi55O1xyXG4gICAgbGV0IGExciA9IHRoaXMuUmFkaXVzO1xyXG4gICAgbGV0IGEyeCA9IGFnZW50LmdldFBvc2l0aW9uKCkueDtcclxuICAgIGxldCBhMnkgPSBhZ2VudC5nZXRQb3NpdGlvbigpLnk7XHJcbiAgICBsZXQgYTJyID0gYWdlbnQuUmFkaXVzO1xyXG5cclxuICAgIHJldHVybiBNYXRoLnNxcnQoKGExeCAtIGEyeCkgKiogMiArIChhMXkgLSBhMnkpICoqIDIpIDwgYTFyICsgYTJyO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgeyBJQWdlbnQgfSBmcm9tIFwiLi9JQWdlbnRcIjtcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSUNvbmZpZ3VyYXRpb24ge1xyXG4gIGFnZW50czogSUFnZW50W107XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBDb25maWd1cmF0aW9ucyB7XHJcbiAgc3RhdGljIFJhbmRvbVRvUmFuZG9tKFxyXG4gICAgbjogbnVtYmVyLFxyXG4gICAgd2lkdGg6IG51bWJlcixcclxuICAgIGhlaWdodDogbnVtYmVyLFxyXG4gICAgYWdlbnRDb25zdHJ1Y3RvcjogKFxyXG4gICAgICBpZDogbnVtYmVyLFxyXG4gICAgICBzdGFydFBvc2l0aW9uOiB7IHg6IG51bWJlcjsgeTogbnVtYmVyIH0sXHJcbiAgICAgIGdvYWxQb3NpdGlvbjogeyB4OiBudW1iZXI7IHk6IG51bWJlciB9LFxyXG4gICAgICByYWRpdXM6IG51bWJlclxyXG4gICAgKSA9PiBJQWdlbnRcclxuICApIHtcclxuICAgIC8vIFJhbmRvbSBzdGFydCBwb3NpdGlvbiB0byByYW5kb20gZ29hbCBwb3NpdGlvblxyXG4gICAgbGV0IGFnZW50czogSUFnZW50W10gPSBbXTtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbjsgaSsrKSB7XHJcbiAgICAgIGNvbnN0IGFnZW50ID0gYWdlbnRDb25zdHJ1Y3RvcihcclxuICAgICAgICBpLFxyXG4gICAgICAgIHsgeDogd2lkdGggKiBNYXRoLnJhbmRvbSgpLCB5OiBoZWlnaHQgKiBNYXRoLnJhbmRvbSgpIH0sXHJcbiAgICAgICAgeyB4OiB3aWR0aCAqIE1hdGgucmFuZG9tKCksIHk6IGhlaWdodCAqIE1hdGgucmFuZG9tKCkgfSxcclxuICAgICAgICAyMFxyXG4gICAgICApO1xyXG4gICAgICBhZ2VudHMucHVzaChhZ2VudCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHsgYWdlbnRzOiBhZ2VudHMgfSBhcyBJQ29uZmlndXJhdGlvbjtcclxuICB9XHJcblxyXG4gIHN0YXRpYyBSYW5kb21Ub0xpbmUoXHJcbiAgICBuOiBudW1iZXIsXHJcbiAgICB3aWR0aDogbnVtYmVyLFxyXG4gICAgaGVpZ2h0OiBudW1iZXIsXHJcbiAgICBhZ2VudENvbnN0cnVjdG9yOiAoXHJcbiAgICAgIGlkOiBudW1iZXIsXHJcbiAgICAgIHN0YXJ0UG9zaXRpb246IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfSxcclxuICAgICAgZ29hbFBvc2l0aW9uOiB7IHg6IG51bWJlcjsgeTogbnVtYmVyIH0sXHJcbiAgICAgIHJhZGl1czogbnVtYmVyXHJcbiAgICApID0+IElBZ2VudFxyXG4gICkge1xyXG4gICAgLy8gUmFuZG9tIHN0YXJ0IHBvc2l0aW9uIHRvIGZpeGVkIHBvc2l0aW9uIG9uIGxpbmVcclxuICAgIGxldCBhZ2VudHM6IElBZ2VudFtdID0gW107XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG47IGkrKykge1xyXG4gICAgICBjb25zdCBhZ2VudCA9IGFnZW50Q29uc3RydWN0b3IoXHJcbiAgICAgICAgaSxcclxuICAgICAgICB7IHg6IHdpZHRoICogTWF0aC5yYW5kb20oKSwgeTogaGVpZ2h0ICogTWF0aC5yYW5kb20oKSB9LFxyXG4gICAgICAgIHsgeDogKChpICsgMSkgLyAobiArIDEpKSAqIHdpZHRoLCB5OiBoZWlnaHQgLyAyIH0sXHJcbiAgICAgICAgMjBcclxuICAgICAgKTtcclxuICAgICAgYWdlbnRzLnB1c2goYWdlbnQpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7IGFnZW50czogYWdlbnRzIH0gYXMgSUNvbmZpZ3VyYXRpb247XHJcbiAgfVxyXG5cclxuICBzdGF0aWMgQ2lyY2xlVG9DaXJjbGUoXHJcbiAgICBuOiBudW1iZXIsXHJcbiAgICB3aWR0aDogbnVtYmVyLFxyXG4gICAgaGVpZ2h0OiBudW1iZXIsXHJcbiAgICBhZ2VudENvbnN0cnVjdG9yOiAoXHJcbiAgICAgIGlkOiBudW1iZXIsXHJcbiAgICAgIHN0YXJ0UG9zaXRpb246IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfSxcclxuICAgICAgZ29hbFBvc2l0aW9uOiB7IHg6IG51bWJlcjsgeTogbnVtYmVyIH0sXHJcbiAgICAgIHJhZGl1czogbnVtYmVyXHJcbiAgICApID0+IElBZ2VudFxyXG4gICkge1xyXG4gICAgLy8gUG9zaXRpb24gb24gcmFkaXVzIG9mIGNpcmNsZSB0byBvcHBvc2l0ZSBwb2ludFxyXG4gICAgbGV0IGFnZW50czogSUFnZW50W10gPSBbXTtcclxuICAgIGNvbnN0IGNlbnRyZVggPSB3aWR0aCAvIDI7XHJcbiAgICBjb25zdCBjZW50cmVZID0gaGVpZ2h0IC8gMjtcclxuICAgIGNvbnN0IHJhZGl1cyA9IGhlaWdodCAvIDIgLSAyNTtcclxuXHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG47IGkrKykge1xyXG4gICAgICBjb25zdCBhbmdsZSA9ICgyICogTWF0aC5QSSAqIGkpIC8gbjtcclxuICAgICAgY29uc3QgYWdlbnQgPSBhZ2VudENvbnN0cnVjdG9yKFxyXG4gICAgICAgIGksXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgeDogY2VudHJlWCArIHJhZGl1cyAqIE1hdGguY29zKGFuZ2xlKSxcclxuICAgICAgICAgIHk6IGNlbnRyZVkgKyByYWRpdXMgKiBNYXRoLnNpbihhbmdsZSksXHJcbiAgICAgICAgfSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICB4OiBjZW50cmVYICsgcmFkaXVzICogTWF0aC5jb3MoYW5nbGUgKyBNYXRoLlBJKSxcclxuICAgICAgICAgIHk6IGNlbnRyZVkgKyByYWRpdXMgKiBNYXRoLnNpbihhbmdsZSArIE1hdGguUEkpLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgMjBcclxuICAgICAgKTtcclxuICAgICAgYWdlbnRzLnB1c2goYWdlbnQpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7IGFnZW50czogYWdlbnRzIH0gYXMgSUNvbmZpZ3VyYXRpb247XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7IElBZ2VudENvbGxlY3Rpb24gfSBmcm9tIFwiLi9JQWdlbnRDb2xsZWN0aW9uXCI7XHJcbmltcG9ydCB7IElBZ2VudCB9IGZyb20gXCIuL0lBZ2VudFwiO1xyXG5cclxuaW50ZXJmYWNlIE5vZGUge1xyXG4gIGFnZW50OiBJQWdlbnQ7XHJcbiAgbGVmdDogTm9kZTtcclxuICByaWdodDogTm9kZTtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIEFnZW50VHJlZSBpbXBsZW1lbnRzIElBZ2VudENvbGxlY3Rpb24ge1xyXG4gIHByaXZhdGUgX3Jvb3Q6IE5vZGU7XHJcblxyXG4gIGluaXQoYWdlbnRzOiBJQWdlbnRbXSk6IHZvaWQge1xyXG4gICAgdGhpcy5fcm9vdCA9IHRoaXMuY29uc3RydWN0KGFnZW50cywgdHJ1ZSk7XHJcbiAgfVxyXG5cclxuICBnZXRBbGwoKTogSUFnZW50W10ge1xyXG4gICAgcmV0dXJuIHRoaXMuZ2V0KHRoaXMuX3Jvb3QpO1xyXG4gIH1cclxuXHJcbiAgZ2V0TmVpZ2hib3Vyc0luUmFuZ2VSZWN0aWxpbmVhcihhZ2VudDogSUFnZW50LCByYW5nZTogbnVtYmVyKTogSUFnZW50W10ge1xyXG4gICAgbGV0IG1pblggPSBhZ2VudC5nZXRQb3NpdGlvbigpLnggLSByYW5nZTtcclxuICAgIGxldCBtaW5ZID0gYWdlbnQuZ2V0UG9zaXRpb24oKS55IC0gcmFuZ2U7XHJcbiAgICBsZXQgbWF4WCA9IGFnZW50LmdldFBvc2l0aW9uKCkueCArIHJhbmdlO1xyXG4gICAgbGV0IG1heFkgPSBhZ2VudC5nZXRQb3NpdGlvbigpLnkgKyByYW5nZTtcclxuXHJcbiAgICBsZXQgY2FuZGlkYXRlcyA9IHRoaXMucmVjdGlsaW5lYXIodGhpcy5fcm9vdCwgbWluWCwgbWluWSwgbWF4WCwgbWF4WSwgdHJ1ZSk7XHJcbiAgICByZXR1cm4gY2FuZGlkYXRlcy5maWx0ZXIoKG90aGVyKSA9PiBvdGhlci5JZCAhPT0gYWdlbnQuSWQpO1xyXG4gIH1cclxuXHJcbiAgcmVjdGlsaW5lYXIoXHJcbiAgICByb290OiBOb2RlLFxyXG4gICAgbWluWDogbnVtYmVyLFxyXG4gICAgbWluWTogbnVtYmVyLFxyXG4gICAgbWF4WDogbnVtYmVyLFxyXG4gICAgbWF4WTogbnVtYmVyLFxyXG4gICAgeEF4aXM6IGJvb2xlYW5cclxuICApOiBJQWdlbnRbXSB7XHJcbiAgICBpZiAocm9vdCA9PSBudWxsKSB7XHJcbiAgICAgIHJldHVybiBbXTtcclxuICAgIH1cclxuXHJcbiAgICBsZXQgcmVzOiBJQWdlbnRbXSA9IFtdO1xyXG4gICAgaWYgKHhBeGlzKSB7XHJcbiAgICAgIC8vIElmIHggPD0gbWF4WCBuZWVkIHRvIGNoZWNrIGxlZnQgc3VidHJlZVxyXG4gICAgICBpZiAocm9vdC5hZ2VudC5nZXRQb3NpdGlvbigpLnggPD0gbWF4WCkge1xyXG4gICAgICAgIHJlcyA9IHJlcy5jb25jYXQoXHJcbiAgICAgICAgICB0aGlzLnJlY3RpbGluZWFyKHJvb3QubGVmdCwgbWluWCwgbWluWSwgbWF4WCwgbWF4WSwgIXhBeGlzKVxyXG4gICAgICAgICk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIElmIHggPj0gbWluWCBuZWVkIHRvIGNoZWNrIHJpZ2h0IHN1YnRyZWVcclxuICAgICAgaWYgKHJvb3QuYWdlbnQuZ2V0UG9zaXRpb24oKS54ID49IG1pblgpIHtcclxuICAgICAgICByZXMgPSByZXMuY29uY2F0KFxyXG4gICAgICAgICAgdGhpcy5yZWN0aWxpbmVhcihyb290LnJpZ2h0LCBtaW5YLCBtaW5ZLCBtYXhYLCBtYXhZLCAheEF4aXMpXHJcbiAgICAgICAgKTtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgLy8gSWYgeSA8PSBtYXhZIG5lZWQgdG8gY2hlY2sgbGVmdCBzdWJ0cmVlXHJcbiAgICAgIGlmIChyb290LmFnZW50LmdldFBvc2l0aW9uKCkueSA8PSBtYXhZKSB7XHJcbiAgICAgICAgcmVzID0gcmVzLmNvbmNhdChcclxuICAgICAgICAgIHRoaXMucmVjdGlsaW5lYXIocm9vdC5sZWZ0LCBtaW5YLCBtaW5ZLCBtYXhYLCBtYXhZLCAheEF4aXMpXHJcbiAgICAgICAgKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gSWYgeSA+PSBtaW5ZIG5lZWQgdG8gY2hlY2sgcmlnaHQgc3VidHJlZVxyXG4gICAgICBpZiAocm9vdC5hZ2VudC5nZXRQb3NpdGlvbigpLnkgPj0gbWluWSkge1xyXG4gICAgICAgIHJlcyA9IHJlcy5jb25jYXQoXHJcbiAgICAgICAgICB0aGlzLnJlY3RpbGluZWFyKHJvb3QucmlnaHQsIG1pblgsIG1pblksIG1heFgsIG1heFksICF4QXhpcylcclxuICAgICAgICApO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gSWYgdGhlIGFnZW50IGlzIGluIHJhbmdlIHJhbmdlIGFkZCB0byB0aGUgcmVzdWx0XHJcbiAgICBpZiAoXHJcbiAgICAgIHJvb3QuYWdlbnQuZ2V0UG9zaXRpb24oKS54ID49IG1pblggJiZcclxuICAgICAgcm9vdC5hZ2VudC5nZXRQb3NpdGlvbigpLnkgPj0gbWluWSAmJlxyXG4gICAgICByb290LmFnZW50LmdldFBvc2l0aW9uKCkueCA8PSBtYXhYICYmXHJcbiAgICAgIHJvb3QuYWdlbnQuZ2V0UG9zaXRpb24oKS55IDw9IG1heFlcclxuICAgICkge1xyXG4gICAgICByZXMgPSByZXMuY29uY2F0KHJvb3QuYWdlbnQpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiByZXM7XHJcbiAgfVxyXG5cclxuICBnZXROZWlnaGJvdXJzSW5SYW5nZUV1Y2xpZGVhbihhZ2VudDogSUFnZW50LCByYW5nZTogbnVtYmVyKTogSUFnZW50W10ge1xyXG4gICAgbGV0IGNhbmRpZGF0ZXMgPSB0aGlzLmdldE5laWdoYm91cnNJblJhbmdlUmVjdGlsaW5lYXIoYWdlbnQsIHJhbmdlKTtcclxuICAgIHJldHVybiBjYW5kaWRhdGVzLmZpbHRlcihcclxuICAgICAgKG90aGVyKSA9PlxyXG4gICAgICAgIG90aGVyLklkICE9PSBhZ2VudC5JZCAmJlxyXG4gICAgICAgIChhZ2VudC5nZXRQb3NpdGlvbigpLnggLSBvdGhlci5nZXRQb3NpdGlvbigpLngpICoqIDIgK1xyXG4gICAgICAgICAgKGFnZW50LmdldFBvc2l0aW9uKCkueSAtIG90aGVyLmdldFBvc2l0aW9uKCkueSkgKiogMiA8PVxyXG4gICAgICAgICAgcmFuZ2UgKiogMlxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIGZvckVhY2goZnVuOiAoYWdlbnQ6IElBZ2VudCkgPT4gdm9pZCk6IHZvaWQge1xyXG4gICAgdGhpcy5hcHBseSh0aGlzLl9yb290LCBmdW4pO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBjb25zdHJ1Y3QoYWdlbnRzOiBJQWdlbnRbXSwgeEF4aXM6IGJvb2xlYW4pOiBOb2RlIHtcclxuICAgIGlmIChhZ2VudHMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIGxldCBtaWQgPSBNYXRoLmZsb29yKGFnZW50cy5sZW5ndGggLyAyKTtcclxuXHJcbiAgICBsZXQgc29ydGVkID0geEF4aXNcclxuICAgICAgPyBhZ2VudHMuc29ydCgoYSwgYikgPT4gYS5nZXRQb3NpdGlvbigpLnggLSBiLmdldFBvc2l0aW9uKCkueClcclxuICAgICAgOiBhZ2VudHMuc29ydCgoYSwgYikgPT4gYS5nZXRQb3NpdGlvbigpLnkgLSBiLmdldFBvc2l0aW9uKCkueSk7XHJcblxyXG4gICAgbGV0IGxlZnQgPSB0aGlzLmNvbnN0cnVjdChzb3J0ZWQuc2xpY2UoMCwgbWlkKSwgIXhBeGlzKTtcclxuICAgIGxldCByaWdodCA9IHRoaXMuY29uc3RydWN0KHNvcnRlZC5zbGljZShtaWQgKyAxLCBhZ2VudHMubGVuZ3RoKSwgIXhBeGlzKTtcclxuXHJcbiAgICByZXR1cm4geyBhZ2VudDogYWdlbnRzW21pZF0sIGxlZnQ6IGxlZnQsIHJpZ2h0OiByaWdodCB9O1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBpbnNlcnQoYWdlbnQ6IElBZ2VudCwgcm9vdDogTm9kZSwgeEF4aXM6IGJvb2xlYW4pOiBOb2RlIHtcclxuICAgIGlmIChyb290ID09IG51bGwpIHtcclxuICAgICAgcmV0dXJuIHsgYWdlbnQ6IGFnZW50LCBsZWZ0OiBudWxsLCByaWdodDogbnVsbCB9O1xyXG4gICAgfVxyXG5cclxuICAgIGlmICh4QXhpcykge1xyXG4gICAgICBpZiAoYWdlbnQuZ2V0UG9zaXRpb24oKS54IDwgcm9vdC5hZ2VudC5nZXRQb3NpdGlvbigpLngpIHtcclxuICAgICAgICByb290LmxlZnQgPSB0aGlzLmluc2VydChhZ2VudCwgcm9vdC5sZWZ0LCAheEF4aXMpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJvb3QucmlnaHQgPSB0aGlzLmluc2VydChhZ2VudCwgcm9vdC5yaWdodCwgIXhBeGlzKTtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgaWYgKGFnZW50LmdldFBvc2l0aW9uKCkueSA8IHJvb3QuYWdlbnQuZ2V0UG9zaXRpb24oKS55KSB7XHJcbiAgICAgICAgcm9vdC5sZWZ0ID0gdGhpcy5pbnNlcnQoYWdlbnQsIHJvb3QubGVmdCwgIXhBeGlzKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByb290LnJpZ2h0ID0gdGhpcy5pbnNlcnQoYWdlbnQsIHJvb3QucmlnaHQsICF4QXhpcyk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gcm9vdDtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2V0KHJvb3Q6IE5vZGUpOiBJQWdlbnRbXSB7XHJcbiAgICBpZiAocm9vdCA9PSBudWxsKSB7XHJcbiAgICAgIHJldHVybiBbXTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gdGhpcy5nZXQocm9vdC5sZWZ0KS5jb25jYXQodGhpcy5nZXQocm9vdC5yaWdodCkpLmNvbmNhdChyb290LmFnZW50KTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgYXBwbHkocm9vdDogTm9kZSwgZnVuOiAoYWdlbnQ6IElBZ2VudCkgPT4gdm9pZCk6IHZvaWQge1xyXG4gICAgaWYgKHJvb3QgPT0gbnVsbCkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgZnVuKHJvb3QuYWdlbnQpO1xyXG4gICAgdGhpcy5hcHBseShyb290LmxlZnQsIGZ1bik7XHJcbiAgICB0aGlzLmFwcGx5KHJvb3QucmlnaHQsIGZ1bik7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7IFNpbXVsYXRpb24gfSBmcm9tIFwiLi9TaW11bGF0aW9uXCI7XHJcbmltcG9ydCB7IFJlbmRlcmVyMkQgfSBmcm9tIFwiLi9SZW5kZXJlcjJEXCI7XHJcblxyXG5pbXBvcnQgeyBCYXNpY0FnZW50IH0gZnJvbSBcIi4vQmFzaWNBZ2VudFwiO1xyXG5pbXBvcnQgeyBTdG9wQWdlbnQgfSBmcm9tIFwiLi9TdG9wQWdlbnRcIjtcclxuaW1wb3J0IHsgQ29uZmlndXJhdGlvbnMgfSBmcm9tIFwiLi9Db25maWd1cmF0aW9uc1wiO1xyXG5pbXBvcnQgeyBBZ2VudExpc3QgfSBmcm9tIFwiLi9BZ2VudExpc3RcIjtcclxuaW1wb3J0IHsgQWdlbnRUcmVlIH0gZnJvbSBcIi4vQWdlbnRUcmVlXCI7XHJcblxyXG5jb25zdCBjb25maWdTZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNvbmZpZ1wiKSBhcyBIVE1MU2VsZWN0RWxlbWVudDtcclxuY29uc3QgYWdlbnRUeXBlU2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXHJcbiAgXCJhZ2VudFR5cGVcIlxyXG4pIGFzIEhUTUxTZWxlY3RFbGVtZW50O1xyXG5jb25zdCBudW1iZXJPZkFnZW50c0lucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXHJcbiAgXCJudW1iZXJPZkFnZW50c1wiXHJcbikgYXMgSFRNTElucHV0RWxlbWVudDtcclxuXHJcbmNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY2FudmFzXCIpIGFzIEhUTUxDYW52YXNFbGVtZW50O1xyXG5jb25zdCBmcmFtZXJhdGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImZyYW1lcmF0ZVwiKSBhcyBIVE1MUGFyYWdyYXBoRWxlbWVudDtcclxuY29uc3QgcGxheUJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicGxheUJ1dHRvblwiKSBhcyBIVE1MQnV0dG9uRWxlbWVudDtcclxuY29uc3Qgc3RlcEJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic3RlcEJ1dHRvblwiKSBhcyBIVE1MQnV0dG9uRWxlbWVudDtcclxuXHJcbmNvbnN0IHJlbmRlcmVyID0gbmV3IFJlbmRlcmVyMkQoY2FudmFzKTtcclxuY29uc3Qgc2ltdWxhdGlvbiA9IG5ldyBTaW11bGF0aW9uKHJlbmRlcmVyLCBuZXcgQWdlbnRUcmVlKCkpO1xyXG52YXIgcGxheSA9IGZhbHNlO1xyXG5cclxuLy8gaW5pdGlhbGlzZSBzaW11bGF0aW9uIGFuZCBiZWdpbiB1cGRhdGUvcmVuZGVyIGxvb3BcclxuZXhwb3J0IGZ1bmN0aW9uIGluaXQoKSB7XHJcbiAgdGhpcy5yZWNvbmZpZ3VyZSgpO1xyXG5cclxuICBsZXQgbGFzdFJlbmRlciA9IDA7XHJcbiAgbGV0IGxhc3RGUFMgPSAwO1xyXG4gIGxldCBmcmFtZXMgPSAwO1xyXG5cclxuICBmdW5jdGlvbiBsb29wKHRpbWVzdGFtcDogbnVtYmVyKSB7XHJcbiAgICBsZXQgZGVsdGFUID0gdGltZXN0YW1wIC0gbGFzdFJlbmRlcjtcclxuICAgIGxhc3RSZW5kZXIgPSB0aW1lc3RhbXA7XHJcblxyXG4gICAgLy8gdXBkYXRlXHJcbiAgICBpZiAocGxheSkge1xyXG4gICAgICBzaW11bGF0aW9uLnVwZGF0ZShkZWx0YVQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIHJlbmRlclxyXG4gICAgc2ltdWxhdGlvbi5kcmF3KCk7XHJcbiAgICBmcmFtZXMrKztcclxuXHJcbiAgICAvLyByZWNhbGN1bGF0ZSBmcmFtZXJhdGUgZXZlcnkgMjUwbXNcclxuICAgIGlmICh0aW1lc3RhbXAgLSBsYXN0RlBTID49IDI1MCkge1xyXG4gICAgICBmcmFtZXJhdGUudGV4dENvbnRlbnQgPSBgRlBTOiAkeyhcclxuICAgICAgICAoMTAwMCAqIGZyYW1lcykgL1xyXG4gICAgICAgICh0aW1lc3RhbXAgLSBsYXN0RlBTKVxyXG4gICAgICApLnRvRml4ZWQoMSl9YDtcclxuXHJcbiAgICAgIGZyYW1lcyA9IDA7XHJcbiAgICAgIGxhc3RGUFMgPSB0aW1lc3RhbXA7XHJcbiAgICB9XHJcblxyXG4gICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZShsb29wKTtcclxuICB9XHJcblxyXG4gIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUobG9vcCk7XHJcbn1cclxuXHJcbi8vIHRvZ2dsZSBwbGF5L3BhdXNlXHJcbmV4cG9ydCBmdW5jdGlvbiBwbGF5UGF1c2UoKSB7XHJcbiAgcGxheSA9ICFwbGF5O1xyXG5cclxuICBpZiAocGxheSkge1xyXG4gICAgcGxheUJ1dHRvbi50ZXh0Q29udGVudCA9IFwiUGF1c2VcIjtcclxuICAgIHN0ZXBCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBwbGF5QnV0dG9uLnRleHRDb250ZW50ID0gXCJQbGF5XCI7XHJcbiAgICBzdGVwQnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgfVxyXG59XHJcblxyXG4vLyBzdGVwIHNpbXVsYXRpb24gYnkgMSBmcmFtZVxyXG5leHBvcnQgZnVuY3Rpb24gc3RlcCgpIHtcclxuICBzaW11bGF0aW9uLnVwZGF0ZSgxMDAwIC8gNjApOyAvLyBBc3N1bWVzIDYwRlBTXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiByZWNvbmZpZ3VyZSgpIHtcclxuICBpZiAocGxheSkge1xyXG4gICAgdGhpcy5wbGF5UGF1c2UoKTtcclxuICB9XHJcblxyXG4gIGNvbnN0IGNvbmZpZyA9IGNvbmZpZ1NlbGVjdC52YWx1ZTtcclxuICBjb25zdCBhZ2VudFR5cGUgPSBhZ2VudFR5cGVTZWxlY3QudmFsdWU7IC8vIFRPRE86IHdpcmUgdGhpcyBpblxyXG4gIGNvbnN0IG4gPSBwYXJzZUludChudW1iZXJPZkFnZW50c0lucHV0LnZhbHVlKSA/PyAwO1xyXG5cclxuICAvLyBTZWxlY3QgYWdlbnQgY29uc3RydWN0b3JcclxuICBsZXQgYWdlbnRDb25zdHJ1Y3RvcjtcclxuICBzd2l0Y2ggKGFnZW50VHlwZSkge1xyXG4gICAgY2FzZSBcIkJhc2ljQWdlbnRcIjpcclxuICAgICAgYWdlbnRDb25zdHJ1Y3RvciA9IChcclxuICAgICAgICBpZDogbnVtYmVyLFxyXG4gICAgICAgIHBvc2l0aW9uOiB7IHg6IG51bWJlcjsgeTogbnVtYmVyIH0sXHJcbiAgICAgICAgZ29hbFBvc2l0aW9uOiB7IHg6IG51bWJlcjsgeTogbnVtYmVyIH0sXHJcbiAgICAgICAgcmFkaXVzOiBudW1iZXJcclxuICAgICAgKSA9PiBuZXcgQmFzaWNBZ2VudChpZCwgcG9zaXRpb24sIGdvYWxQb3NpdGlvbiwgcmFkaXVzKTtcclxuICAgICAgYnJlYWs7XHJcbiAgICBjYXNlIFwiU3RvcEFnZW50XCI6XHJcbiAgICAgIGFnZW50Q29uc3RydWN0b3IgPSAoXHJcbiAgICAgICAgaWQ6IG51bWJlcixcclxuICAgICAgICBwb3NpdGlvbjogeyB4OiBudW1iZXI7IHk6IG51bWJlciB9LFxyXG4gICAgICAgIGdvYWxQb3NpdGlvbjogeyB4OiBudW1iZXI7IHk6IG51bWJlciB9LFxyXG4gICAgICAgIHJhZGl1czogbnVtYmVyXHJcbiAgICAgICkgPT4gbmV3IFN0b3BBZ2VudChpZCwgcG9zaXRpb24sIGdvYWxQb3NpdGlvbiwgcmFkaXVzKTtcclxuICAgICAgYnJlYWs7XHJcbiAgICBkZWZhdWx0OiB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkFnZW50IG5vdCBpbXBsZW1lbnRlZFwiKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIFNlbGVjdCBjb25maWd1cmF0aW9uXHJcbiAgc3dpdGNoIChjb25maWcpIHtcclxuICAgIGNhc2UgXCJSYW5kb21Ub1JhbmRvbVwiOiB7XHJcbiAgICAgIHNpbXVsYXRpb24uaW5pdChcclxuICAgICAgICBDb25maWd1cmF0aW9ucy5SYW5kb21Ub1JhbmRvbShcclxuICAgICAgICAgIG4sXHJcbiAgICAgICAgICBjYW52YXMud2lkdGgsXHJcbiAgICAgICAgICBjYW52YXMuaGVpZ2h0LFxyXG4gICAgICAgICAgYWdlbnRDb25zdHJ1Y3RvclxyXG4gICAgICAgIClcclxuICAgICAgKTtcclxuICAgICAgYnJlYWs7XHJcbiAgICB9XHJcbiAgICBjYXNlIFwiUmFuZG9tVG9MaW5lXCI6IHtcclxuICAgICAgc2ltdWxhdGlvbi5pbml0KFxyXG4gICAgICAgIENvbmZpZ3VyYXRpb25zLlJhbmRvbVRvTGluZShcclxuICAgICAgICAgIG4sXHJcbiAgICAgICAgICBjYW52YXMud2lkdGgsXHJcbiAgICAgICAgICBjYW52YXMuaGVpZ2h0LFxyXG4gICAgICAgICAgYWdlbnRDb25zdHJ1Y3RvclxyXG4gICAgICAgIClcclxuICAgICAgKTtcclxuICAgICAgYnJlYWs7XHJcbiAgICB9XHJcbiAgICBjYXNlIFwiQ2lyY2xlVG9DaXJjbGVcIjoge1xyXG4gICAgICBzaW11bGF0aW9uLmluaXQoXHJcbiAgICAgICAgQ29uZmlndXJhdGlvbnMuQ2lyY2xlVG9DaXJjbGUoXHJcbiAgICAgICAgICBuLFxyXG4gICAgICAgICAgY2FudmFzLndpZHRoLFxyXG4gICAgICAgICAgY2FudmFzLmhlaWdodCxcclxuICAgICAgICAgIGFnZW50Q29uc3RydWN0b3JcclxuICAgICAgICApXHJcbiAgICAgICk7XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgfVxyXG4gICAgZGVmYXVsdDoge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDb25maWd1cmF0aW9uIG5vdCBpbXBsZW1lbnRlZFwiKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuIiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0aWYoX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSkge1xuXHRcdHJldHVybiBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0obW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCIvLyBtb2R1bGUgZXhwb3J0cyBtdXN0IGJlIHJldHVybmVkIGZyb20gcnVudGltZSBzbyBlbnRyeSBpbmxpbmluZyBpcyBkaXNhYmxlZFxuLy8gc3RhcnR1cFxuLy8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG5yZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygzODkpO1xuIiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCkiLCIvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSAoZXhwb3J0cykgPT4ge1xuXHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcblx0fVxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xufTsiXSwic291cmNlUm9vdCI6IiJ9